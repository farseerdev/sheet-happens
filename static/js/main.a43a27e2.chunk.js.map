{"version":3,"sources":["assets/logo.svg","assets/git.svg","components/Menu.js","../../src/index.tsx","components/SheetBox.js","components/Header.js","components/TitleSeparator.js","components/Wrap.js","components/Code.js","components/Footer.js","App.js","index.js"],"names":["module","exports","Menu","scrollTo","elId","element","document","getElementById","headerOffset","offsetPosition","window","pageYOffset","getBoundingClientRect","top","behavior","className","src","Logo","alt","onClick","defaultCellStyle","textAlign","fontSize","marginRight","marginLeft","color","fontFamily","weight","fillColor","backgroundColor","defaultColumnHeaderStyle","resizeCanvas","canvas","height","devicePixelRatio","ratio","newCanvasWidth","Math","width","newCanvasHeight","context","createRowOrColumnPropFunction","Array","rowOrColIndex","rowColProp","createCellPropFunction","x","y","cellProp","applyAlignment","alignment","style","start","cellSize","imageWidth","drawCell","cellContent","finalStyle","createStyleObject","yy","yCoord","cellHeight","xx","xCoord","cellWidth","obj","finalX","calculateRowsOrColsSizes","visible","end","prev","freezeCount","startingSize","size","ind","startingIndex","index","optionalStyle","excelHeaderString","num","s","t","String","absCoordianteToCell","cellX","cellY","i","columnSizes","absX","rowSizes","absY","normalizeSelection","selection","selx1","selx2","sely1","sely2","cellToAbsCoordinate","sheetStyle","indX","dataOffset","indY","findApproxMaxEditDataIndex","editData","howManyEmpty","growthIncrement","growthIncrementFactor","allEmpty","data","props","canvasRef","useRef","overlayRef","copyPasteTextAreaRef","useState","x1","y1","x2","y2","hitTarget","useResizeObserver","ref","canvasWidth","canvasHeight","useMemo","columnHeaders","columnHeaderStyle","cellReadOnly","sourceData","displayData","editKeys","cellStyle","freezeColumns","freezeRows","hideColumnHeaders","hideRowHeaders","hideGridlines","columnHeaderHeight","rowHeaderWidth","hideScrollBars","useEffect","editCell","setEditCell","setEditKey","changeSelection","scrollToP2","setSelection","newDataOffset","newScrollLeft","newScrollTop","lastVisibleColumnIndex","firstVisibleColumnIndex","increment","newX","firstVisibleRowIndex","lastVisibleRowIndex","newY","setDataOffset","newMaxScroll","maxScroll","setMaxScroll","setTimeout","sx1","sy1","sx2","sy2","knobCoordinates","c","knobSize","hitMap","hitM","ch","cellW","absX1","absY1","absX2","absY2","w","h","x1key","x2key","y1key","y2key","xkey","xbin","ykey","animationFrameId","yCoord1","xCoord1","f","hideKnob","selectionActive","rowSelectionActive","colSelectionActive","p1","p2","currentCol","currentRow","p1x","p1y","startX","startY","first","yGridlineEnd","xGridlineEnd","row","chStyle","cw","chcontent","col","secondarySelection","rowSecondarySelectionActive","colSecondarySelectionActive","kx1","knobArea","kx2","ky1","ky2","knobPoint1","knobPoint2","renderOnCanvas","setFocusToTextArea","preventScroll","setCopyPasteText","activeTagName","onPaste","e","clipboardData","types","pastedHtml","parsePastedHtml","text","parsePastedText","findTable","child","maybeTable","html","div","pasteLocX","pasteLocY","changes","tableNode","tableChild","tr","td","str","p","value","rows","pasteX2","pasteY2","cols","dy1","dy2","dx1","dx2","cptext","cptextTemp","nonEmpty","commitEditingCell","editValue","startEditingCell","editDataValue","val","editDataKey","setEditValue","setShiftKeyDown","onMouseUp","fx1","fy1","fx2","fy2","max","srcY","source","srcX","setSelectionInProgress","setRowSelectionInProgress","setColumnSelectionInProgress","setKnobDragInProgress","setColumnResize","setRowResize","buttonClickMouseDownCoordinates","rect","setButtonClickMouseDownCoordinates","onMouseMove","hitTargetKeyX","hitTargetKeyY","newWidth","columnResize","newHeight","rowResize","sel2","columnSelectionInProgress","cell","xCellDiff","yCellDiff","setKnobArea","editMode","editTextPosition","editTextWidth","editTextHeight","editTextTextAlign","inputProps","autoFocus","onKeyDown","arrowKeyCommitMode","includes","position","left","outline","border","input","onChange","overlayDivClassName","styles","overlayDivStyles","overflow","borderBottom","canvasStyles","onDoubleClick","setArrowKeyCommitMode","onMouseDown","colIdx","indices","min","oldWidth","colIndices","rowIdx","oldHeight","rowIndices","sel1","shiftKeyDown","onMouseLeave","onContextMenu","ev","onScroll","opacity","autoComplete","autoCorrect","autoCapitalize","spellCheck","onFocus","tabIndex","incr","direction","firstFilled","findInDisplayData","onKeyUp","type","initialDataBig","r","push","initialDataBasic","initialDataFormatting","random","triangleDown","Image","useWidthHeigthControl","initialWidths","initialHeights","setCellWidth","setCellHeight","onCellWidthChange","idx","length","onCellHeightChange","SheetBoxHeader","setData","onSelectionChanged","onRightClick","newData","change","readOnly","SheetBoxBasic","JSON","parse","stringify","faCheck","SheetBoxStyle","colors","items","content","horiozntalAlign","console","log","undefined","incrementCell","SheetBoxFormatting","toFixed","Number","SheetBoxVeryBigData","loadingStatus","setLoadingStatus","href","preventDefault","fetch","then","response","json","dataset","toString","padStart","g","b","customInputOptions","customInputOptions2","customInputData","SheetBoxCustomInput","inputComponent","CustomInput","boxShadow","map","opt","CustomOption","key","clickHandler","hover","setHover","onMouseEnter","padding","cursor","SheetBoxSourceDisplayData","Header","textAreaRef","copySuccess","setCopySuccess","id","current","select","execCommand","target","focus","rel","GitIcon","TitleSeparator","title","Wrap","children","xcode","hljs","background","maxWidth","borderRadius","SourceDisplayDataCode","xcode2","language","InitSheetCode","InitSheetWithDataCode","EditDataCode","CellStyleSizeCode","Footer","Emphased","App","overflowX","ReactDOM","render"],"mappings":"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","file":"static/js/main.a43a27e2.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.aef13910.svg\";","module.exports = __webpack_public_path__ + \"static/media/git.f818b886.svg\";","import React from 'react';\nimport Logo from '../assets/logo.svg';\n\nfunction Menu() {\n    const scrollTo = (elId) => {\n        var element = document.getElementById(elId);\n        var headerOffset = elId === 'home' ? 0 : 86;\n        var elementPosition = window.pageYOffset + element.getBoundingClientRect().top;\n        var offsetPosition = elementPosition - headerOffset;\n\n        window.scrollTo({\n             top: offsetPosition,\n             behavior: \"smooth\"\n        });\n    }\n\n    return (\n        <div className=\"container blue-bg menu\">\n            <div className=\"content flex-row\">\n                <div className=\"logo-box\">\n                    <img src={Logo} alt=\"Logo\" />\n                    <h2 className=\"page-title\">sheet - happens</h2>\n                </div>\n                <div className=\"nav\">\n                    <div className=\"nav-item\" onClick={() => scrollTo('home')} >home</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('usage')} >usage</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('features')} >features</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('documentation')} >documentation</div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Menu;\n","import styles from './styles.module.css';\nimport React, {\n    useRef,\n    useEffect,\n    useState,\n    useMemo,\n    MouseEvent,\n    KeyboardEvent,\n    UIEvent,\n    CSSProperties,\n    ReactElement,\n} from 'react';\nimport useResizeObserver from 'use-resize-observer';\n\nconst selBorderColor = '#1b73e7';\nconst selBackColor = '#e9f0fd';\nconst knobSize = 6;\nconst gridColor = '#e2e3e3';\nconst knobAreaBorderColor = '#707070';\nconst kRowHeaderWidth = 50;\nconst rowHeaderBackgroundColor = '#f8f9fa';\nconst rowHeaderTextColor = '#666666';\nconst rowHeaderSelectedBackgroundColor = '#e8eaed';\nconst kColumnHeaderHeight = 22;\nconst columnHeaderBackgroundColor = rowHeaderBackgroundColor;\nconst columnHeaderSelectedBackgroundColor = rowHeaderSelectedBackgroundColor;\nconst xBinSize = 10;\nconst yBinSize = 10;\nconst scrollSpeed = 30;\nconst resizeColumnRowMouseThreshold = 4;\nconst minimumColumnWidth = 50;\nconst minimumRowHeight = 22;\nconst rowColHeaderSelectionColor = '#cccccc';\nconst maxSearchableRowOrCol = 65536;\n\nconst defaultCellStyle: Required<Style> = {\n    textAlign: 'left',\n    fontSize: 13,\n    marginRight: 5,\n    marginLeft: 5,\n    color: '#000',\n    fontFamily: 'sans-serif',\n    weight: '',\n    fillColor: '',\n    backgroundColor: '',\n};\n\nconst defaultColumnHeaderStyle: Required<Style> = {\n    textAlign: 'center',\n    fontSize: 13,\n    marginRight: 5,\n    marginLeft: 5,\n    color: '#000',\n    fontFamily: 'sans-serif',\n    weight: '',\n    fillColor: '',\n    backgroundColor: '',\n};\n\ntype PropTypes = string | number | boolean | Style | CellContentType;\ntype RowOrColumnProperty<T extends PropTypes> = T | Array<T> | ((index: number) => T);\ntype CellProperty<T extends PropTypes> = T | Array<Array<T>> | ((x: number, y: number) => T);\ntype CellContentType = null | number | string | CellContent;\ntype RowOrColumnPropertyFunction<T extends PropTypes> = (rowOrColIndex: number) => T;\ntype CellPropertyFunction<T extends PropTypes> = (x: number, y: number) => T;\ntype InputStyle = Pick<\n    CSSProperties,\n    | 'position'\n    | 'top'\n    | 'left'\n    | 'width'\n    | 'height'\n    | 'outline'\n    | 'border'\n    | 'textAlign'\n    | 'color'\n    | 'fontSize'\n    | 'fontFamily'\n>;\nexport interface SheetInputProps {\n    value: string;\n    autoFocus: boolean;\n    onKeyDown: React.KeyboardEventHandler<HTMLElement>;\n    onChange: (valiue: string) => void;\n    style: InputStyle;\n}\ninterface CellCoordinate {\n    x: number;\n    y: number;\n}\n\ninterface SelectionSpan {\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n}\n\ninterface Selection {\n    span: SelectionSpan;\n    color: string;\n}\n\nexport interface Change {\n    x: number;\n    y: number;\n    value: string | number | null;\n    source?: { x: number; y: number };\n}\n\nexport interface CellContentItem {\n    content: HTMLImageElement | string | number;\n    x: number;\n    y: number;\n    width?: number;\n    height?: number;\n    horiozntalAlign?: 'left' | 'right' | 'center';\n    onClick?: (e: MouseEvent) => void;\n}\n\nexport interface CellContent {\n    items: Array<CellContentItem>;\n}\n\nexport interface SheetMouseEvent extends MouseEvent {\n    cellX: number;\n    cellY: number;\n}\n\ninterface InternalSheetStyle {\n    hideGridlines: boolean;\n    hideColumnHeaders: boolean;\n    hideRowHeaders: boolean;\n    freezeColumns: number;\n    freezeRows: number;\n    columnHeaderHeight: number;\n    rowHeaderWidth: number;\n    hideScrollBars: boolean;\n}\n\nexport interface SheetStyle {\n    hideGridlines?: boolean;\n    hideColumnHeaders?: boolean;\n    hideRowHeaders?: boolean;\n    freezeColumns?: number;\n    freezeRows?: number;\n    hideScrollBars?: boolean;\n}\n\nexport interface SheetProps {\n    cellWidth?: RowOrColumnProperty<number>;\n    cellHeight?: RowOrColumnProperty<number>;\n    columnHeaders?: RowOrColumnProperty<CellContentType>;\n    columnHeaderStyle?: RowOrColumnProperty<Style>;\n    cellStyle?: CellProperty<Style>;\n    readOnly?: CellProperty<boolean>;\n    sourceData?: CellProperty<string | number | null>;\n    displayData?: CellProperty<CellContentType>;\n    editData?: CellProperty<string>;\n    editKeys?: CellProperty<string>;\n    sheetStyle?: SheetStyle;\n    dontCommitEditOnSelectionChange?: boolean;\n    secondarySelections?: Selection[];\n    inputComponent?: (\n        x: number,\n        y: number,\n        props: SheetInputProps,\n        commitEditingCell?: () => void\n    ) => ReactElement | undefined;\n    onSelectionChanged?: (x1: number, y1: number, x2: number, y2: number) => void;\n    onRightClick?: (e: SheetMouseEvent) => void;\n    onChange?: (changes: Array<Change>) => void;\n    onCellWidthChange?: (indices: number[], value: number) => void;\n    onCellHeightChange?: (indices: number[], value: number) => void;\n    onScrollChange?: (visibleRows: number[], visibleColumns: number[]) => void;\n}\n\nexport interface Style {\n    color?: string;\n    fontSize?: number;\n    fontFamily?: string;\n    textAlign?: 'right' | 'left' | 'center';\n    marginRight?: number;\n    marginLeft?: number;\n    weight?: string;\n    fillColor?: string;\n    backgroundColor?: string;\n}\n\ninterface RowOrColumnSize {\n    index: number[];\n    start: number[];\n    end: number[];\n}\n\nfunction resizeCanvas(canvas: HTMLCanvasElement) {\n    const { width, height } = canvas.getBoundingClientRect();\n    let { devicePixelRatio: ratio = 1 } = window;\n    if (ratio < 1) {\n        ratio = 1;\n    }\n    const newCanvasWidth = Math.round(width * ratio);\n    const newCanvasHeight = Math.round(height * ratio);\n\n    if (canvas.width !== newCanvasWidth || canvas.height !== newCanvasHeight) {\n        const context = canvas.getContext('2d');\n        if (context) {\n            canvas.width = newCanvasWidth;\n            canvas.height = newCanvasHeight;\n            context.scale(ratio, ratio);\n        }\n        return true;\n    }\n\n    return false;\n}\n\n// todo first figure out the function\nfunction createRowOrColumnPropFunction<T extends PropTypes>(\n    rowColProp: RowOrColumnProperty<T> | undefined,\n    defaultValue: T\n): RowOrColumnPropertyFunction<T> {\n    if (Array.isArray(rowColProp)) {\n        return (rowOrColIndex: number) => {\n            if (rowOrColIndex >= 0 && rowOrColIndex < rowColProp.length) {\n                return rowColProp[rowOrColIndex];\n            } else {\n                return defaultValue;\n            }\n        };\n    } else if (typeof rowColProp === 'function') {\n        return rowColProp;\n    } else if (rowColProp !== null && rowColProp !== undefined) {\n        return () => rowColProp;\n    } else {\n        return () => defaultValue;\n    }\n}\n\nfunction createCellPropFunction<T extends PropTypes>(\n    cellProp: CellProperty<T> | undefined,\n    defaultValue: T\n): CellPropertyFunction<T> {\n    if (Array.isArray(cellProp)) {\n        return (x: number, y: number) => {\n            if (y >= 0 && y < cellProp.length) {\n                if (x >= 0 && x < cellProp[y].length) {\n                    return cellProp[y][x];\n                } else {\n                    return defaultValue;\n                }\n            } else {\n                return defaultValue;\n            }\n        };\n    } else if (typeof cellProp === 'function') {\n        return cellProp;\n    } else if (cellProp !== null && cellProp !== undefined) {\n        return () => cellProp;\n    } else {\n        return () => defaultValue;\n    }\n}\n\nfunction applyAlignment(\n    start: number,\n    cellSize: number,\n    style: Required<Style>,\n    imageWidth: number,\n    alignment?: 'left' | 'center' | 'right'\n): number {\n    if (!alignment) {\n        alignment = style.textAlign;\n    }\n    if (alignment === 'left') {\n        return start + style.marginLeft;\n    } else if (alignment === 'center') {\n        return start + cellSize * 0.5 - imageWidth / 2;\n    } else if (alignment === 'right') {\n        return start + (cellSize - style.marginRight - imageWidth);\n    }\n    return start;\n}\n\nfunction drawCell(\n    context: CanvasRenderingContext2D,\n    cellContent: CellContentType,\n    style: Style,\n    defaultCellStyle: Required<Style>,\n    xCoord: number,\n    yCoord: number,\n    cellWidth: number,\n    cellHeight: number\n) {\n    if (cellContent === null) {\n        return;\n    }\n    const finalStyle = createStyleObject(style, defaultCellStyle);\n    context.fillStyle = finalStyle.color;\n    context.font = finalStyle.weight + ' ' + finalStyle.fontSize + 'px ' + finalStyle.fontFamily;\n    context.textAlign = finalStyle.textAlign;\n\n    const yy = yCoord + cellHeight * 0.5;\n\n    context.save();\n    context.beginPath();\n    context.rect(xCoord, yCoord, cellWidth, cellHeight);\n    context.clip();\n\n    if (finalStyle.backgroundColor !== '') {\n        context.fillStyle = finalStyle.backgroundColor;\n        context.fillRect(xCoord, yCoord, cellWidth, cellHeight);\n        context.fillStyle = finalStyle.color;\n    }\n\n    if (typeof cellContent === 'string' || typeof cellContent === 'number') {\n        const xx = applyAlignment(xCoord, cellWidth, finalStyle, 0);\n        context.fillText('' + cellContent, xx, yy);\n    } else if (typeof cellContent === 'object') {\n        for (const obj of cellContent.items) {\n            if (obj.content instanceof HTMLImageElement) {\n                const w = obj.width || cellWidth;\n                const finalX = applyAlignment(xCoord, cellWidth, finalStyle, w, obj.horiozntalAlign);\n                context.drawImage(\n                    obj.content,\n                    finalX + obj.x,\n                    yy + obj.y,\n                    obj.width || cellWidth,\n                    obj.height || cellHeight\n                );\n            } else if (typeof obj.content === 'string' || typeof obj.content === 'number') {\n                if (obj.horiozntalAlign) {\n                    context.textAlign = obj.horiozntalAlign;\n                }\n                const finalX = applyAlignment(xCoord, cellWidth, finalStyle, 0, obj.horiozntalAlign);\n                context.fillText('' + obj.content, finalX + obj.x, yy + obj.y);\n            }\n        }\n    }\n    context.restore();\n}\n\nfunction calculateRowsOrColsSizes(\n    freezeCount: number,\n    size: (index: number) => number,\n    startingSize: number,\n    startingIndex: number,\n    visibleArea: number\n): RowOrColumnSize {\n    const visible = [];\n    const start = [];\n    const end = [];\n    let prev = 0;\n\n    start.push(startingSize);\n    visible.push(freezeCount > 0 ? 0 : startingIndex);\n    let firstSize = freezeCount > 0 ? size(0) : size(startingIndex);\n    prev = startingSize + firstSize;\n    end.push(prev);\n\n    let ind = freezeCount > 0 ? 1 : startingIndex + 1;\n\n    if (freezeCount > 0) {\n        for (; ind < freezeCount; ind++) {\n            visible.push(ind);\n            start.push(prev);\n            prev = prev + size(ind);\n            end.push(prev);\n        }\n        ind = Math.max(startingIndex, freezeCount);\n    }\n\n    while (true) {\n        visible.push(ind);\n        start.push(prev);\n        prev = prev + size(ind);\n        end.push(prev);\n        if (end[end.length - 1] >= visibleArea) {\n            break;\n        }\n        ind++;\n    }\n    return {\n        index: visible,\n        start,\n        end,\n    };\n}\n\nfunction createStyleObject(optionalStyle: Style, defaultStyle: Required<Style>): Required<Style> {\n    return {\n        ...defaultStyle,\n        ...optionalStyle,\n    };\n}\n\nfunction excelHeaderString(num: number) {\n    let s = '';\n    let t = 0;\n    while (num > 0) {\n        t = (num - 1) % 26;\n        s = String.fromCharCode(65 + t) + s;\n        num = ((num - t) / 26) | 0;\n    }\n    return s || '';\n}\n\nfunction absCoordianteToCell(\n    absX: number,\n    absY: number,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize\n): CellCoordinate {\n    let cellX = 0;\n    let cellY = 0;\n\n    for (let i = 0; i < columnSizes.index.length; i++) {\n        if (absX >= columnSizes.start[i] && absX <= columnSizes.end[i]) {\n            cellX = columnSizes.index[i];\n            break;\n        }\n    }\n    for (let i = 0; i < rowSizes.index.length; i++) {\n        if (absY >= rowSizes.start[i] && absY <= rowSizes.end[i]) {\n            cellY = rowSizes.index[i];\n            break;\n        }\n    }\n\n    return { x: cellX, y: cellY };\n}\n\nfunction normalizeSelection(selection: SelectionSpan) {\n    let selx1 = selection.x1;\n    let selx2 = selection.x2;\n\n    if (selection.x1 > selection.x2) {\n        selx1 = selection.x2;\n        selx2 = selection.x1;\n    }\n\n    let sely1 = selection.y1;\n    let sely2 = selection.y2;\n\n    if (selection.y1 > selection.y2) {\n        sely1 = selection.y2;\n        sely2 = selection.y1;\n    }\n    return [selx1, sely1, selx2, sely2];\n}\n\nfunction cellToAbsCoordinate(\n    cellX: number,\n    cellY: number,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize,\n    dataOffset: CellCoordinate,\n    cellWidth: RowOrColumnPropertyFunction<number>,\n    cellHeight: RowOrColumnPropertyFunction<number>,\n    sheetStyle: InternalSheetStyle\n): CellCoordinate {\n    let absX = sheetStyle.rowHeaderWidth;\n    const indX = columnSizes.index.findIndex((i) => i === cellX);\n    if (indX !== -1) {\n        absX = columnSizes.start[indX];\n    } else {\n        for (let i = 0; i < dataOffset.x; i++) {\n            absX -= cellWidth(i);\n        }\n        for (let i = 0; i < cellX; i++) {\n            absX += cellWidth(i);\n        }\n    }\n\n    let absY = sheetStyle.columnHeaderHeight;\n    const indY = rowSizes.index.findIndex((i) => i === cellY);\n    if (indY !== -1) {\n        absY = rowSizes.start[indY];\n    } else {\n        for (let i = 0; i < dataOffset.y; i++) {\n            absY -= cellHeight(i);\n        }\n        for (let i = 0; i < cellY; i++) {\n            absY += cellHeight(i);\n        }\n    }\n    return { x: absX, y: absY };\n}\n\nfunction findApproxMaxEditDataIndex(editData: CellPropertyFunction<string>) {\n    let x = 0;\n    let y = 0;\n    let howManyEmpty = 0;\n    let growthIncrement = 10;\n    let growthIncrementFactor = 1.5;\n\n    // x\n    while (howManyEmpty < 4) {\n        let allEmpty = true;\n        for (let yy = 0; yy < 10; yy++) {\n            const data = editData(x, yy);\n            if (data !== null && data !== undefined && data !== '') {\n                allEmpty = false;\n                break;\n            }\n        }\n        if (allEmpty) {\n            howManyEmpty += 1;\n        }\n        x += growthIncrement;\n        if (x > maxSearchableRowOrCol) {\n            break;\n        }\n        growthIncrement = Math.floor(growthIncrement * growthIncrementFactor);\n    }\n\n    howManyEmpty = 0;\n    growthIncrement = 10;\n    growthIncrementFactor = 1.5;\n\n    // y\n    while (howManyEmpty < 4) {\n        let allEmpty = true;\n        for (let xx = 0; xx < 10; xx++) {\n            const data = editData(xx, y);\n            if (data !== null && data !== undefined && data !== '') {\n                allEmpty = false;\n                break;\n            }\n        }\n        if (allEmpty) {\n            howManyEmpty += 1;\n        }\n        y += growthIncrement;\n        if (y > maxSearchableRowOrCol) {\n            break;\n        }\n        growthIncrement = Math.floor(growthIncrement * growthIncrementFactor);\n    }\n    return { x, y };\n}\n\nfunction findInDisplayData(\n    displayData: CellPropertyFunction<CellContentType>,\n    start: { x: number; y: number },\n    direction: 'up' | 'down' | 'left' | 'right'\n) {\n    let i = { ...start };\n    let increment = { x: 0, y: 0 };\n    if (direction === 'up') {\n        increment.y = -1;\n    } else if (direction === 'down') {\n        increment.y = 1;\n    } else if (direction === 'left') {\n        increment.x = -1;\n    } else if (direction === 'right') {\n        increment.x = 1;\n    }\n    const max = { x: maxSearchableRowOrCol, y: maxSearchableRowOrCol };\n    if (i.x > max.x) {\n        i.x = max.x;\n    }\n    if (i.y > max.y) {\n        i.y = max.y;\n    }\n\n    const first = displayData(i.x + increment.x, i.y + increment.y);\n    const firstFilled = first !== '' && first !== null && first !== undefined;\n\n    if (!firstFilled) {\n        i.x += increment.x;\n        i.y += increment.y;\n    }\n\n    while (i.x <= max.x && i.y <= max.y && i.x >= 0 && i.y >= 0) {\n        const data = displayData(i.x, i.y);\n\n        // if first cell is filled, find the latest filled cell, so first look for first unfilled\n        if (firstFilled && (data === '' || data === null || data === undefined)) {\n            return {\n                x: i.x - increment.x,\n                y: i.y - increment.y,\n            };\n        }\n        // if first cell is not filled, just find the first filled\n        if (!firstFilled && data !== '' && data !== null && data !== undefined) {\n            return { ...i };\n        }\n\n        i.x += increment.x;\n        i.y += increment.y;\n    }\n    return i;\n}\n\nfunction renderOnCanvas(\n    context: CanvasRenderingContext2D,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize,\n    cellStyle: CellPropertyFunction<Style>,\n    cellWidth: RowOrColumnPropertyFunction<number>,\n    cellHeight: RowOrColumnPropertyFunction<number>,\n    selection: SelectionSpan,\n    secondarySelections: Selection[],\n    knobDragInProgress: boolean,\n    columnHeaders: RowOrColumnPropertyFunction<CellContentType>,\n    columnHeaderStyle: RowOrColumnPropertyFunction<Style>,\n    knobArea: SelectionSpan,\n    displayData: CellPropertyFunction<CellContentType>,\n    dataOffset: CellCoordinate,\n    knobCoordinates: { x: number; y: number },\n    sheetStyle: InternalSheetStyle\n) {\n    resizeCanvas(context.canvas);\n    context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n\n    // apply cell fill color\n    let yCoord1 = sheetStyle.columnHeaderHeight;\n    for (const y of rowSizes.index) {\n        let xCoord1 = sheetStyle.rowHeaderWidth;\n        for (const x of columnSizes.index) {\n            const style = cellStyle(x, y);\n            if (style.fillColor) {\n                context.fillStyle = style.fillColor;\n                context.fillRect(xCoord1, yCoord1, cellWidth(x), cellHeight(y));\n            }\n            xCoord1 += cellWidth(x);\n        }\n        yCoord1 += cellHeight(y);\n    }\n\n    let hideKnob = false;\n\n    const [selx1, sely1, selx2, sely2] = normalizeSelection(selection);\n\n    const selectionActive = (selx1 !== -1 && selx2 !== -1) || (sely1 !== -1 && sely2 !== -1);\n\n    const rowSelectionActive = selx1 === -1 && selx2 === -1 && sely1 !== -1 && sely2 !== -1;\n    const colSelectionActive = selx1 !== -1 && selx2 !== -1 && sely1 === -1 && sely2 === -1;\n\n    const p1 = cellToAbsCoordinate(selx1, sely1, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight, sheetStyle);\n    const p2 = cellToAbsCoordinate(selx2, sely2, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight, sheetStyle);\n    p2.x += cellWidth(selx2);\n    p2.y += cellHeight(sely2);\n\n    if (p1.x >= p2.x) {\n        // recalculate if the selection span covers both frozen and unfrozen columns\n        p2.x = p1.x;\n        let currentCol = selx1;\n        while (columnSizes.index.includes(currentCol)) {\n            p2.x += cellWidth(currentCol);\n            currentCol++;\n        }\n        hideKnob = true;\n    }\n\n    if (p1.y >= p2.y) {\n        // recalculate if the selection span covers both frozen and unfrozen rows\n        p2.y = p1.y;\n        let currentRow = sely1;\n        while (rowSizes.index.includes(currentRow)) {\n            p2.y += cellHeight(currentRow);\n            currentRow++;\n        }\n        hideKnob = true;\n    }\n\n    // selection fill\n    if (selectionActive) {\n        context.fillStyle = selBackColor;\n        if (rowSelectionActive) {\n            const p1x = Math.max(-100, p1.x);\n            context.fillRect(p1x, p1.y, 100000, p2.y - p1.y);\n        } else if (colSelectionActive) {\n            const p1y = Math.max(0, p1.y);\n            context.fillRect(p1.x, p1y, p2.x - p1.x, 100000);\n        } else {\n            context.fillRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);\n        }\n    }\n\n    if (!sheetStyle.hideRowHeaders) {\n        // row header background\n        context.fillStyle = rowHeaderBackgroundColor;\n        context.fillRect(0, 0, sheetStyle.rowHeaderWidth, context.canvas.height);\n\n        // row header selection\n        if (selectionActive) {\n            context.fillStyle = rowHeaderSelectedBackgroundColor;\n            context.fillRect(0, p1.y, sheetStyle.rowHeaderWidth, p2.y - p1.y);\n        }\n    }\n\n    if (!sheetStyle.hideColumnHeaders) {\n        // column header background\n        context.fillStyle = columnHeaderBackgroundColor;\n        context.fillRect(0, 0, context.canvas.width, sheetStyle.columnHeaderHeight);\n\n        // column header selection\n        if (selectionActive) {\n            context.fillStyle = columnHeaderSelectedBackgroundColor;\n            context.fillRect(p1.x, 0, p2.x - p1.x, sheetStyle.columnHeaderHeight);\n        }\n    }\n\n    // grid\n    context.strokeStyle = gridColor;\n    context.lineWidth = 1;\n    let startX = sheetStyle.rowHeaderWidth;\n    let startY = sheetStyle.columnHeaderHeight;\n\n    let first = true;\n    const yGridlineEnd = sheetStyle.hideGridlines ? sheetStyle.columnHeaderHeight : context.canvas.height;\n    for (const col of columnSizes.index) {\n        context.beginPath();\n        context.moveTo(startX, 0);\n        if (first) {\n            if (!sheetStyle.hideRowHeaders) {\n                context.lineTo(startX, context.canvas.height);\n            }\n            first = false;\n        } else {\n            context.lineTo(startX, yGridlineEnd);\n        }\n        context.stroke();\n        startX += cellWidth(col);\n    }\n\n    const xGridlineEnd = sheetStyle.hideGridlines ? sheetStyle.rowHeaderWidth : context.canvas.width;\n    first = true;\n    for (const row of rowSizes.index) {\n        context.beginPath();\n        context.moveTo(0, startY);\n        if (first) {\n            if (!sheetStyle.hideColumnHeaders) {\n                context.lineTo(context.canvas.width, startY);\n            }\n            first = false;\n        } else {\n            context.lineTo(xGridlineEnd, startY);\n        }\n        context.stroke();\n        startY += cellHeight(row);\n    }\n\n    if (!sheetStyle.hideRowHeaders) {\n        // row header text\n        startY = sheetStyle.columnHeaderHeight;\n        context.textBaseline = 'middle';\n        context.textAlign = 'center';\n        context.font = defaultCellStyle.fontSize + 'px ' + defaultCellStyle.fontFamily;\n        context.fillStyle = rowHeaderTextColor;\n        for (const row of rowSizes.index) {\n            const cellContent = row + 1;\n            let chStyle = {};\n            if (rowSelectionActive && sely1 <= row && sely2 >= row) {\n                chStyle = { ...chStyle, backgroundColor: rowColHeaderSelectionColor };\n            }\n            drawCell(\n                context,\n                '' + cellContent,\n                chStyle,\n                defaultColumnHeaderStyle,\n                0,\n                startY,\n                sheetStyle.rowHeaderWidth,\n                cellHeight(row)\n            );\n            startY += cellHeight(row);\n        }\n    }\n\n    if (!sheetStyle.hideColumnHeaders) {\n        // column header text\n        startX = sheetStyle.rowHeaderWidth;\n        context.textBaseline = 'middle';\n        context.textAlign = 'center';\n        for (const col of columnSizes.index) {\n            const cw = cellWidth(col);\n            const ch = columnHeaders(col);\n            const chcontent = ch !== null ? ch : excelHeaderString(col + 1);\n            let chStyle = columnHeaderStyle(col);\n            if (colSelectionActive && selx1 <= col && selx2 >= col) {\n                chStyle = { ...chStyle, backgroundColor: rowColHeaderSelectionColor };\n            }\n            drawCell(\n                context,\n                chcontent,\n                chStyle,\n                defaultColumnHeaderStyle,\n                startX,\n                0,\n                cw,\n                sheetStyle.columnHeaderHeight\n            );\n            startX += cw;\n        }\n    }\n\n    // selection outline\n    if (selectionActive) {\n        context.strokeStyle = selBorderColor;\n        context.lineWidth = 1;\n        context.beginPath();\n        if (rowSelectionActive) {\n            const p1x = Math.max(-100, p1.x);\n            context.rect(p1x, p1.y, 100000, p2.y - p1.y);\n        } else if (colSelectionActive) {\n            const p1y = Math.max(-100, p1.y);\n            context.rect(p1.x, p1y, p2.x - p1.x, 100000);\n        } else {\n            context.rect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);\n        }\n        context.stroke();\n    }\n\n    for (const secondarySelection of secondarySelections) {\n        const [selx1, sely1, selx2, sely2] = normalizeSelection(secondarySelection.span);\n\n        const secondarySelectionActive = (selx1 !== -1 && selx2 !== -1) || (sely1 !== -1 && sely2 !== -1);\n        if (!secondarySelectionActive) {\n            continue;\n        }\n        const rowSecondarySelectionActive = selx1 === -1 && selx2 === -1 && sely1 !== -1 && sely2 !== -1;\n        const colSecondarySelectionActive = selx1 !== -1 && selx2 !== -1 && sely1 === -1 && sely2 === -1;\n\n        const p1 = cellToAbsCoordinate(\n            selx1,\n            sely1,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight,\n            sheetStyle\n        );\n        const p2 = cellToAbsCoordinate(\n            selx2,\n            sely2,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight,\n            sheetStyle\n        );\n        p2.x += cellWidth(selx2);\n        p2.y += cellHeight(sely2);\n\n        if (p1.x >= p2.x) {\n            // recalculate if the selection span covers both frozen and unfrozen columns\n            p2.x = p1.x;\n            let currentCol = selx1;\n            while (columnSizes.index.includes(currentCol)) {\n                p2.x += cellWidth(currentCol);\n                currentCol++;\n            }\n        }\n\n        if (p1.y >= p2.y) {\n            // recalculate if the selection span covers both frozen and unfrozen rows\n            p2.y = p1.y;\n            let currentRow = sely1;\n            while (rowSizes.index.includes(currentRow)) {\n                p2.y += cellHeight(currentRow);\n                currentRow++;\n            }\n        }\n\n        context.strokeStyle = secondarySelection.color;\n        context.lineWidth = 1;\n        context.beginPath();\n\n        if (rowSecondarySelectionActive) {\n            const p1x = Math.max(-100, p1.x);\n            context.rect(p1x, p1.y, 100000, p2.y - p1.y);\n        } else if (colSecondarySelectionActive) {\n            const p1y = Math.max(-100, p1.y);\n            context.rect(p1.x, p1y, p2.x - p1.x, 100000);\n        } else {\n            context.rect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);\n        }\n        context.stroke();\n    }\n\n    // knob drag outline\n    if (knobDragInProgress) {\n        let kx1 = knobArea.x1;\n        let kx2 = knobArea.x2;\n        if (knobArea.x1 > knobArea.x2) {\n            kx1 = knobArea.x2;\n            kx2 = knobArea.x1;\n        }\n\n        let ky1 = knobArea.y1;\n        let ky2 = knobArea.y2;\n        if (knobArea.y1 > knobArea.y2) {\n            ky1 = knobArea.y2;\n            ky2 = knobArea.y1;\n        }\n        const knobPoint1 = cellToAbsCoordinate(\n            kx1,\n            ky1,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight,\n            sheetStyle\n        );\n        const knobPoint2 = cellToAbsCoordinate(\n            kx2 + 1,\n            ky2 + 1,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight,\n            sheetStyle\n        );\n        context.strokeStyle = knobAreaBorderColor;\n        context.setLineDash([3, 3]);\n        context.lineWidth = 1;\n        context.beginPath();\n        if (rowSelectionActive) {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, 100000, knobPoint2.y - knobPoint1.y);\n        } else if (colSelectionActive) {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, knobPoint2.x - knobPoint1.x, 100000);\n        } else {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, knobPoint2.x - knobPoint1.x, knobPoint2.y - knobPoint1.y);\n        }\n        context.stroke();\n        context.setLineDash([]);\n    }\n\n    // selection knob\n    if (selectionActive && !hideKnob) {\n        context.fillStyle = selBorderColor;\n        context.fillRect(knobCoordinates.x - knobSize * 0.5, knobCoordinates.y - knobSize * 0.5, knobSize, knobSize);\n    }\n\n    // content\n    context.textBaseline = 'middle';\n\n    // draw content\n    let yCoord = sheetStyle.columnHeaderHeight;\n    for (const y of rowSizes.index) {\n        let xCoord = sheetStyle.rowHeaderWidth;\n        const ch = cellHeight(y);\n        for (const x of columnSizes.index) {\n            const cellContent = displayData(x, y);\n            const cw = cellWidth(x);\n            if (cellContent !== null && cellContent !== undefined) {\n                const style = cellStyle(x, y);\n                drawCell(context, cellContent, style, defaultCellStyle, xCoord, yCoord, cw, ch);\n            }\n            xCoord += cw;\n        }\n        yCoord += ch;\n    }\n}\n\nfunction Sheet(props: SheetProps) {\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const overlayRef = useRef<HTMLDivElement>(null);\n    const copyPasteTextAreaRef = useRef<HTMLTextAreaElement>(null);\n    const [maxScroll, setMaxScroll] = useState({ x: 5000, y: 5000 });\n    const [dataOffset, setDataOffset] = useState({ x: 0, y: 0 });\n    const [selection, setSelection] = useState<SelectionSpan>({ x1: -1, y1: -1, x2: -1, y2: -1 });\n    const [knobArea, setKnobArea] = useState<SelectionSpan>({ x1: -1, y1: -1, x2: -1, y2: -1 });\n    const [editCell, setEditCell] = useState({ x: -1, y: -1 });\n    const [editValue, setEditValue] = useState<string | number>('');\n    const [editKey, setEditKey] = useState<string>('');\n    const [arrowKeyCommitMode, setArrowKeyCommitMode] = useState(false);\n    const [shiftKeyDown, setShiftKeyDown] = useState(false);\n    const [knobDragInProgress, setKnobDragInProgress] = useState(false);\n    const [selectionInProgress, setSelectionInProgress] = useState(false);\n    const [columnResize, setColumnResize] = useState<{ startX: number; colIndices: number[]; oldWidth: number } | null>(\n        null\n    );\n    const [rowResize, setRowResize] = useState<{ startY: number; rowIndices: number[]; oldHeight: number } | null>(\n        null\n    );\n    const [rowSelectionInProgress, setRowSelectionInProgress] = useState(false);\n    const [columnSelectionInProgress, setColumnSelectionInProgress] = useState(false);\n    const [buttonClickMouseDownCoordinates, setButtonClickMouseDownCoordinates] = useState<any>({\n        x: -1,\n        y: -1,\n        hitTarget: null,\n    });\n    const { width: canvasWidth = 3000, height: canvasHeight = 3000 } = useResizeObserver({ ref: canvasRef });\n\n    //    const freezeColumns = props.freezeColumns || 0;\n    //    const freezeRows = props.freezeRows || 0;\n\n    const cellWidth = useMemo(() => createRowOrColumnPropFunction(props.cellWidth, 100), [props.cellWidth]);\n    const cellHeight = useMemo(() => createRowOrColumnPropFunction(props.cellHeight, 22), [props.cellHeight]);\n    const columnHeaders = useMemo(() => createRowOrColumnPropFunction(props.columnHeaders, null), [\n        props.columnHeaders,\n    ]);\n    const columnHeaderStyle = useMemo(() => createRowOrColumnPropFunction(props.columnHeaderStyle, {}), [\n        props.columnHeaderStyle,\n    ]);\n\n    const cellReadOnly = useMemo(() => createCellPropFunction(props.readOnly, false), [props.readOnly]);\n\n    const sourceData = useMemo(() => createCellPropFunction(props.sourceData, null), [props.sourceData]);\n    const displayData = useMemo(() => createCellPropFunction(props.displayData, ''), [props.displayData]);\n    const editData = useMemo(() => createCellPropFunction(props.editData, ''), [props.editData]);\n    const editKeys = useMemo(() => createCellPropFunction(props.editKeys, ''), [props.editKeys]);\n    const cellStyle = useMemo(() => createCellPropFunction(props.cellStyle, defaultCellStyle), [props.cellStyle]);\n\n    const sheetStyle: InternalSheetStyle = useMemo(() => {\n        return {\n            freezeColumns: props.sheetStyle?.freezeColumns || 0,\n            freezeRows: props.sheetStyle?.freezeRows || 0,\n            hideColumnHeaders: props.sheetStyle?.hideColumnHeaders || false,\n            hideRowHeaders: props.sheetStyle?.hideRowHeaders || false,\n            hideGridlines: props.sheetStyle?.hideGridlines || false,\n            columnHeaderHeight: props.sheetStyle?.hideColumnHeaders ? 1 : kColumnHeaderHeight,\n            rowHeaderWidth: props.sheetStyle?.hideRowHeaders ? 1 : kRowHeaderWidth,\n            hideScrollBars: props.sheetStyle?.hideScrollBars || false,\n        };\n    }, [\n        props.sheetStyle?.freezeColumns,\n        props.sheetStyle?.freezeRows,\n        props.sheetStyle?.hideColumnHeaders,\n        props.sheetStyle?.hideGridlines,\n        props.sheetStyle?.hideRowHeaders,\n        props.sheetStyle?.hideScrollBars,\n    ]);\n\n    useEffect(() => {\n        const currEditKey = editKeys ? editKeys(editCell.x, editCell.y) : '';\n        if (currEditKey !== editKey) {\n            setEditCell({ x: -1, y: -1 });\n            setEditKey('');\n        }\n    }, [editKeys]);\n\n    const columnSizes = useMemo(\n        () =>\n            calculateRowsOrColsSizes(\n                sheetStyle.freezeColumns,\n                cellWidth,\n                sheetStyle.rowHeaderWidth,\n                dataOffset.x,\n                canvasWidth\n            ),\n        [sheetStyle, cellWidth, dataOffset.x, canvasWidth]\n    );\n\n    const rowSizes = useMemo(\n        () =>\n            calculateRowsOrColsSizes(\n                sheetStyle.freezeRows,\n                cellHeight,\n                sheetStyle.columnHeaderHeight,\n                dataOffset.y,\n                canvasHeight\n            ),\n        [sheetStyle, cellHeight, dataOffset.y, canvasHeight]\n    );\n\n    useEffect(() => {\n        if (props.onScrollChange) {\n            props.onScrollChange([...rowSizes.index], [...columnSizes.index]);\n        }\n    }, [rowSizes, columnSizes, props.onScrollChange]);\n\n    const changeSelection = (x1: number, y1: number, x2: number, y2: number, scrollToP2 = true) => {\n        if (selection.x1 !== x1 || selection.x2 !== x2 || selection.y1 !== y1 || selection.y2 !== y2) {\n            setSelection({ x1, y1, x2, y2 });\n        }\n\n        if (scrollToP2) {\n            const newDataOffset = { x: dataOffset.x, y: dataOffset.y };\n            let newScrollLeft = -1;\n            let newScrollTop = -1;\n\n            if (\n                x2 !== -1 &&\n                (!columnSizes.index.includes(x2) || columnSizes.index[columnSizes.index.length - 1] === x2)\n            ) {\n                const lastVisibleColumnIndex = columnSizes.index[columnSizes.index.length - 1];\n                const firstVisibleColumnIndex = columnSizes.index[sheetStyle.freezeColumns];\n                let increment = 0;\n                if (x2 >= lastVisibleColumnIndex) {\n                    increment = 1 + x2 - lastVisibleColumnIndex;\n                } else if (x2 < firstVisibleColumnIndex) {\n                    increment = x2 - firstVisibleColumnIndex;\n                }\n                const newX = Math.max(dataOffset.x, sheetStyle.freezeColumns) + increment;\n                newDataOffset.x = newX;\n                newScrollLeft = newX * scrollSpeed;\n            }\n\n            if (y2 !== -1 && (!rowSizes.index.includes(y2) || rowSizes.index[rowSizes.index.length - 1] === y2)) {\n                const firstVisibleRowIndex = rowSizes.index[sheetStyle.freezeRows];\n                const lastVisibleRowIndex = rowSizes.index[rowSizes.index.length - 1];\n                let increment = 0;\n                if (y2 >= lastVisibleRowIndex) {\n                    increment = 1 + y2 - lastVisibleRowIndex;\n                } else if (y2 < firstVisibleRowIndex) {\n                    increment = y2 - firstVisibleRowIndex;\n                }\n                const newY = Math.max(dataOffset.y, sheetStyle.freezeRows) + increment;\n                newDataOffset.y = newY;\n                newScrollTop = newY * scrollSpeed;\n            }\n\n            if (newDataOffset.x !== dataOffset.x || dataOffset.y !== newDataOffset.y) {\n                setDataOffset({ x: newDataOffset.x, y: newDataOffset.y });\n                const newMaxScroll = { ...maxScroll };\n                newMaxScroll.x = Math.max(newMaxScroll.x, newScrollLeft);\n                newMaxScroll.y = Math.max(newMaxScroll.y, newScrollTop);\n                setMaxScroll(newMaxScroll);\n                setTimeout(() => {\n                    if (overlayRef.current) {\n                        if (newScrollLeft !== -1) {\n                            overlayRef.current.scrollLeft = newScrollLeft;\n                        }\n                        if (newScrollTop !== -1) {\n                            overlayRef.current.scrollTop = newScrollTop;\n                        }\n                    }\n                }, 0);\n            }\n        }\n\n        if (props.onSelectionChanged) {\n            let sx1 = x1;\n            let sy1 = y1;\n            let sx2 = x2;\n            let sy2 = y2;\n            if (sx1 > sx2) {\n                sx1 = x2;\n                sx2 = x1;\n            }\n            if (sy1 > sy2) {\n                sy1 = y2;\n                sy2 = y1;\n            }\n            props.onSelectionChanged(sx1, sy1, sx2, sy2);\n        }\n    };\n\n    const knobCoordinates = useMemo(() => {\n        if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n            let sely2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sely2 = selection.y1;\n            }\n            const c = cellToAbsCoordinate(\n                0,\n                sely2,\n                rowSizes,\n                columnSizes,\n                dataOffset,\n                cellWidth,\n                cellHeight,\n                sheetStyle\n            );\n            return { x: c.x + knobSize * 0.5, y: c.y + cellHeight(sely2) };\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1 && selection.y1 === -1 && selection.y2 === -1) {\n            let selx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                selx2 = selection.x1;\n            }\n\n            const c = cellToAbsCoordinate(\n                selx2,\n                0,\n                rowSizes,\n                columnSizes,\n                dataOffset,\n                cellWidth,\n                cellHeight,\n                sheetStyle\n            );\n            return { x: c.x + cellWidth(selx2), y: c.y + knobSize * 0.5 };\n        }\n        if (selection.x2 !== -1 && selection.y2 !== -1) {\n            let selx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                selx2 = selection.x1;\n            }\n\n            let sely2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sely2 = selection.y1;\n            }\n            const c = cellToAbsCoordinate(\n                selx2,\n                sely2,\n                rowSizes,\n                columnSizes,\n                dataOffset,\n                cellWidth,\n                cellHeight,\n                sheetStyle\n            );\n            return { x: c.x + cellWidth(selx2), y: c.y + cellHeight(sely2) };\n        }\n        return { x: -1, y: -1 };\n    }, [selection, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight, sheetStyle]);\n\n    const hitMap = useMemo(() => {\n        const hitM = {};\n        const canvas = canvasRef.current;\n        if (!canvas) {\n            return hitM;\n        }\n        resizeCanvas(canvas);\n        let yCoord = sheetStyle.columnHeaderHeight;\n        let xCoord = sheetStyle.rowHeaderWidth;\n\n        for (const x of columnSizes.index) {\n            const ch = columnHeaders(x);\n            const cellW = cellWidth(x);\n            if (ch && typeof ch === 'object' && ch.items) {\n                let finalStyle;\n                for (const obj of ch.items) {\n                    if (obj.onClick) {\n                        if (!finalStyle) {\n                            finalStyle = createStyleObject(columnHeaderStyle(x), defaultCellStyle);\n                        }\n                        const w = obj.content instanceof HTMLImageElement ? obj.width || cellW : 0;\n                        const absX1 = applyAlignment(xCoord, cellW, finalStyle, w, obj.horiozntalAlign) + obj.x;\n                        const absY1 = sheetStyle.columnHeaderHeight * 0.5 + obj.y;\n                        const absX2 = absX1 + (obj.width || 0);\n                        const absY2 = absY1 + (obj.height || 0);\n\n                        const hitTarget = {\n                            x: absX1,\n                            y: absY1,\n                            w: obj.width,\n                            h: obj.height,\n                            onClick: obj.onClick,\n                        };\n\n                        // add to hit map\n                        const x1key = Math.floor(absX1 / xBinSize);\n                        const x2key = Math.floor(absX2 / xBinSize);\n\n                        const y1key = Math.floor(absY1 / yBinSize);\n                        const y2key = Math.floor(absY2 / yBinSize);\n\n                        for (let xkey = x1key; xkey <= x2key; xkey++) {\n                            if (!hitM[xkey]) {\n                                hitM[xkey] = {};\n                            }\n                            const xbin = hitM[xkey];\n                            for (let ykey = y1key; ykey <= y2key; ykey++) {\n                                if (!xbin[ykey]) {\n                                    xbin[ykey] = [];\n                                }\n                                xbin[ykey].push(hitTarget);\n                            }\n                        }\n                    }\n                }\n            }\n            xCoord += cellW;\n        }\n\n        for (const y of rowSizes.index) {\n            xCoord = sheetStyle.rowHeaderWidth;\n            for (const x of columnSizes.index) {\n                const cellContent = displayData(x, y);\n                const cellW = cellWidth(x);\n                if (cellContent === null || cellContent === undefined) {\n                    xCoord += cellW;\n                    continue;\n                }\n\n                const xx = xCoord;\n                const yy = yCoord + cellHeight(y) * 0.5;\n\n                if (typeof cellContent === 'object' && cellContent.items) {\n                    let finalStyle;\n                    for (const obj of cellContent.items) {\n                        if (obj.onClick) {\n                            if (!finalStyle) {\n                                finalStyle = createStyleObject(cellStyle(x, y), defaultCellStyle);\n                            }\n                            const w = obj.content instanceof HTMLImageElement ? obj.width || cellW : 0;\n                            const absX1 = applyAlignment(xx, cellW, finalStyle, w, obj.horiozntalAlign) + obj.x;\n                            const absY1 = yy + obj.y;\n                            const absX2 = absX1 + (obj.width || 0);\n                            const absY2 = absY1 + (obj.height || 0);\n\n                            const hitTarget = {\n                                x: absX1,\n                                y: absY1,\n                                w: obj.width,\n                                h: obj.height,\n                                onClick: obj.onClick,\n                            };\n\n                            // add to hit map\n                            const x1key = Math.floor(absX1 / xBinSize);\n                            const x2key = Math.floor(absX2 / xBinSize);\n\n                            const y1key = Math.floor(absY1 / yBinSize);\n                            const y2key = Math.floor(absY2 / yBinSize);\n\n                            for (let xkey = x1key; xkey <= x2key; xkey++) {\n                                if (!hitM[xkey]) {\n                                    hitM[xkey] = {};\n                                }\n                                const xbin = hitM[xkey];\n                                for (let ykey = y1key; ykey <= y2key; ykey++) {\n                                    if (!xbin[ykey]) {\n                                        xbin[ykey] = [];\n                                    }\n                                    xbin[ykey].push(hitTarget);\n                                }\n                            }\n                        }\n                    }\n                }\n                xCoord += cellW;\n            }\n            yCoord += cellHeight(y);\n        }\n        return hitM;\n    }, [\n        displayData,\n        props.cellWidth,\n        props.cellHeight,\n        canvasRef,\n        columnSizes,\n        rowSizes,\n        dataOffset.x,\n        dataOffset.y,\n        sheetStyle,\n    ]);\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) {\n            return;\n        }\n        const context = canvas.getContext('2d');\n        if (!context) {\n            return;\n        }\n        let animationFrameId = window.requestAnimationFrame(() => {\n            renderOnCanvas(\n                context,\n                rowSizes,\n                columnSizes,\n                cellStyle,\n                cellWidth,\n                cellHeight,\n                selection,\n                props.secondarySelections || [],\n                knobDragInProgress,\n                columnHeaders,\n                columnHeaderStyle,\n                knobArea,\n                displayData,\n                dataOffset,\n                knobCoordinates,\n                sheetStyle\n            );\n        });\n\n        return () => {\n            window.cancelAnimationFrame(animationFrameId);\n        };\n    }, [\n        canvasRef,\n        rowSizes,\n        columnSizes,\n        cellStyle,\n        cellWidth,\n        cellHeight,\n        selection,\n        props.secondarySelections,\n        knobDragInProgress,\n        columnHeaders,\n        columnHeaderStyle,\n        knobArea,\n        displayData,\n        dataOffset,\n        knobCoordinates,\n        sheetStyle,\n    ]);\n\n    const setFocusToTextArea = () => {\n        if (copyPasteTextAreaRef.current) {\n            copyPasteTextAreaRef.current.focus({ preventScroll: true });\n            copyPasteTextAreaRef.current.select();\n        }\n    };\n\n    useEffect(() => {\n        if (!editMode) {\n            setCopyPasteText();\n        }\n    }, [selection, editData]);\n\n    useEffect(() => {\n        if (!editMode) {\n            if (document.activeElement === copyPasteTextAreaRef.current) {\n                setFocusToTextArea();\n            } else {\n                const activeTagName = (document as any).activeElement.tagName.toLowerCase();\n                if (\n                    !(\n                        (activeTagName === 'div' && (document as any).activeElement.contentEditable === 'true') ||\n                        activeTagName === 'input' ||\n                        activeTagName === 'textarea' ||\n                        activeTagName === 'select'\n                    )\n                ) {\n                    setFocusToTextArea();\n                }\n            }\n        }\n    });\n\n    const onPaste = (e: any) => {\n        if (!copyPasteTextAreaRef) {\n            return;\n        }\n        if (e.target !== copyPasteTextAreaRef.current) {\n            return;\n        }\n        e.preventDefault();\n\n        const clipboardData = e.clipboardData || (window as any).clipboardData;\n        const types = clipboardData.types;\n\n        if (types.includes('text/html')) {\n            const pastedHtml = clipboardData.getData('text/html');\n            parsePastedHtml(pastedHtml);\n        } else if (types.includes('text/plain')) {\n            const text = clipboardData.getData('text/plain');\n            parsePastedText(text);\n        }\n    };\n\n    useEffect(() => {\n        window.document.addEventListener('paste', onPaste);\n        return () => {\n            window.document.removeEventListener('paste', onPaste);\n        };\n    });\n\n    const findTable = (element: any): any => {\n        for (const child of element.children) {\n            if (child.nodeName === 'TABLE') {\n                return child;\n            }\n            const maybeTable = findTable(child);\n            if (maybeTable) {\n                return maybeTable;\n            }\n        }\n    };\n\n    const parsePastedHtml = (html: string) => {\n        const div = document.createElement('div');\n        div.innerHTML = html.trim();\n        let pasteLocX = -1;\n        let pasteLocY = -1;\n        if (selection.x1 !== -1 && selection.x2 === -1) {\n            pasteLocX = selection.x1;\n        }\n        if (selection.y1 !== -1 && selection.y2 === -1) {\n            pasteLocY = selection.y1;\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1) {\n            pasteLocX = Math.min(selection.x1, selection.x2);\n        }\n        if (selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocY = Math.min(selection.y1, selection.y2);\n        }\n        if (pasteLocX === -1 || pasteLocY === -1) {\n            return;\n        }\n\n        let x = pasteLocX;\n        let y = pasteLocY;\n        const changes = [];\n\n        const tableNode = findTable(div);\n        if (!tableNode) {\n            return;\n        }\n\n        for (const tableChild of tableNode.children) {\n            if (tableChild.nodeName === 'TBODY') {\n                for (const tr of tableChild.children) {\n                    x = pasteLocX;\n                    if (tr.nodeName === 'TR') {\n                        for (const td of tr.children) {\n                            if (td.nodeName === 'TD') {\n                                let str: string = '';\n                                if (td.children.length !== 0 && td.children[0].nodeName === 'P') {\n                                    const p = td.children[0];\n                                    if (p.children.length !== 0 && p.children[0].nodeName === 'FONT') {\n                                        str = p.children[0].textContent.trim();\n                                    } else {\n                                        str = p.textContent.trim();\n                                    }\n                                } else {\n                                    str = td.textContent.trim();\n                                }\n                                str = str.replaceAll('\\n', '');\n                                str = str.replaceAll(/\\s\\s+/g, ' ');\n                                changes.push({ y: y, x: x, value: str });\n                                x++;\n                            }\n                        }\n                        y++;\n                    }\n                }\n            }\n        }\n\n        if (props.onChange) {\n            props.onChange(changes);\n        }\n        let pasteX2 = x - 1;\n        let pasteY2 = y - 1;\n        changeSelection(pasteLocX, pasteLocY, pasteX2, pasteY2, false);\n    };\n\n    const parsePastedText = (text: string) => {\n        let pasteLocX = -1;\n        let pasteLocY = -1;\n        if (selection.x1 !== -1 && selection.x2 === -1) {\n            pasteLocX = selection.x1;\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1) {\n            pasteLocX = Math.min(selection.x1, selection.x2);\n        }\n        if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocX = 0;\n        }\n\n        if (selection.y1 !== -1 && selection.y2 === -1) {\n            pasteLocY = selection.y1;\n        }\n        if (selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocY = Math.min(selection.y1, selection.y2);\n        }\n        if (selection.y1 === -1 && selection.y2 === -1 && selection.x2 !== -1 && selection.x2 !== -1) {\n            pasteLocY = 0;\n        }\n\n        if (pasteLocX === -1 || pasteLocY === -1) {\n            return;\n        }\n\n        const rows = text.split(/\\r?\\n/);\n        let pasteX2 = pasteLocX;\n        let pasteY2 = pasteLocY + rows.length - 1;\n        const changes = [];\n        for (let y = 0; y < rows.length; y++) {\n            const cols = rows[y].split('\\t');\n\n            if (pasteLocX + cols.length - 1 > pasteX2) {\n                pasteX2 = pasteLocX + cols.length - 1;\n            }\n            for (let x = 0; x < cols.length; x++) {\n                changes.push({ y: pasteLocY + y, x: pasteLocX + x, value: cols[x] });\n            }\n        }\n\n        if (props.onChange) {\n            props.onChange(changes);\n        }\n        changeSelection(pasteLocX, pasteLocY, pasteX2, pasteY2, false);\n    };\n\n    const setCopyPasteText = () => {\n        if (selection.x1 === -1 && selection.y1 === -1 && selection.x2 === -1 && selection.y2 === -1) {\n            return;\n        }\n\n        let dy1 = selection.y1;\n        let dy2 = selection.y2;\n        if (dy1 > dy2) {\n            dy1 = selection.y2;\n            dy2 = selection.y1;\n        }\n\n        let dx1 = selection.x1;\n        let dx2 = selection.x2;\n        if (dx1 > dx2) {\n            dx1 = selection.x2;\n            dx2 = selection.x1;\n        }\n\n        if (dx1 === -1 && dx2 === -1) {\n            const max = findApproxMaxEditDataIndex(editData);\n            dx1 = 0;\n            dx2 = max.x;\n        }\n        if (dy1 === -1 && dy2 === -1) {\n            const max = findApproxMaxEditDataIndex(editData);\n            dy1 = 0;\n            dy2 = max.y;\n        }\n\n        let cptext = '';\n        let cptextTemp = '';\n        for (let y = dy1; y <= dy2; y++) {\n            let nonEmpty = false;\n            for (let x = dx1; x <= dx2; x++) {\n                const value = editData(x, y);\n                if (value !== null && value !== undefined) {\n                    cptextTemp += value;\n                    nonEmpty = true;\n                }\n                if (x !== dx2) {\n                    cptextTemp += '\\t';\n                }\n            }\n            if (y !== dy2) {\n                cptextTemp += '\\n';\n            }\n            if (nonEmpty) {\n                cptext += cptextTemp;\n                cptextTemp = '';\n            }\n        }\n        if (copyPasteTextAreaRef.current) {\n            copyPasteTextAreaRef.current.value = cptext;\n        }\n    };\n\n    const commitEditingCell = (value?: string) => {\n        if (props.onChange) {\n            props.onChange([{ x: editCell.x, y: editCell.y, value: value !== undefined ? value : editValue }]);\n        }\n\n        setEditCell({ x: -1, y: -1 });\n        setEditKey('');\n    };\n\n    const startEditingCell = (editCell: CellCoordinate) => {\n        if (cellReadOnly(editCell.x, editCell.y)) {\n            return;\n        }\n\n        const editDataValue = editData(editCell.x, editCell.y);\n        let val = '';\n        if (editDataValue !== null && editDataValue !== undefined) {\n            val = editDataValue;\n        }\n        const editDataKey = editKeys ? editKeys(editCell.x, editCell.y) : '';\n        setEditCell(editCell);\n        setEditKey(editDataKey);\n        setEditValue(val);\n        setShiftKeyDown(false);\n    };\n\n    const onScroll = (e: UIEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const absX = e.target.scrollLeft;\n        const absY = e.target.scrollTop;\n\n        const cellX = Math.floor(absX / scrollSpeed);\n        const cellY = Math.floor(absY / scrollSpeed);\n        if (cellX !== dataOffset.x || cellY !== dataOffset.y) {\n            setDataOffset({ x: cellX, y: cellY });\n        }\n\n        let newMaxScroll = { ...maxScroll };\n        if (maxScroll.x / (absX + 0.5) < 1) {\n            newMaxScroll.x *= 1.5;\n        }\n        if (maxScroll.y / (absY + 0.5) < 1) {\n            newMaxScroll.y *= 1.5;\n        }\n        if (newMaxScroll.x !== maxScroll.x || maxScroll.y !== newMaxScroll.y) {\n            setMaxScroll({ ...newMaxScroll });\n        }\n    };\n\n    const onMouseLeave = () => {\n        window.document.body.style.cursor = 'auto';\n    };\n\n    const onMouseDown = (e: MouseEvent) => {\n        if (e.button !== 0) {\n            return;\n        }\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n\n        // cancel selection\n        setSelectionInProgress(false);\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        if (x > canvasWidth || y > canvasHeight) {\n            return;\n        }\n\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    setButtonClickMouseDownCoordinates({ x, y, hitTarget });\n                    return;\n                }\n            }\n        }\n\n        if (!sheetStyle.hideColumnHeaders && y < sheetStyle.columnHeaderHeight) {\n            for (let colIdx = 0; colIdx < columnSizes.index.length; colIdx++) {\n                const start = columnSizes.start[colIdx];\n                const end = columnSizes.end[colIdx];\n                const index = columnSizes.index[colIdx];\n                if (\n                    Math.abs(start - x) < resizeColumnRowMouseThreshold ||\n                    Math.abs(end - x) < resizeColumnRowMouseThreshold\n                ) {\n                    window.document.body.style.cursor = 'col-resize';\n                    const indices: number[] = [];\n                    if (selection.x1 !== -1 && selection.x2 !== -1 && selection.y1 === -1 && selection.y2 === -1) {\n                        const min = Math.min(selection.x1, selection.x2);\n                        const max = Math.max(selection.x1, selection.x2);\n                        for (let i = min; i <= max; i++) {\n                            indices.push(i);\n                        }\n                    }\n                    if (indices.length === 0) {\n                        indices.push(index);\n                    }\n                    setColumnResize({\n                        startX: end,\n                        oldWidth: cellWidth(index),\n                        colIndices: indices,\n                    });\n                    return;\n                }\n            }\n        }\n        if (!sheetStyle.hideRowHeaders && x < sheetStyle.rowHeaderWidth) {\n            for (let rowIdx = 0; rowIdx < rowSizes.index.length; rowIdx++) {\n                const start = rowSizes.start[rowIdx];\n                const end = rowSizes.end[rowIdx];\n                const index = rowSizes.index[rowIdx];\n                if (\n                    Math.abs(start - y) < resizeColumnRowMouseThreshold ||\n                    Math.abs(end - y) < resizeColumnRowMouseThreshold\n                ) {\n                    window.document.body.style.cursor = 'row-resize';\n                    const indices: number[] = [];\n                    if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n                        const min = Math.min(selection.y1, selection.y2);\n                        const max = Math.max(selection.y1, selection.y2);\n                        for (let i = min; i <= max; i++) {\n                            indices.push(i);\n                        }\n                    }\n                    if (indices.length === 0) {\n                        indices.push(index);\n                    }\n                    setRowResize({\n                        startY: end,\n                        oldHeight: cellHeight(index),\n                        rowIndices: indices,\n                    });\n                    return;\n                }\n            }\n        }\n\n        // knob drag mode\n        if (Math.abs(x - knobCoordinates.x) < knobSize && Math.abs(y - knobCoordinates.y) < knobSize) {\n            setKnobDragInProgress(true);\n            setKnobArea({ x1: selection.x1, y1: selection.y1, x2: selection.x2, y2: selection.y2 });\n            return;\n        }\n\n        const sel2 = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        const sel1 = shiftKeyDown ? { x: selection.x1, y: selection.y1 } : { ...sel2 };\n\n        if (editMode) {\n            if (!props.dontCommitEditOnSelectionChange) {\n                commitEditingCell();\n            }\n        }\n\n        let scrollToP2 = true;\n\n        if (!sheetStyle.hideRowHeaders && x < sheetStyle.rowHeaderWidth) {\n            scrollToP2 = false;\n            setRowSelectionInProgress(true);\n            sel1.x = -1;\n            sel2.x = -1;\n        } else {\n            setRowSelectionInProgress(false);\n        }\n\n        if (!sheetStyle.hideColumnHeaders && y < sheetStyle.columnHeaderHeight) {\n            scrollToP2 = false;\n            setColumnSelectionInProgress(true);\n            sel1.y = -1;\n            sel2.y = -1;\n        } else {\n            setColumnSelectionInProgress(false);\n        }\n\n        setSelectionInProgress(true);\n        changeSelection(sel1.x, sel1.y, sel2.x, sel2.y, scrollToP2);\n        if (!props.dontCommitEditOnSelectionChange) {\n            setEditCell({ x: -1, y: -1 });\n            setEditKey('');\n        }\n    };\n\n    const onMouseUp = (e: MouseEvent) => {\n        if (knobDragInProgress) {\n            let sx1 = selection.x1;\n            let sx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                sx1 = selection.x2;\n                sx2 = selection.x1;\n            }\n            let sy1 = selection.y1;\n            let sy2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sy1 = selection.y2;\n                sy2 = selection.y1;\n            }\n            let kx1 = knobArea.x1;\n            let kx2 = knobArea.x2;\n            if (knobArea.x1 > knobArea.x2) {\n                kx1 = knobArea.x2;\n                kx2 = knobArea.x1;\n            }\n            let ky1 = knobArea.y1;\n            let ky2 = knobArea.y2;\n            if (knobArea.y1 > knobArea.y2) {\n                ky1 = knobArea.y2;\n                ky2 = knobArea.y1;\n            }\n\n            let fx1 = kx1;\n            let fy1 = ky1;\n            let fx2 = kx2;\n            let fy2 = ky2;\n\n            const changes: Array<Change> = [];\n\n            if (fx2 - fx1 === sx2 - sx1) {\n                // vertical\n                if (fy1 === sy1) {\n                    fy1 = sy2 + 1;\n                } else {\n                    fy2 = sy1 - 1;\n                }\n                if (fx1 === -1 && fx2 === -1) {\n                    const max = findApproxMaxEditDataIndex(editData);\n                    fx1 = 0;\n                    fx2 = max.x;\n                }\n                let srcY = sy1;\n                for (let y = fy1; y <= fy2; y++) {\n                    for (let x = fx1; x <= fx2; x++) {\n                        const value = sourceData(x, srcY);\n                        changes.push({ x: x, y: y, value: value, source: { x: x, y: srcY } });\n                    }\n                    srcY = srcY + 1;\n                    if (srcY > sy2) {\n                        srcY = sy1;\n                    }\n                }\n            } else {\n                // horizontal\n                if (fx1 === sx1) {\n                    fx1 = sx2 + 1;\n                } else {\n                    fx2 = sx1 - 1;\n                }\n                if (fy1 === -1 && fy2 === -1) {\n                    const max = findApproxMaxEditDataIndex(editData);\n                    fy1 = 0;\n                    fy2 = max.y;\n                }\n                let srcX = sx1;\n                for (let x = fx1; x <= fx2; x++) {\n                    for (let y = fy1; y <= fy2; y++) {\n                        const value = sourceData(srcX, y);\n                        changes.push({ x: x, y: y, value: value, source: { x: srcX, y: y } });\n                    }\n                    srcX = srcX + 1;\n                    if (srcX > sx2) {\n                        srcX = sx1;\n                    }\n                }\n            }\n\n            if (props.onChange) {\n                props.onChange(changes);\n            }\n\n            changeSelection(knobArea.x1, knobArea.y1, knobArea.x2, knobArea.y2);\n        }\n        setSelectionInProgress(false);\n        setRowSelectionInProgress(false);\n        setColumnSelectionInProgress(false);\n        setKnobDragInProgress(false);\n        setColumnResize(null);\n        setRowResize(null);\n\n        if (\n            buttonClickMouseDownCoordinates.x !== -1 &&\n            buttonClickMouseDownCoordinates.y !== -1 &&\n            buttonClickMouseDownCoordinates.hitTarget !== null\n        ) {\n            if (!e.target || !(e.target instanceof Element)) {\n                return;\n            }\n            const rect = e.target.getBoundingClientRect();\n            const x = e.clientX - rect.left;\n            const y = e.clientY - rect.top;\n            const hitTarget = buttonClickMouseDownCoordinates.hitTarget;\n            if (\n                hitTarget.x <= x &&\n                x <= hitTarget.x + hitTarget.w &&\n                hitTarget.y <= y &&\n                y <= hitTarget.y + hitTarget.h\n            ) {\n                hitTarget.onClick(e);\n            }\n            setButtonClickMouseDownCoordinates({ x: -1, y: -1, hitTarget: null });\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('mouseup', onMouseUp as any);\n        return () => {\n            window.removeEventListener('mouseup', onMouseUp as any);\n        };\n    });\n\n    const onMouseMove = (e: MouseEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        window.document.body.style.cursor = 'auto';\n\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    window.document.body.style.cursor = 'pointer';\n                }\n            }\n        }\n\n        if (!sheetStyle.hideColumnHeaders && props.onCellWidthChange && y < sheetStyle.columnHeaderHeight) {\n            let xx = sheetStyle.rowHeaderWidth;\n            for (const col of columnSizes.index) {\n                if (Math.abs(xx - x) < resizeColumnRowMouseThreshold) {\n                    window.document.body.style.cursor = 'col-resize';\n                    break;\n                }\n                xx += cellWidth(col);\n            }\n        }\n\n        if (!sheetStyle.hideRowHeaders && props.onCellHeightChange && x < sheetStyle.rowHeaderWidth) {\n            let yy = sheetStyle.columnHeaderHeight;\n            for (const row of rowSizes.index) {\n                if (Math.abs(yy - y) < resizeColumnRowMouseThreshold) {\n                    window.document.body.style.cursor = 'row-resize';\n                    break;\n                }\n                yy += cellHeight(row);\n            }\n        }\n\n        if (Math.abs(x - knobCoordinates.x) < knobSize && Math.abs(y - knobCoordinates.y) < knobSize) {\n            window.document.body.style.cursor = 'crosshair';\n        }\n\n        if (columnResize) {\n            if (props.onCellWidthChange) {\n                const newWidth = Math.max(columnResize.oldWidth + x - columnResize.startX, minimumColumnWidth);\n                props.onCellWidthChange(columnResize.colIndices, newWidth);\n            }\n            return;\n        }\n\n        if (rowResize) {\n            if (props.onCellHeightChange) {\n                const newHeight = Math.max(rowResize.oldHeight + y - rowResize.startY, minimumRowHeight);\n                props.onCellHeightChange(rowResize.rowIndices, newHeight);\n            }\n            return;\n        }\n\n        if (selectionInProgress) {\n            const sel2 = absCoordianteToCell(x, y, rowSizes, columnSizes);\n            if (rowSelectionInProgress) {\n                changeSelection(-1, selection.y1, -1, sel2.y, false);\n            } else if (columnSelectionInProgress) {\n                changeSelection(selection.x1, -1, sel2.x, -1, false);\n            } else {\n                changeSelection(selection.x1, selection.y1, sel2.x, sel2.y);\n            }\n        }\n\n        if (knobDragInProgress) {\n            window.document.body.style.cursor = 'crosshair';\n            const cell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x2;\n            let y2 = selection.y2;\n            if (x1 > x2) {\n                x1 = selection.x2;\n                x2 = selection.x1;\n            }\n            if (y1 > y2) {\n                y1 = selection.y2;\n                y2 = selection.y1;\n            }\n\n            // check if vertical or horizontal\n            let xCellDiff = 0; // zero or less\n            if (cell.x < x1) xCellDiff = cell.x - x1;\n            if (cell.x > x2) xCellDiff = x2 - cell.x;\n            let yCellDiff = 0; // zero or less\n            if (cell.y < y1) yCellDiff = cell.y - y1;\n            if (cell.y > y2) yCellDiff = y2 - cell.y;\n\n            if ((x1 === -1 && x2 === -1) || xCellDiff > yCellDiff) {\n                if (cell.y < y1) {\n                    y1 = cell.y;\n                } else {\n                    y2 = cell.y;\n                }\n            } else {\n                if (cell.x < x1) {\n                    x1 = cell.x;\n                } else {\n                    x2 = cell.x;\n                }\n            }\n            setKnobArea({ x1: x1, y1: y1, x2: x2, y2: y2 });\n        }\n    };\n\n    const onDoubleClick = (e: MouseEvent) => {\n        e.preventDefault();\n        if (!e.target || !(e.target instanceof Element) || shiftKeyDown) {\n            return;\n        }\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        // check if we clicked on a button and don't start editing if we did\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    return;\n                }\n            }\n        }\n        const editCell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        setArrowKeyCommitMode(false);\n        if (editMode) {\n            commitEditingCell();\n        }\n        startEditingCell(editCell);\n    };\n\n    const onKeyDown = (e: KeyboardEvent) => {\n        if (e.key === 'Escape') {\n            setEditCell({ x: -1, y: -1 });\n            setEditKey('');\n            return;\n        }\n        if (e.key === 'Enter') {\n            commitEditingCell();\n            changeSelection(selection.x1, selection.y1 + 1, selection.x1, selection.y1 + 1);\n        }\n        if (e.key === 'Tab') {\n            e.preventDefault();\n            commitEditingCell();\n            changeSelection(selection.x1 + 1, selection.y1, selection.x1 + 1, selection.y1);\n        }\n        if (arrowKeyCommitMode && ['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            e.preventDefault();\n            commitEditingCell();\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x1;\n            let y2 = selection.y1;\n            if (e.key === 'ArrowRight') {\n                x1 = selection.x1 + 1;\n                x2 = selection.x1 + 1;\n            } else if (e.key === 'ArrowLeft') {\n                x1 = selection.x1 - 1;\n                x2 = selection.x1 - 1;\n            } else if (e.key === 'ArrowUp') {\n                y1 = selection.y1 - 1;\n                y2 = selection.y1 - 1;\n            } else if (e.key === 'ArrowDown') {\n                y1 = selection.y1 + 1;\n                y2 = selection.y1 + 1;\n            }\n            changeSelection(x1, y1, x2, y2);\n        }\n    };\n\n    const onGridKeyDown = (e: KeyboardEvent) => {\n        if (editMode && arrowKeyCommitMode && ['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            commitEditingCell();\n            return;\n        }\n\n        if (e.key === 'Shift') {\n            setShiftKeyDown(true);\n            return;\n        }\n\n        if ((e.metaKey || e.ctrlKey) && String.fromCharCode(e.which).toLowerCase() === 'v') {\n            return;\n        }\n\n        // copy\n        if ((e.metaKey || e.ctrlKey) && String.fromCharCode(e.which).toLowerCase() === 'c') {\n            return;\n        }\n\n        if (e.key === 'Backspace' || e.key === 'Delete') {\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x2;\n            let y2 = selection.y2;\n            if (x1 > x2) {\n                x1 = selection.x2;\n                x2 = selection.x1;\n            }\n            if (y1 > y2) {\n                y1 = selection.y2;\n                y2 = selection.y1;\n            }\n            if (x1 === -1 && x2 === -1 && y1 !== -1 && y2 !== -1) {\n                x1 = 0;\n                x2 = maxSearchableRowOrCol;\n            }\n            if (x1 !== -1 && x2 !== -1 && y1 === -1 && y2 === -1) {\n                y1 = 0;\n                y2 = maxSearchableRowOrCol;\n            }\n            const changes: Change[] = [];\n            for (let y = y1; y <= y2; y++) {\n                for (let x = x1; x <= x2; x++) {\n                    changes.push({ x: x, y: y, value: null });\n                }\n            }\n            if (props.onChange) {\n                props.onChange(changes);\n            }\n            return;\n        }\n\n        // nothing selected\n        if (selection.x1 === -1 || selection.x2 === -1 || selection.y1 === -1 || selection.y2 === -1) {\n            return;\n        }\n\n        if (\n            (e.keyCode >= 48 && e.keyCode <= 57) ||\n            (e.keyCode >= 96 && e.keyCode <= 105) ||\n            (e.keyCode >= 65 && e.keyCode <= 90) ||\n            e.key === 'Enter' ||\n            e.key === '-' ||\n            e.key === '.' ||\n            e.key === ','\n        ) {\n            if (cellReadOnly(selection.x1, selection.y1)) {\n                e.preventDefault(); // so we dont get keystrokes inside the text area\n                return;\n            }\n\n            startEditingCell({ x: selection.x1, y: selection.y1 });\n            setArrowKeyCommitMode(e.key !== 'Enter');\n            return;\n        }\n\n        if (['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            let sel1 = { x: selection.x1, y: selection.y1 };\n            let sel2 = { x: selection.x2, y: selection.y2 };\n\n            let incr = { x: 0, y: 0 };\n            let direction: 'up' | 'down' | 'left' | 'right' = 'right';\n            if (e.key === 'ArrowRight' || e.key === 'Tab') {\n                incr.x = 1;\n                direction = 'right';\n            } else if (e.key === 'ArrowLeft') {\n                incr.x = -1;\n                direction = 'left';\n            } else if (e.key === 'ArrowUp') {\n                incr.y = -1;\n                direction = 'up';\n            } else if (e.key === 'ArrowDown') {\n                incr.y = 1;\n                direction = 'down';\n            }\n\n            if (e.metaKey || e.ctrlKey) {\n                const val = findInDisplayData(displayData, sel2, direction);\n                incr.x = val.x - sel2.x;\n                incr.y = val.y - sel2.y;\n            }\n\n            sel2.x += incr.x;\n            sel2.y += incr.y;\n\n            if (sel2.x < 0) {\n                sel2.x = 0;\n            }\n            if (sel2.y < 0) {\n                sel2.y = 0;\n            }\n            if (!e.shiftKey) {\n                sel1 = { ...sel2 };\n            }\n            changeSelection(sel1.x, sel1.y, sel2.x, sel2.y);\n            return;\n        }\n        e.preventDefault();\n    };\n\n    const onGridKeyUp = (e: KeyboardEvent) => {\n        setShiftKeyDown(e.shiftKey);\n    };\n\n    const onContextMenu = (e: MouseEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n        const cell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        const cellX = cell.x;\n        const cellY = cell.y;\n        let { x1, x2, y1, y2 } = selection;\n        if (x1 > x2) [x1, x2] = [x2, x1];\n        if (y1 > y2) [y1, y2] = [y2, y1];\n\n        if (!(y > sheetStyle.columnHeaderHeight && x > sheetStyle.rowHeaderWidth)) {\n            return;\n        }\n        //if click is not inside of selection, select the right clicked cell\n        if (!(cellX >= x1 && cellX <= x2) || !(cellY >= y1 && cellY <= y2)) {\n            changeSelection(cellX, cellY, cellX, cellY);\n        }\n\n        onMouseMove(e);\n        const ev: SheetMouseEvent = {\n            ...e,\n            cellX,\n            cellY,\n        };\n        props.onRightClick?.(ev);\n    };\n\n    const editMode = editCell.x !== -1 && editCell.y !== -1;\n    let editTextPosition = { x: 0, y: 0 };\n    let editTextWidth = 0;\n    let editTextHeight = 0;\n    let editTextTextAlign: 'right' | 'left' | 'center' = 'right';\n    if (editMode) {\n        editTextPosition = cellToAbsCoordinate(\n            editCell.x,\n            editCell.y,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight,\n            sheetStyle\n        );\n        const style = cellStyle(editCell.x, editCell.y);\n        // add 1 so it doesnt cover the selection border\n        editTextPosition.x += 1;\n        editTextPosition.y += 1;\n        editTextWidth = cellWidth(editCell.x) - 2;\n        editTextHeight = cellHeight(editCell.y) - 2;\n        editTextTextAlign = style.textAlign || defaultCellStyle.textAlign || 'left';\n    }\n\n    const inputProps = {\n        value: editValue,\n        autoFocus: true,\n        onKeyDown: onKeyDown,\n        style: {\n            position: 'absolute',\n            top: editTextPosition.y,\n            left: editTextPosition.x,\n            width: editTextWidth,\n            height: editTextHeight,\n            outline: 'none',\n            border: 'none',\n            textAlign: editTextTextAlign,\n            color: 'black',\n            fontSize: defaultCellStyle.fontSize,\n            fontFamily: 'sans-serif',\n        } as InputStyle,\n    };\n\n    const input = props.inputComponent?.(\n        editCell.x,\n        editCell.y,\n        { ...inputProps, onChange: setEditValue } as SheetInputProps,\n        commitEditingCell\n    );\n\n    let overlayDivClassName = styles.sheetscroll;\n    const overlayDivStyles: React.CSSProperties = {\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        top: 0,\n        left: 0,\n        overflow: 'scroll',\n        borderBottom: '1px solid #ddd',\n    };\n    const canvasStyles: React.CSSProperties = {\n        width: 'calc(100% - 14px)',\n        height: 'calc(100% - 15px)',\n        outline: '1px solid #ddd', // find another better solution ?\n    };\n\n    if (sheetStyle.hideScrollBars) {\n        delete canvasStyles['outline'];\n        delete overlayDivStyles['borderBottom'];\n        overlayDivClassName = '';\n        canvasStyles.width = 'calc(100%)';\n    }\n\n    return (\n        <div style={{ position: 'relative', height: '100%' }}>\n            <canvas style={canvasStyles} ref={canvasRef} />\n            <div\n                ref={overlayRef}\n                onDoubleClick={onDoubleClick}\n                onMouseDown={onMouseDown}\n                onMouseMove={onMouseMove}\n                onMouseLeave={onMouseLeave}\n                onContextMenu={onContextMenu}\n                onScroll={onScroll}\n                className={overlayDivClassName}\n                style={overlayDivStyles}\n            >\n                <div\n                    style={{\n                        position: 'absolute',\n                        left: 0,\n                        top: 0,\n                        width: 1,\n                        height: maxScroll.y + 2000,\n                        backgroundColor: 'rgba(0,0,0,0.0)',\n                    }}\n                ></div>\n                <div\n                    style={{\n                        position: 'absolute',\n                        left: 0,\n                        top: 0,\n                        width: maxScroll.x + 5000,\n                        height: 1,\n                        backgroundColor: 'rgba(0,0,0,0.0)',\n                    }}\n                ></div>\n            </div>\n            <textarea\n                style={{ position: 'absolute', top: 0, left: 0, width: 1, height: 1, opacity: 0.01 }}\n                ref={copyPasteTextAreaRef}\n                autoComplete=\"off\"\n                autoCorrect=\"off\"\n                autoCapitalize=\"off\"\n                spellCheck=\"false\"\n                onFocus={(e) => e.target.select()}\n                tabIndex={0}\n                onKeyDown={onGridKeyDown}\n                onKeyUp={onGridKeyUp}\n            ></textarea>\n            {editMode &&\n                (input !== undefined ? (\n                    input\n                ) : (\n                    <input\n                        {...inputProps}\n                        type=\"text\"\n                        onFocus={(e) => e.target.select()}\n                        onChange={(e) => setEditValue(e.target.value)}\n                    />\n                ))}\n        </div>\n    );\n}\n\nexport default Sheet;\n","import React, { useState } from 'react';\nimport Sheet from 'sheet-happens';\nimport 'sheet-happens/dist/index.css';\n\nconst initialDataBig = [];\nfor (let row = 0; row < 1000; row++) {\n    const r = [];\n    for (let col = 0; col < 100; col++) {\n        r.push(`Row: ${row}, Col: ${col}`);\n    }\n    initialDataBig.push(r);\n}\n\nconst initialDataBasic = [\n    ['First', 'Second', 'Third', 'Fourth', 'Fifth', 'Sixth'],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n];\n\nconst initialDataFormatting = [];\nfor (let row = 0; row < 1000; row++) {\n    const r = [];\n    for (let col = 0; col < 100; col++) {\n        r.push(Math.random() * 1000000);\n    }\n    initialDataFormatting.push(r);\n}\n\nconst triangleDown = new Image();\ntriangleDown.src =\n    'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=';\ntriangleDown.width = 10;\ntriangleDown.height = 10;\n\nexport const DEFAULT_CELL_WIDTH = 100;\nexport const DEFAULT_CELL_HEIGHT = 22;\n\nexport default function useWidthHeigthControl(initialWidths = [], initialHeights = []) {\n    const [cellWidth, setCellWidth] = useState(initialWidths);\n    const [cellHeight, setCellHeight] = useState(initialHeights);\n\n    const onCellWidthChange = (indices, newWidth) => {\n        const cw = [...cellWidth];\n        for (const idx of indices) {\n            if (idx > cw.length) {\n                for (let i = cw.length; i <= idx; i++) {\n                    cw.push(DEFAULT_CELL_WIDTH);\n                }\n            }\n            cw[idx] = newWidth;\n        }\n        setCellWidth(cw);\n    };\n\n    const onCellHeightChange = (indices, newHeight) => {\n        const ch = [...cellHeight];\n        for (const idx of indices) {\n            if (idx > ch.length) {\n                for (let i = ch.length; i <= idx; i++) {\n                    ch.push(DEFAULT_CELL_HEIGHT);\n                }\n            }\n            ch[idx] = newHeight;\n        }\n        setCellHeight(ch);\n    };\n\n    return { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight };\n}\n\nexport function SheetBoxHeader() {\n    const [data, setData] = useState(initialDataBig);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxBasic() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(initialDataBasic)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n            />\n        </div>\n    );\n}\n\nconst faCheck = new Image();\nfaCheck.src =\n    'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==';\nfaCheck.width = 16;\nfaCheck.height = 16;\n\nexport function SheetBoxStyle() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(initialDataBasic)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = (index) => {\n        if (index === 0) {\n            return {\n                items: [\n                    {\n                        content: 'A',\n                        x: 0,\n                        y: 0,\n                        horiozntalAlign: 'center',\n                    },\n                    {\n                        content: triangleDown,\n                        x: 0,\n                        y: -6,\n                        width: 12,\n                        height: 12,\n                        horiozntalAlign: 'right',\n                        onClick: () => {\n                            console.log('click');\n                        },\n                    },\n                ],\n            };\n        } else {\n            return null;\n        }\n    };\n    const colors = ['#f00', '#0f0', '#00f', '#000'];\n    const alignment = ['left', 'right', 'center'];\n    const weight = ['normal', 'bold', 'lighter'];\n    const marginRight = [0, 0, 0, 0, 20];\n    const cellStyle = (x, y) => {\n        if (x === 0 || y === 0) {\n            return {\n                fillColor: '#6DA2FB22',\n                marginRight: 10,\n            };\n        }\n        return {\n            color: colors[y % 4],\n            textAlign: alignment[x % 3],\n            marginRight: marginRight[x % 5],\n            weight: weight[y % 3],\n        };\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const incrementCell = (x, y) => {\n        const newData = [...data];\n        if (newData[y] && newData[y][x] !== undefined) {\n            newData[y][x] += 1;\n        }\n        setData(newData);\n    };\n    const displayData = (x, y) => {\n        if (x === 0 && y > 0 && y < 9) {\n            return {\n                items: [\n                    {\n                        content: faCheck,\n                        x: 0,\n                        y: -8,\n                        width: 16,\n                        height: 16,\n                        horiozntalAlign: 'right',\n                        onClick: () => {\n                            incrementCell(x, y);\n                        },\n                    },\n                    {\n                        content: data?.[y]?.[x],\n                        x: 0,\n                        y: 0,\n                        horiozntalAlign: 'left',\n                    },\n                ],\n            };\n        }\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                sheetStyle={{\n                    freezeColumns: 1,\n                    freezeRows: 1,\n                }}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxFormatting() {\n    const [data, setData] = useState(initialDataFormatting);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x]?.toFixed?.(2);\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = Number(change.value);\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxVeryBigData() {\n    const [loadingStatus, setLoadingStatus] = useState('initial');\n    const [data, setData] = useState([]);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const loadClick = (e) => {\n        e.preventDefault();\n        setLoadingStatus('loading');\n        fetch('./out.json')\n            .then((response) => {\n                return response.json();\n            })\n            .then((dataset) => {\n                setData(dataset);\n                setLoadingStatus('done');\n            });\n    };\n\n    const cellStyle = (x, y) => {\n        if (y === 0) {\n            return {\n                weight: 'bold',\n                fontSize: 14,\n            };\n        }\n        if (x === 4) {\n            return {\n                textAlign: 'right',\n            };\n        } else if (x === 1) {\n            return {\n                weight: 'bold',\n                color: '#3b85ff',\n            };\n        } else if (x === 2) {\n            return {\n                color: '#fc3bff',\n            };\n        }\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        if (x === 4 && y > 0) {\n            if (data && data[y] && data[y][x]) {\n                return Number(data[y][x]).toFixed(2);\n            } else {\n                return '';\n            }\n        }\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    const headerStyle = (index) => {\n        const r = ((index * 2421) % 255).toString(16).padStart(2, '0');\n        const g = ((index * 3215) % 255).toString(16).padStart(2, '0');\n        const b = ((index * 1243) % 255).toString(16).padStart(2, '0');\n        const color = `#${r}${g}${b}55`;\n        return {\n            backgroundColor: color,\n        };\n    };\n\n    const columnHeaders = (index) => {\n        return '' + index;\n    };\n\n    return (\n        <>\n            {loadingStatus === 'initial' ? (\n                <a href=\"#\" onClick={loadClick}>\n                    Load global database of power plants\n                </a>\n            ) : loadingStatus === 'loading' ? (\n                'Loading...'\n            ) : null}\n            <div className=\"sheet-box\">\n                <Sheet\n                    cellStyle={cellStyle}\n                    editData={editData}\n                    displayData={displayData}\n                    sourceData={sourceData}\n                    cellWidth={cellWidth}\n                    cellHeight={cellHeight}\n                    onChange={onChange}\n                    readOnly={isReadOnly}\n                    onCellWidthChange={onCellWidthChange}\n                    onCellHeightChange={onCellHeightChange}\n                    columnHeaderStyle={headerStyle}\n                    columnHeaders={columnHeaders}\n                    sheetStyle={{\n                        freezeColumns: 0,\n                        freezeRows: 1,\n                    }}\n                />\n            </div>\n        </>\n    );\n}\n\nconst customInputOptions = ['First', 'Second', 'Third', 'Fourth', 'Fifth'];\nconst customInputOptions2 = ['Sixth', 'Seventh', 'Eighth', 'Ninth', 'Tenth'];\nconst customInputData = [\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n];\n\nexport function SheetBoxCustomInput() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(customInputData)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                inputComponent={CustomInput}\n            />\n        </div>\n    );\n}\n\nfunction CustomInput(x, y, inputProps, commitEditingCell) {\n    const clickHandler = (value) => {\n        commitEditingCell(value);\n    };\n\n    return (\n        <div style={{ ...inputProps.style, backgroundColor: '#fff' }}>\n            <div style={{ border: '1px solid #ddd', boxShadow: '3px 5px 5px #ddd' }}>\n                {(y % 2 ? customInputOptions2 : customInputOptions).map((opt) => {\n                    return (\n                        <CustomOption\n                            key={opt}\n                            opt={opt}\n                            value={inputProps.value}\n                            clickHandler={() => clickHandler(opt)}\n                        />\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n\nfunction CustomOption({ opt, value, clickHandler }) {\n    const [hover, setHover] = useState(false);\n\n    return (\n        <div\n            onMouseEnter={() => {\n                setHover(true);\n            }}\n            onMouseLeave={() => {\n                setHover(false);\n            }}\n            style={{\n                backgroundColor: value === opt || hover ? '#f6f6f6' : '#fff',\n                padding: '5px 10px',\n                cursor: 'pointer',\n            }}\n            value={opt}\n            onClick={() => clickHandler(opt)}\n        >\n            {opt}\n        </div>\n    );\n}\n\nexport function SheetBoxSourceDisplayData() {\n    const [data] = useState([\n        [1, 2, 3],\n        [10, 20, 30],\n    ]);\n\n    const displayData = (x, y) => {\n        return data?.[y]?.[x]?.toFixed?.(2);\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                sourceData={data} // array of arrays of data\n                displayData={displayData}\n            />\n        </div>\n    );\n}\n","import React from 'react';\nimport { useRef, useState } from 'react';\nimport { SheetBoxHeader } from './SheetBox';\nimport GitIcon from '../assets/git.svg';\n\nfunction Header() {\n    const textAreaRef = useRef(null);\n    const [copySuccess, setCopySuccess] = useState('');\n\n    const copyToClipboard = (e) => {\n        textAreaRef.current.select();\n        document.execCommand('copy');\n        e.target.focus();\n        setCopySuccess('Copied!');\n        setTimeout(() => {\n            setCopySuccess('');\n        }, 1000);\n    };\n\n    return (\n        <div className=\"container blue-bg\" id=\"home\">\n            <div className=\"content flex-row header\">\n                <div className=\"box text-box\">\n                    <div>\n                        <h1>Beautiful and fast spreadsheet component for React</h1>\n                        <p className=\"lightblue-p\">\n                            Sheet Happens is easy to implement and extend.\n                            <br></br>\n                            And it's super fast.\n                        </p>\n                    </div>\n                    <div className=\"lib-box\">\n                        <div className=\"install-box\" onClick={copyToClipboard}>\n                            <input readOnly ref={textAreaRef} value=\"npm install --save sheet-happens\" />\n                            {copySuccess !== '' && <div className=\"copy-success\">{copySuccess}</div>}\n                        </div>\n                        <a\n                            href=\"https://github.com/farseerdev/sheet-happens\"\n                            rel=\"noopener noreferrer\"\n                            className=\"git-box\"\n                            target=\"_blank\"\n                        >\n                            <img src={GitIcon} alt=\"Git\" />\n                            view on github\n                        </a>\n                    </div>\n                </div>\n                <div className=\"box\">\n                    <SheetBoxHeader />\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Header;\n","import React from 'react';\n\nfunction TitleSeparator({ title, id }) {\n    return (\n        <div className=\"title-separator\" id={id ? id : ''}>\n            <p>{title ? title : 'No title'}</p>\n            <div className=\"separator\"></div>\n        </div>\n    );\n}\n\nexport default TitleSeparator;\n","import React from 'react';\n\nfunction Wrap({ children }) {\n    return (\n        <div className=\"container\">\n            <div className=\"content flex-row\">{children}</div>\n        </div>\n    );\n}\n\nexport default Wrap;\n","import React from 'react';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\nimport { xcode } from 'react-syntax-highlighter/dist/esm/styles/hljs';\nxcode.hljs.padding = '10px 20px';\nxcode.hljs.background = '#f8f9fa';\nxcode.hljs.width = '100%';\nxcode.hljs.maxWidth = '100%';\nxcode.hljs.overflow = 'auto';\nxcode.hljs.borderRadius = '3px';\nxcode.hljs.fontSize = '14px';\n\nfunction Code() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`function SheetBox() {\n    const [data, setData] = useState(initialData);\n    const [cellWidth, setCellWidth] = useState([]);\n    const [cellHeight, setCellHeight] = useState([]);\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    const onCellWidthChange = (columnIdx, newWidth) => {\n        const cw = [...cellWidth];\n        if (columnIdx > cw.length) {\n            for (let i = cw.length; i <= columnIdx; i++) {\n                cw.push(100);\n            }\n        }\n        cw[columnIdx] = newWidth;\n        setCellWidth(cw);\n    };\n    const onCellHeightChange = (rowIdx, newHeight) => {\n        const ch = [...cellHeight];\n        if (rowIdx > ch.length) {\n            for (let i = ch.length; i <= rowIdx; i++) {\n                ch.push(22);\n            }\n        }\n        ch[rowIdx] = newHeight;\n        setCellHeight(ch);\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport default Code;\n\nexport function SourceDisplayDataCode() {\n    let xcode2 = { ...xcode };\n    xcode2.hljs.height = '100%';\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode2}>\n            {`const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function InitSheetCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function InitSheetWithDataCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function EditDataCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function CellStyleSizeCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n","import React from 'react';\n\nfunction Footer() {\n    return (\n        <div className=\"footer\">\n            <p className=\"copy\">made by <a href=\"https://www.farseer.io\">farseer</a></p>\n        </div>\n    );\n}\n\nexport default Footer;\n","import React from 'react';\nimport './index.css';\n\nimport Menu from './components/Menu';\nimport Header from './components/Header';\nimport TitleSeparator from './components/TitleSeparator';\nimport Wrap from './components/Wrap';\nimport {\n    InitSheetCode,\n    InitSheetWithDataCode,\n    SourceDisplayDataCode,\n    EditDataCode,\n    CellStyleSizeCode,\n} from './components/Code';\nimport {\n    SheetBoxStyle,\n    SheetBoxBasic,\n    SheetBoxFormatting,\n    SheetBoxVeryBigData,\n    SheetBoxCustomInput,\n    SheetBoxSourceDisplayData,\n} from './components/SheetBox';\nimport Footer from './components/Footer';\n\nconst App = () => {\n    return (\n        <>\n            <Menu />\n            <Header />\n\n            <TitleSeparator title=\"Get started\" id=\"usage\" />\n            <Wrap>\n                <div className=\"box full-width colored-pre\" style={{ overflowX: 'auto' }}>\n                    <p>Import the component and its style, and render it</p>\n                    <InitSheetCode />\n\n                    <div className=\"spacer\" />\n\n                    <p>Display some data</p>\n                    <InitSheetWithDataCode />\n                </div>\n            </Wrap>\n\n            <TitleSeparator title=\"Learn more about features\" id=\"features\" />\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxBasic />\n                </div>\n                <div className=\"box\">\n                    <h3>Basic spreadsheet</h3>\n                    <p>\n                        It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by\n                        dragging the small square, copy/paste from and to Excel and Google Sheets, resize columns and\n                        rows.\n                    </p>\n                </div>\n            </Wrap>\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxStyle />\n                </div>\n                <div className=\"box\">\n                    <h3>Styling</h3>\n                    <p>\n                        You can change the cell color, alignment, font weight, margins and more. It's also possible to\n                        freeze first rows or columns, and add clickable images.\n                    </p>\n                </div>\n            </Wrap>\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxFormatting />\n                </div>\n                <div className=\"box\">\n                    <h3>Formatting</h3>\n                    <p>\n                        Sheet Happens uses different datasets for display and edit so you can apply different formatting\n                        when displaying the cell and editing the cell.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Big dataset example\" id=\"big dataset example\" />\n            <Wrap>\n                <div className=\"box full-width\">\n                    <p>\n                        Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it\n                        will be handled blazingly fast and super responsive because component is canvas-based and it\n                        draws only the small chunk of data user sees at the moment.\n                    </p>\n                    <br />\n                    <SheetBoxVeryBigData />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Custom input fields\" id=\"custom input example\" />\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxCustomInput />\n                </div>\n                <div className=\"box\">\n                    <h3>Custom input component</h3>\n                    <p>\n                        If basic text input isn't enough, you can send your own React component to be displayed instead.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Documentation\" id=\"documentation\" />\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* sourceData displayData */}\n                    <h3>Displaying data</h3>\n                    <p>\n                        If you have some data you want to display, you send it via <Emphased text=\"sourceData\" /> and{' '}\n                        <Emphased text=\"displayData\" /> props.\n                    </p>\n                    <p>\n                        The first one receives unformatted data which is used for data manipulation, and the second one\n                        formatted which is used for displaying in cells.\n                    </p>\n                    <br />\n                    <p>\n                        Each of this can be either array of arrays of values (where each array is representing data for\n                        one row) or function (which returns value based on x and y coordinates that are sent as\n                        arguments to your function).\n                    </p>\n                </div>\n            </Wrap>\n\n            <Wrap>\n                <div className=\"box colored-pre unmargin-pre\" style={{ maxWidth: '100%', overflow: 'auto' }}>\n                    <SourceDisplayDataCode />\n                </div>\n                <div className=\"box\">\n                    <SheetBoxSourceDisplayData />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box\">\n                    {/*editData onChange readOnly */}\n                    <h3>Editing data</h3>\n                    <p>\n                        Same as the previous two, prop <Emphased text=\"editData\" /> can recieve either array of arrays\n                        of values or function for data which will be displayed in edit mode. Edit mode is activated by\n                        double click on the cell.\n                    </p>\n                    <br />\n                    <p>\n                        Once edit is done, function sent in <Emphased text=\"onChange\" /> prop will be called with array\n                        of changes as an argument. Each element of this array has value, x and y coordinates. Use this\n                        information to change values in your data array.\n                    </p>\n                    <br />\n                    <p>\n                        Sheet also accepts <Emphased text=\"readOnly\" /> prop which you can use if some cells should not\n                        be editable. Same as the most of sheet's props, you can send function, array of arrays, or a\n                        single value which then is applied to the whole table.\n                    </p>\n                </div>\n\n                <div className=\"box unmargin-pre\">\n                    <EditDataCode />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* columnHeaders */}\n                    <h3>Column headers</h3>\n                    <p>\n                        By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via{' '}\n                        <Emphased text=\"columnHeaders\" /> prop as an array or function.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box\">\n                    {/* cellStyle cellWidth cellHeight onCellWidthChange onCellHeightChange */}\n                    <h3>Cell style and width/height</h3>\n                    <p>\n                        Use prop <Emphased text=\"cellStyle\" /> and <Emphased text=\"columnHeaderStyle\" /> for customizing\n                        cells visually.\n                    </p>\n                    <br />\n                    <p>\n                        You can also use <Emphased text=\"cellWidth\" /> and <Emphased text=\"cellHeight\" /> props to\n                        customize cell size. If you send single value {`cellWidth={200}`}, it will be applayed to all\n                        cells. If you send array of values {`cellWidth={[200, 80, 80]}`}, they will be applied in\n                        respect to the index number.\n                    </p>\n                    <br />\n                    <p>\n                        There are also <Emphased text=\"onCellWidthChange\" /> and <Emphased text=\"onCellHeightChange\" />{' '}\n                        props for functions which are called when user drags cell for resize. You can use these for\n                        updating your cellWidth/cellHeight arrays.\n                    </p>\n                </div>\n                <div className=\"box unmargin-pre\">\n                    <CellStyleSizeCode />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* onSelectionChanged */}\n                    <h3>Selection</h3>\n                    <p>\n                        You can send function to <Emphased text=\"onSelectionChanged\" /> prop. It will be called on\n                        selection change with x1, y1, x2 and y2 arguments.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* onRightClick */}\n                    <h3>Right click handler</h3>\n                    <p>\n                        If you send a function to <Emphased text=\"onRightClick\" /> prop, it will be called on right\n                        click with whole mouse event (extended with cellX and cellY values) as an argument.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* freezeColumns freezeRows */}\n                    <h3>Sticky columns/rows</h3>\n                    <p>\n                        Send a number to <Emphased text=\"freezeColumns\" /> and/or <Emphased text=\"freezeRows\" /> to make\n                        first n of columns/rows sticky.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* inputComponent */}\n                    <h3>Custom input</h3>\n                    <p>\n                        By default edit mode turns cell into text edit component. But you can send your custom input\n                        component via <Emphased text=\"inputComponent\" /> props. It will be called with{' '}\n                        <Emphased text=\"x\" />, <Emphased text=\"y\" />, <Emphased text=\"inputProps\" /> and{' '}\n                        <Emphased text=\"commitEditingCell\" /> arguments.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Footer />\n        </>\n    );\n};\n\nfunction Emphased({ text }) {\n    return <span className=\"emphased\">{text}</span>;\n}\n\nexport default App;\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}