(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{11:function(e,t,a){e.exports=a.p+"static/media/logo.aef13910.svg"},13:function(e,t,a){e.exports=a.p+"static/media/git.f818b886.svg"},18:function(e,t,a){e.exports=a(231)},23:function(e,t,a){},231:function(e,t,a){"use strict";a.r(t);a(6);var n=a(0),l=a.n(n),r=a(10),o=a.n(r),i=a(11),c=a.n(i);var s=function(){const e=e=>{var t=document.getElementById(e),a="home"===e?0:86,n=window.pageYOffset+t.getBoundingClientRect().top-a;window.scrollTo({top:n,behavior:"smooth"})};return l.a.createElement("div",{className:"container blue-bg menu"},l.a.createElement("div",{className:"content flex-row"},l.a.createElement("div",{className:"logo-box"},l.a.createElement("img",{src:c.a,alt:"Logo"}),l.a.createElement("h2",{className:"page-title"},"sheet - happens")),l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"nav-item",onClick:()=>e("home")},"home"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("usage")},"usage"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("features")},"features"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("documentation")},"documentation"))))},u=a(1),d=a(4),h=a(3),f=a(12);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function v(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"===typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}var x="_PxIi8",g={textAlign:"left",fontSize:13,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},p={textAlign:"center",fontSize:13,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""};function b(e){var t=e.getBoundingClientRect(),a=t.width,n=t.height,l=window.devicePixelRatio,r=void 0===l?1:l;r<1&&(r=1);var o=Math.round(a*r),i=Math.round(n*r);if(e.width!==o||e.height!==i){var c=e.getContext("2d");return c&&(e.width=o,e.height=i,c.scale(r,r)),!0}return!1}function E(e,t){return Array.isArray(e)?function(a){return a>=0&&a<e.length?e[a]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}}function w(e,t){return Array.isArray(e)?function(a,n){return n>=0&&n<e.length&&a>=0&&a<e[n].length?e[n][a]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}}function C(e,t,a,n,l){return l||(l=a.textAlign),"left"===l?e+a.marginLeft:"center"===l?e+.5*t-n/2:"right"===l?e+(t-a.marginRight-n):e}function j(e,t,a,n,l,r,o,i){if(null!==t){var c=M(a,n);e.fillStyle=c.color,e.font=c.weight+" "+c.fontSize+"px "+c.fontFamily,e.textAlign=c.textAlign;var s=r+.5*i;if(e.save(),e.beginPath(),e.rect(l,r,o,i),e.clip(),""!==c.backgroundColor&&(e.fillStyle=c.backgroundColor,e.fillRect(l,r,o,i),e.fillStyle=c.color),"string"===typeof t||"number"===typeof t){var u=C(l,o,c,0);e.fillText(""+t,u,s)}else if("object"===typeof t)for(var d,h=v(t.items);!(d=h()).done;){var f=d.value;if(f.content instanceof HTMLImageElement){var y=C(l,o,c,f.width||o,f.horiozntalAlign);e.drawImage(f.content,y+f.x,s+f.y,f.width||o,f.height||i)}else if("string"===typeof f.content||"number"===typeof f.content){f.horiozntalAlign&&(e.textAlign=f.horiozntalAlign);var m=C(l,o,c,0,f.horiozntalAlign);e.fillText(""+f.content,m+f.x,s+f.y)}}e.restore()}}function S(e,t,a,n,l){var r=[],o=[],i=[],c=0;o.push(a),r.push(e>0?0:n),c=a+t(e>0?0:n),i.push(c);var s=e>0?1:n+1;if(e>0){for(;s<e;s++)r.push(s),o.push(c),c+=t(s),i.push(c);s=Math.max(n,e)}for(;r.push(s),o.push(c),c+=t(s),i.push(c),!(i[i.length-1]>=l);)s++;return{index:r,start:o,end:i}}function M(e,t){return y({},t,e)}function N(e){for(var t="",a=0;e>0;)a=(e-1)%26,t=String.fromCharCode(65+a)+t,e=(e-a)/26|0;return t||""}function O(e,t,a,n){for(var l=0,r=0,o=0;o<n.index.length;o++)if(e>=n.start[o]&&e<=n.end[o]){l=n.index[o];break}for(var i=0;i<a.index.length;i++)if(t>=a.start[i]&&t<=a.end[i]){r=a.index[i];break}return{x:l,y:r}}function A(e,t,a,n,l,r,o){var i=50,c=n.index.findIndex((function(t){return t===e}));if(-1!==c)i=n.start[c];else{for(var s=0;s<l.x;s++)i-=r(s);for(var u=0;u<e;u++)i+=r(u)}var d=22,h=a.index.findIndex((function(e){return e===t}));if(-1!==h)d=a.start[h];else{for(var f=0;f<l.y;f++)d-=o(f);for(var y=0;y<t;y++)d+=o(y)}return{x:i,y:d}}var D=function(e){var t,a=Object(n.useRef)(null),r=Object(n.useRef)(null),o=Object(n.useRef)(null),i=Object(n.useState)({x:5e3,y:5e3}),c=i[0],s=i[1],u=Object(n.useState)({x:0,y:0}),d=u[0],h=u[1],m=Object(n.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),D=m[0],k=m[1],I=Object(n.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),z=I[0],H=I[1],T=Object(n.useState)({x:-1,y:-1}),L=T[0],W=T[1],R=Object(n.useState)(""),Y=R[0],B=R[1],F=Object(n.useState)(""),P=F[0],Z=F[1],J=Object(n.useState)(!1),X=J[0],G=J[1],K=Object(n.useState)(!1),Q=K[0],U=K[1],V=Object(n.useState)(!1),q=V[0],_=V[1],$=Object(n.useState)(!1),ee=$[0],te=$[1],ae=Object(n.useState)(null),ne=ae[0],le=ae[1],re=Object(n.useState)(null),oe=re[0],ie=re[1],ce=Object(n.useState)(!1),se=ce[0],ue=ce[1],de=Object(n.useState)(!1),he=de[0],fe=de[1],ye=Object(n.useState)({x:-1,y:-1,hitTarget:null}),me=ye[0],ve=ye[1],xe=Object(f.a)({ref:a}),ge=xe.width,pe=void 0===ge?3e3:ge,be=xe.height,Ee=void 0===be?3e3:be,we=e.freezeColumns||0,Ce=e.freezeRows||0,je=Object(n.useMemo)((function(){return E(e.cellWidth,100)}),[e.cellWidth]),Se=Object(n.useMemo)((function(){return E(e.cellHeight,22)}),[e.cellHeight]),Me=Object(n.useMemo)((function(){return E(e.columnHeaders,null)}),[e.columnHeaders]),Ne=Object(n.useMemo)((function(){return E(e.columnHeaderStyle,{})}),[e.columnHeaderStyle]),Oe=Object(n.useMemo)((function(){return w(e.readOnly,!1)}),[e.readOnly]),Ae=Object(n.useMemo)((function(){return w(e.sourceData,null)}),[e.sourceData]),De=Object(n.useMemo)((function(){return w(e.displayData,"")}),[e.displayData]),ke=Object(n.useMemo)((function(){return w(e.editData,"")}),[e.editData]),Ie=Object(n.useMemo)((function(){return w(e.editKeys,"")}),[e.editKeys]),ze=Object(n.useMemo)((function(){return w(e.cellStyle,g)}),[e.cellStyle]);Object(n.useEffect)((function(){(Ie?Ie(L.x,L.y):"")!==P&&(W({x:-1,y:-1}),Z(""))}),[Ie]);var He=Object(n.useMemo)((function(){return S(we,je,50,d.x,pe)}),[e.freezeColumns,je,d.x,pe]),Te=Object(n.useMemo)((function(){return S(Ce,Se,22,d.y,Ee)}),[e.freezeRows,Se,d.y,Ee]),Le=function(t,a,n,l,o){if(void 0===o&&(o=!0),D.x1===t&&D.x2===n&&D.y1===a&&D.y2===l||k({x1:t,y1:a,x2:n,y2:l}),o){var i={x:d.x,y:d.y},u=-1,f=-1;if(-1!==n&&(!He.index.includes(n)||He.index[He.index.length-1]===n)){var m=He.index[He.index.length-1],v=He.index[we],x=0;n>=m?x=1+n-m:n<v&&(x=n-v);var g=Math.max(d.x,we)+x;i.x=g,u=30*g}if(-1!==l&&(!Te.index.includes(l)||Te.index[Te.index.length-1]===l)){var p=Te.index[Ce],b=Te.index[Te.index.length-1],E=0;l>=b?E=1+l-b:l<p&&(E=l-p);var w=Math.max(d.y,Ce)+E;i.y=w,f=30*w}if(i.x!==d.x||d.y!==i.y){h({x:i.x,y:i.y});var C=y({},c);C.x=Math.max(C.x,u),C.y=Math.max(C.y,f),s(C),setTimeout((function(){r.current&&(-1!==u&&(r.current.scrollLeft=u),-1!==f&&(r.current.scrollTop=f))}),0)}}if(e.onSelectionChanged){var j=t,S=a,M=n,N=l;j>M&&(j=n,M=t),S>N&&(S=l,N=a),e.onSelectionChanged(j,S,M,N)}},We=Object(n.useMemo)((function(){if(-1===D.x1&&-1===D.x2&&-1!==D.y1&&-1!==D.y2){var e=D.y2;D.y1>D.y2&&(e=D.y1);var t=A(0,e,Te,He,d,je,Se);return{x:t.x+3,y:t.y+Se(e)}}if(-1!==D.x1&&-1!==D.x2&&-1===D.y1&&-1===D.y2){var a=D.x2;D.x1>D.x2&&(a=D.x1);var n=A(a,0,Te,He,d,je,Se);return{x:n.x+je(a),y:n.y+3}}if(-1!==D.x2&&-1!==D.y2){var l=D.x2;D.x1>D.x2&&(l=D.x1);var r=D.y2;D.y1>D.y2&&(r=D.y1);var o=A(l,r,Te,He,d,je,Se);return{x:o.x+je(l),y:o.y+Se(r)}}return{x:-1,y:-1}}),[D,Te,He,d,je,Se]),Re=Object(n.useMemo)((function(){var e={},t=a.current;if(!t)return e;b(t);for(var n,l=22,r=50,o=v(He.index);!(n=o()).done;){var i=n.value,c=Me(i),s=je(i);if(c&&"object"===typeof c&&c.items)for(var u,d=void 0,h=v(c.items);!(u=h()).done;){var f=u.value;if(f.onClick){d||(d=M(Ne(i),g));for(var y=C(r,s,d,f.content instanceof HTMLImageElement?f.width||s:0,f.horiozntalAlign)+f.x,m=11+f.y,x=y+(f.width||0),p=m+(f.height||0),E={x:y,y:m,w:f.width,h:f.height,onClick:f.onClick},w=Math.floor(y/10),j=Math.floor(x/10),S=Math.floor(m/10),N=Math.floor(p/10),O=w;O<=j;O++){e[O]||(e[O]={});for(var A=e[O],D=S;D<=N;D++)A[D]||(A[D]=[]),A[D].push(E)}}}r+=s}for(var k,I=v(Te.index);!(k=I()).done;){var z=k.value;r=50;for(var H,T=v(He.index);!(H=T()).done;){var L=H.value,W=De(L,z),R=je(L);if(null!==W&&void 0!==W){var Y=r,B=l+.5*Se(z);if("object"===typeof W&&W.items)for(var F,P=void 0,Z=v(W.items);!(F=Z()).done;){var J=F.value;if(J.onClick){P||(P=M(ze(L,z),g));for(var X=C(Y,R,P,J.content instanceof HTMLImageElement?J.width||R:0,J.horiozntalAlign)+J.x,G=B+J.y,K=X+(J.width||0),Q=G+(J.height||0),U={x:X,y:G,w:J.width,h:J.height,onClick:J.onClick},V=Math.floor(X/10),q=Math.floor(K/10),_=Math.floor(G/10),$=Math.floor(Q/10),ee=V;ee<=q;ee++){e[ee]||(e[ee]={});for(var te=e[ee],ae=_;ae<=$;ae++)te[ae]||(te[ae]=[]),te[ae].push(U)}}}r+=R}else r+=R}l+=Se(z)}return e}),[De,e.cellWidth,e.cellHeight,a,He,Te,d.x,d.y]);Object(n.useEffect)((function(){var e=a.current;if(e){var t=e.getContext("2d");if(t){var n=window.requestAnimationFrame((function(){!function(e,t,a,n,l,r,o,i,c,s,u,d,h,f){b(e.canvas),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.fillRect(0,0,e.canvas.width,e.canvas.height);for(var m,x=22,E=v(t.index);!(m=E()).done;){for(var w,C=m.value,S=50,M=v(a.index);!(w=M()).done;){var O=w.value,D=n(O,C);D.fillColor&&(e.fillStyle=D.fillColor,e.fillRect(S,x,l(O),r(C))),S+=l(O)}x+=r(C)}var k=!1,I=o.x1,z=o.x2;o.x1>o.x2&&(I=o.x2,z=o.x1);var H=o.y1,T=o.y2;o.y1>o.y2&&(H=o.y2,T=o.y1);var L=-1!==I&&-1!==z||-1!==H&&-1!==T,W=-1===I&&-1===z&&-1!==H&&-1!==T,R=-1!==I&&-1!==z&&-1===H&&-1===T,Y=A(I,H,t,a,h,l,r),B=A(z,T,t,a,h,l,r);if(B.x+=l(z),B.y+=r(T),Y.x>=B.x){B.x=Y.x;for(var F=I;a.index.includes(F);)B.x+=l(F),F++;k=!0}if(Y.y>=B.y){B.y=Y.y;for(var P=H;t.index.includes(P);)B.y+=r(P),P++;k=!0}if(L){e.fillStyle="#e9f0fd";var Z=Math.max(-100,Y.x),J=Math.max(-100,Y.y);W?e.fillRect(Z,J,1e5,B.y-Y.y):R?e.fillRect(Z,J,B.x-Y.x,1e5):e.fillRect(Z,J,B.x-Y.x,B.y-Y.y)}e.fillStyle="#f8f9fa",e.fillRect(0,0,50,e.canvas.height),L&&(e.fillStyle="#e8eaed",e.fillRect(0,Y.y,50,B.y-Y.y)),e.fillStyle="#f8f9fa",e.fillRect(0,0,e.canvas.width,22),L&&(e.fillStyle="#e8eaed",e.fillRect(Y.x,0,B.x-Y.x,22)),e.strokeStyle="#e2e3e3",e.lineWidth=1;for(var X,G=50,K=v(a.index);!(X=K()).done;){var Q=X.value;e.beginPath(),e.moveTo(G,0),e.lineTo(G,e.canvas.height),e.stroke(),G+=l(Q)}for(var U,V=22,q=v(t.index);!(U=q()).done;){var _=U.value;e.beginPath(),e.moveTo(0,V),e.lineTo(e.canvas.width,V),e.stroke(),V+=r(_)}V=22,e.textBaseline="middle",e.textAlign="center",e.font=g.fontSize+"px "+g.fontFamily,e.fillStyle="#666666";for(var $,ee=v(t.index);!($=ee()).done;){var te=$.value,ae=te+1,ne={};W&&H<=te&&T>=te&&(ne=y({},ne,{backgroundColor:"#AAAAAA"})),j(e,""+ae,ne,p,0,V,50,r(te)),V+=r(te)}G=50,e.textBaseline="middle",e.textAlign="center";for(var le,re=v(a.index);!(le=re()).done;){var oe=le.value,ie=l(oe),ce=c(oe),se=null!==ce?ce:N(oe+1),ue=s(oe);R&&I<=oe&&z>=oe&&(ue=y({},ue,{backgroundColor:"#AAAAAA"})),j(e,se,ue,p,G,0,ie,22),G+=ie}if(L){e.strokeStyle="#1b73e7",e.lineWidth=1;var de=Math.max(-100,Y.x),he=Math.max(-100,Y.y);e.beginPath(),W?e.rect(de,he,1e5,B.y-Y.y):R?e.rect(de,he,B.x-Y.x,1e5):e.rect(de,he,B.x-Y.x,B.y-Y.y),e.stroke()}if(i){var fe=u.x1,ye=u.x2;u.x1>u.x2&&(fe=u.x2,ye=u.x1);var me=u.y1,ve=u.y2;u.y1>u.y2&&(me=u.y2,ve=u.y1);var xe=A(fe,me,t,a,h,l,r),ge=A(ye+1,ve+1,t,a,h,l,r);e.strokeStyle="#707070",e.setLineDash([3,3]),e.lineWidth=1,e.beginPath(),W?e.rect(xe.x,xe.y-1,1e5,ge.y-xe.y):R?e.rect(xe.x,xe.y-1,ge.x-xe.x,1e5):e.rect(xe.x,xe.y-1,ge.x-xe.x,ge.y-xe.y),e.stroke(),e.setLineDash([])}L&&!k&&(e.fillStyle="#1b73e7",e.fillRect(f.x-3,f.y-3,6,6)),e.textBaseline="middle";for(var pe,be=22,Ee=v(t.index);!(pe=Ee()).done;){for(var we,Ce=pe.value,je=50,Se=r(Ce),Me=v(a.index);!(we=Me()).done;){var Ne=we.value,Oe=d(Ne,Ce),Ae=l(Ne);if(null!==Oe&&void 0!==Oe)j(e,Oe,n(Ne,Ce),g,je,be,Ae,Se);je+=Ae}be+=Se}}(t,Te,He,ze,je,Se,D,q,Me,Ne,z,De,d,We)}));return function(){window.cancelAnimationFrame(n)}}}}),[a,Te,He,ze,je,Se,D,q,Me,Ne,z,De,d,We]);var Ye=function(){o.current&&(o.current.focus({preventScroll:!0}),o.current.select())};Object(n.useEffect)((function(){Qe||Ze()}),[D,ke]),Object(n.useEffect)((function(){if(!Qe)if(document.activeElement===o.current)Ye();else{var e=document.activeElement.tagName.toLowerCase();"div"===e&&"true"===document.activeElement.contentEditable||"input"===e||"textarea"===e||"select"===e||Ye()}}));var Be=function(e){if(o&&e.target===o.current){e.preventDefault();var t=e.clipboardData||window.clipboardData,a=t.types;if(a.includes("text/rtf")&&a.includes("text/plain")||a.includes("text/plain")&&!a.includes("text/html")){var n=t.getData("text/plain");Pe(n)}else if(a.includes("text/html")){var l=t.getData("text/html");Fe(l)}}};Object(n.useEffect)((function(){return window.document.addEventListener("paste",Be),function(){window.document.removeEventListener("paste",Be)}}));var Fe=function(t){var a=document.createElement("div");a.innerHTML=t.trim();var n=-1,l=-1;if(-1!==D.x1&&-1===D.x2&&(n=D.x1),-1!==D.y1&&-1===D.y2&&(l=D.y1),-1!==D.x1&&-1!==D.x2&&(n=Math.min(D.x1,D.x2)),-1!==D.y1&&-1!==D.y2&&(l=Math.min(D.y1,D.y2)),-1!==n&&-1!==l){var r=n,o=l,i=[],c=function e(t){for(var a,n=v(t.children);!(a=n()).done;){var l=a.value;if("TABLE"===l.nodeName)return l;var r=e(l);if(r)return r}}(a);if(c){for(var s,u=v(c.children);!(s=u()).done;){var d=s.value;if("TBODY"===d.nodeName)for(var h,f=v(d.children);!(h=f()).done;){var y=h.value;if(r=n,"TR"===y.nodeName){for(var m,x=v(y.children);!(m=x()).done;){var g=m.value;if("TD"===g.nodeName){var p="";if(0!==g.children.length&&"P"===g.children[0].nodeName){var b=g.children[0];p=0!==b.children.length&&"FONT"===b.children[0].nodeName?b.children[0].innerHTML:b.innerHTML}else p=g.innerHTML;p=(p=p.replaceAll("\n","")).replaceAll(/\s\s+/g," "),i.push({y:o,x:r,value:p}),r++}}o++}}}e.onChange&&e.onChange(i),Le(n,l,r-1,o-1,!1)}}},Pe=function(t){var a=-1,n=-1;if(-1!==D.x1&&-1===D.x2&&(a=D.x1),-1!==D.x1&&-1!==D.x2&&(a=Math.min(D.x1,D.x2)),-1===D.x1&&-1===D.x2&&-1!==D.y1&&-1!==D.y2&&(a=0),-1!==D.y1&&-1===D.y2&&(n=D.y1),-1!==D.y1&&-1!==D.y2&&(n=Math.min(D.y1,D.y2)),-1===D.y1&&-1===D.y2&&-1!==D.x2&&-1!==D.x2&&(n=0),-1!==a&&-1!==n){for(var l=t.split(/\r?\n/),r=a,o=n+l.length-1,i=[],c=0;c<l.length;c++){var s=l[c].split("\t");a+s.length-1>r&&(r=a+s.length-1);for(var u=0;u<s.length;u++)i.push({y:n+c,x:a+u,value:s[u]})}e.onChange&&e.onChange(i),Le(a,n,r,o,!1)}},Ze=function(){if(-1!==D.x1||-1!==D.y1||-1!==D.x2||-1!==D.y2){var e=D.y1,t=D.y2;e>t&&(e=D.y2,t=D.y1);var a=D.x1,n=D.x2;a>n&&(a=D.x2,n=D.x1);var l=function(e){for(var t=0,a=0,n=0,l=10,r=1.5;n<4;){for(var o=!0,i=0;i<10;i++){var c=e(t,i);if(null!==c&&void 0!==c&&""!==c){o=!1;break}}o&&(n+=1),t+=l,l=Math.floor(l*r)}for(n=0,l=10,r=1.5;n<4;){for(var s=!0,u=0;u<10;u++){var d=e(u,a);if(null!==d&&void 0!==d&&""!==d){s=!1;break}}s&&(n+=1),a+=l,l=Math.floor(l*r)}return{x:t,y:a}}(ke);-1===a&&-1===n&&(a=0,n=l.x),-1===e&&-1===t&&(e=0,t=l.y);for(var r="",i="",c=e;c<=t;c++){for(var s=!1,u=a;u<=n;u++){var d=ke(u,c);null!==d&&void 0!==d&&(i+=d,s=!0),u!==n&&(i+="\t")}c!==t&&(i+="\n"),s&&(r+=i,i="")}o.current&&(o.current.value=r)}},Je=function(t){e.onChange&&e.onChange([{x:L.x,y:L.y,value:void 0!==t?t:Y}]),W({x:-1,y:-1}),Z("")},Xe=function(e){if(!Oe(e.x,e.y)){var t=ke(e.x,e.y),a="";null!==t&&void 0!==t&&(a=t);var n=Ie?Ie(e.x,e.y):"";W(e),Z(n),B(a),U(!1)}},Ge=function(t){if(q){var a=D.x1,n=D.x2;D.x1>D.x2&&(a=D.x2,n=D.x1);var l=D.y1,r=D.y2;D.y1>D.y2&&(l=D.y2,r=D.y1);var o=z.x1,i=z.x2;z.x1>z.x2&&(o=z.x2,i=z.x1);var c=z.y1,s=z.y2;z.y1>z.y2&&(c=z.y2,s=z.y1);var u=o,d=c,h=i,f=s,y=[];if(h-u===n-a){d===l?d=r+1:f=l-1,-1===u&&-1===h&&(u=0,h=65536);for(var m=l,v=d;v<=f;v++){for(var x=u;x<=h;x++){var g=Ae(x,m);y.push({x:x,y:v,value:g})}(m+=1)>r&&(m=l)}}else{u===a?u=n+1:h=a-1,-1===d&&-1===f&&(d=0,f=65536);for(var p=a,b=u;b<=h;b++){for(var E=d;E<=f;E++){var w=Ae(p,E);y.push({x:b,y:E,value:w})}(p+=1)>n&&(p=a)}}e.onChange&&e.onChange(y),Le(z.x1,z.y1,z.x2,z.y2)}if(te(!1),ue(!1),fe(!1),_(!1),le(null),ie(null),-1!==me.x&&-1!==me.y&&null!==me.hitTarget){if(!t.target||!(t.target instanceof Element))return;var C=t.target.getBoundingClientRect(),j=t.clientX-C.left,S=t.clientY-C.top,M=me.hitTarget;M.x<=j&&j<=M.x+M.w&&M.y<=S&&S<=M.y+M.h&&M.onClick(t),ve({x:-1,y:-1,hitTarget:null})}};Object(n.useEffect)((function(){return window.addEventListener("mouseup",Ge),function(){window.removeEventListener("mouseup",Ge)}}));var Ke=function(t){if(t.target&&t.target instanceof Element){var a=t.target.getBoundingClientRect(),n=t.clientX-a.left,l=t.clientY-a.top;window.document.body.style.cursor="auto";var r=Math.floor(n/10),o=Math.floor(l/10);if(Re[r]&&Re[r][o])for(var i,c=v(Re[r][o]);!(i=c()).done;){var s=i.value;s.x<=n&&n<=s.x+s.w&&s.y<=l&&l<=s.y+s.h&&(window.document.body.style.cursor="pointer")}if(e.onCellWidthChange&&l<22)for(var u,d=50,h=v(He.index);!(u=h()).done;){var f=u.value;if(Math.abs(d-n)<4){window.document.body.style.cursor="col-resize";break}d+=je(f)}if(e.onCellHeightChange&&n<50)for(var y,m=22,x=v(Te.index);!(y=x()).done;){var g=y.value;if(Math.abs(m-l)<4){window.document.body.style.cursor="row-resize";break}m+=Se(g)}if(Math.abs(n-We.x)<6&&Math.abs(l-We.y)<6&&(window.document.body.style.cursor="crosshair"),ne){if(e.onCellWidthChange){var p=Math.max(ne.oldWidth+n-ne.startX,50);e.onCellWidthChange(ne.colIndices,p)}}else if(oe){if(e.onCellHeightChange){var b=Math.max(oe.oldHeight+l-oe.startY,22);e.onCellHeightChange(oe.rowIndices,b)}}else{if(ee){var E=O(n,l,Te,He);se?Le(-1,D.y1,-1,E.y,!1):he?Le(D.x1,-1,E.x,-1,!1):Le(D.x1,D.y1,E.x,E.y)}if(q){window.document.body.style.cursor="crosshair";var w=O(n,l,Te,He),C=D.x1,j=D.y1,S=D.x2,M=D.y2;C>S&&(C=D.x2,S=D.x1),j>M&&(j=D.y2,M=D.y1);var N=0;w.x<C&&(N=w.x-C),w.x>S&&(N=S-w.x);var A=0;w.y<j&&(A=w.y-j),w.y>M&&(A=M-w.y),-1===C&&-1===S||N>A?w.y<j?j=w.y:M=w.y:w.x<C?C=w.x:S=w.x,H({x1:C,y1:j,x2:S,y2:M})}}}},Qe=-1!==L.x&&-1!==L.y,Ue={x:0,y:0},Ve=0,qe=0,_e="right";if(Qe){Ue=A(L.x,L.y,Te,He,d,je,Se);var $e=ze(L.x,L.y);Ue.x+=1,Ue.y+=1,Ve=je(L.x)-2,qe=Se(L.y)-2,_e=$e.textAlign||g.textAlign||"left"}var et={value:Y,autoFocus:!0,onKeyDown:function(e){if("Escape"===e.key)return W({x:-1,y:-1}),void Z("");if("Enter"===e.key&&(Je(),Le(D.x1,D.y1+1,D.x1,D.y1+1)),"Tab"===e.key&&(e.preventDefault(),Je(),Le(D.x1+1,D.y1,D.x1+1,D.y1)),X&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e.key)){e.preventDefault(),Je();var t=D.x1,a=D.y1,n=D.x1,l=D.y1;"ArrowRight"===e.key?(t=D.x1+1,n=D.x1+1):"ArrowLeft"===e.key?(t=D.x1-1,n=D.x1-1):"ArrowUp"===e.key?(a=D.y1-1,l=D.y1-1):"ArrowDown"===e.key&&(a=D.y1+1,l=D.y1+1),Le(t,a,n,l)}},style:{position:"absolute",top:Ue.y,left:Ue.x,width:Ve,height:qe,outline:"none",border:"none",textAlign:_e,color:"black",fontSize:g.fontSize,fontFamily:"sans-serif"}},tt=null===(t=e.inputComponent)||void 0===t?void 0:t.call(e,L.x,L.y,y({},et,{onChange:B}),Je);return l.a.createElement("div",{style:{position:"relative",height:"100%"}},l.a.createElement("canvas",{style:{width:"calc(100% - 14px)",height:"calc(100% - 15px)",outline:"1px solid #ddd"},ref:a}),l.a.createElement("div",{ref:r,onDoubleClick:function(e){if(e.preventDefault(),e.target&&e.target instanceof Element&&!Q){var t=e.target.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top,l=Math.floor(a/10),r=Math.floor(n/10);if(Re[l]&&Re[l][r])for(var o,i=v(Re[l][r]);!(o=i()).done;){var c=o.value;if(c.x<=a&&a<=c.x+c.w&&c.y<=n&&n<=c.y+c.h)return}var s=O(a,n,Te,He);G(!1),Xe(s)}},onMouseDown:function(e){if(0===e.button&&e.target&&e.target instanceof Element){te(!1);var t=e.target.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top;if(!(a>pe||n>Ee)){var l=Math.floor(a/10),r=Math.floor(n/10);if(Re[l]&&Re[l][r])for(var o,i=v(Re[l][r]);!(o=i()).done;){var c=o.value;if(c.x<=a&&a<=c.x+c.w&&c.y<=n&&n<=c.y+c.h)return void ve({x:a,y:n,hitTarget:c})}if(n<22)for(var s=0;s<He.index.length;s++){var u=He.start[s],d=He.end[s],h=He.index[s];if(Math.abs(u-a)<4||Math.abs(d-a)<4){window.document.body.style.cursor="col-resize";var f=[];if(-1!==D.x1&&-1!==D.x2&&-1===D.y1&&-1===D.y2)for(var m=Math.min(D.x1,D.x2),x=Math.max(D.x1,D.x2),g=m;g<=x;g++)f.push(g);return 0===f.length&&f.push(h),void le({startX:d,oldWidth:je(h),colIndices:f})}}if(a<50)for(var p=0;p<Te.index.length;p++){var b=Te.start[p],E=Te.end[p],w=Te.index[p];if(Math.abs(b-n)<4||Math.abs(E-n)<4){window.document.body.style.cursor="row-resize";var C=[];if(-1===D.x1&&-1===D.x2&&-1!==D.y1&&-1!==D.y2)for(var j=Math.min(D.y1,D.y2),S=Math.max(D.y1,D.y2),M=j;M<=S;M++)C.push(M);return 0===C.length&&C.push(w),void ie({startY:E,oldHeight:Se(w),rowIndices:C})}}if(Math.abs(a-We.x)<6&&Math.abs(n-We.y)<6)return _(!0),void H({x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2});var N=O(a,n,Te,He),A=Q?{x:D.x1,y:D.y1}:y({},N);Qe&&Je();var k=!0;a<50?(k=!1,ue(!0),A.x=-1,N.x=-1):ue(!1),n<22?(k=!1,fe(!0),A.y=-1,N.y=-1):fe(!1),te(!0),Le(A.x,A.y,N.x,N.y,k),W({x:-1,y:-1}),Z("")}}},onMouseMove:Ke,onMouseLeave:function(){window.document.body.style.cursor="auto"},onContextMenu:function(t){var a;if(t.target&&t.target instanceof Element){var n=t.target.getBoundingClientRect(),l=t.clientX-n.left,r=t.clientY-n.top,o=O(l,r,Te,He),i=o.x,c=o.y,s=D.x1,u=D.x2,d=D.y1,h=D.y2;if(s>u){var f=[u,s];s=f[0],u=f[1]}if(d>h){var m=[h,d];d=m[0],h=m[1]}if(r>22&&l>50){i>=s&&i<=u&&c>=d&&c<=h||Le(i,c,i,c),Ke(t);var v=y({},t,{cellX:i,cellY:c});null===(a=e.onRightClick)||void 0===a||a.call(e,v)}}},onScroll:function(t){if(t.target&&t.target instanceof Element){var a=t.target.scrollLeft,n=t.target.scrollTop,l=Math.floor(a/30),r=Math.floor(n/30);l===d.x&&r===d.y||(h({x:l,y:r}),e.onScrollChange&&e.onScrollChange(l,r));var o=y({},c);c.x/(a+.5)<1&&(o.x*=1.5),c.y/(n+.5)<1&&(o.y*=1.5),o.x===c.x&&c.y===o.y||s(y({},o))}},className:x,style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",borderBottom:"1px solid #ddd"}},l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:c.y+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:c.x+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}})),l.a.createElement("textarea",{style:{position:"absolute",top:0,left:0,width:1,height:1,opacity:.01},ref:o,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onFocus:function(e){return e.target.select()},tabIndex:0,onKeyDown:function(t){if(Qe&&X&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key))Je();else if("Shift"!==t.key){if((!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())&&(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase()))if("Backspace"!==t.key&&"Delete"!==t.key){if(-1!==D.x1&&-1!==D.x2&&-1!==D.y1&&-1!==D.y2){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key)return Oe(D.x1,D.y1)?void t.preventDefault():(Xe({x:D.x1,y:D.y1}),void G("Enter"!==t.key));if(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key)){var a={x:D.x1,y:D.y1},n={x:D.x2,y:D.y2},l={x:0,y:0},r="right";if("ArrowRight"===t.key||"Tab"===t.key?(l.x=1,r="right"):"ArrowLeft"===t.key?(l.x=-1,r="left"):"ArrowUp"===t.key?(l.y=-1,r="up"):"ArrowDown"===t.key&&(l.y=1,r="down"),t.metaKey||t.ctrlKey){var o=function(e,t,a){var n=y({},t),l={x:0,y:0};"up"===a?l.y=-1:"down"===a?l.y=1:"left"===a?l.x=-1:"right"===a&&(l.x=1);var r=65536,o=65536;n.x>r&&(n.x=r),n.y>o&&(n.y=o);var i=e(n.x+l.x,n.y+l.y),c=""!==i&&null!==i&&void 0!==i;for(c||(n.x+=l.x,n.y+=l.y);n.x<=r&&n.y<=o&&n.x>=0&&n.y>=0;){var s=e(n.x,n.y);if(c&&(""===s||null===s||void 0===s))return{x:n.x-l.x,y:n.y-l.y};if(!c&&""!==s&&null!==s&&void 0!==s)return y({},n);n.x+=l.x,n.y+=l.y}return n}(De,n,r);l.x=o.x-n.x,l.y=o.y-n.y}return n.x+=l.x,n.y+=l.y,n.x<0&&(n.x=0),n.y<0&&(n.y=0),t.shiftKey||(a=y({},n)),void Le(a.x,a.y,n.x,n.y)}t.preventDefault()}}else{var i=D.x1,c=D.y1,s=D.x2,u=D.y2;i>s&&(i=D.x2,s=D.x1),c>u&&(c=D.y2,u=D.y1),-1===i&&-1===s&&-1!==c&&-1!==u&&(i=0,s=65536),-1!==i&&-1!==s&&-1===c&&-1===u&&(c=0,u=65536);for(var d=[],h=c;h<=u;h++)for(var f=i;f<=s;f++)d.push({x:f,y:h,value:null});e.onChange&&e.onChange(d)}}else U(!0)},onKeyUp:function(e){U(e.shiftKey)}}),Qe&&(void 0!==tt?tt:l.a.createElement("input",Object.assign({},et,{type:"text",onFocus:function(e){return e.target.select()},onChange:function(e){return B(e.target.value)}}))))};a(23);const k=[];for(let ue=0;ue<1e3;ue++){const e=[];for(let t=0;t<100;t++)e.push("Row: ".concat(ue,", Col: ").concat(t));k.push(e)}const I=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],z=[];for(let ue=0;ue<1e3;ue++){const e=[];for(let t=0;t<100;t++)e.push(1e6*Math.random());z.push(e)}const H=new Image;H.src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=",H.width=10,H.height=10;function T(e=[],t=[]){const a=Object(n.useState)(e),l=Object(u.a)(a,2),r=l[0],o=l[1],i=Object(n.useState)(t),c=Object(u.a)(i,2),s=c[0],d=c[1];return{onCellWidthChange:(e,t)=>{const a=[...r];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;if(e>a.length)for(let t=a.length;t<=e;t++)a.push(100);a[e]=t}}catch(i){l.e(i)}finally{l.f()}o(a)},onCellHeightChange:(e,t)=>{const a=[...s];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;if(e>a.length)for(let t=a.length;t<=e;t++)a.push(22);a[e]=t}}catch(r){l.e(r)}finally{l.f()}d(a)},cellWidth:r,cellHeight:s}}function L(){const e=Object(n.useState)(k),t=Object(u.a)(e,2),a=t[0],r=t[1],o=T(),i=o.onCellWidthChange,c=o.onCellHeightChange,s=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{onSelectionChanged:(e,t,a,n)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},cellWidth:s,cellHeight:d,onChange:e=>{const t=[...a];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:i,onCellHeightChange:c,freezeColumns:0,freezeRows:0}))}function W(){const e=Object(n.useState)(JSON.parse(JSON.stringify(I))),t=Object(u.a)(e,2),a=t[0],r=t[1],o=T(),i=o.onCellWidthChange,c=o.onCellHeightChange,s=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{onSelectionChanged:(e,t,a,n)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},cellWidth:s,cellHeight:d,onChange:e=>{const t=[...a];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:i,onCellHeightChange:c,freezeColumns:0,freezeRows:0}))}const R=new Image;function Y(){const e=Object(n.useState)(JSON.parse(JSON.stringify(I))),t=Object(u.a)(e,2),a=t[0],r=t[1],o=T(),i=o.onCellWidthChange,c=o.onCellHeightChange,s=o.cellWidth,d=o.cellHeight,f=["#f00","#0f0","#00f","#000"],y=["left","right","center"],m=["normal","bold","lighter"],v=[0,0,0,0,20];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{onSelectionChanged:(e,t,a,n)=>{},onRightClick:()=>{},columnHeaders:e=>0===e?{items:[{content:"A",x:0,y:0,horiozntalAlign:"center"},{content:H,x:0,y:-6,width:12,height:12,horiozntalAlign:"right",onClick:()=>{console.log("click")}}]}:null,cellStyle:(e,t)=>0===e||0===t?{fillColor:"#6DA2FB22",marginRight:10}:{color:f[t%4],textAlign:y[e%3],marginRight:v[e%5],weight:m[t%3]},editData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n,l;return 0===e&&t>0&&t<9?{items:[{content:R,x:0,y:-8,width:16,height:16,horiozntalAlign:"right",onClick:()=>{((e,t)=>{const n=[...a];n[t]&&void 0!==n[t][e]&&(n[t][e]+=1),r(n)})(e,t)}},{content:null===a||void 0===a||null===(l=a[t])||void 0===l?void 0:l[e],x:0,y:0,horiozntalAlign:"left"}]}:null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},cellWidth:s,cellHeight:d,onChange:e=>{const t=[...a];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:i,onCellHeightChange:c,freezeColumns:1,freezeRows:1}))}function B(){const e=Object(n.useState)(z),t=Object(u.a)(e,2),a=t[0],r=t[1],o=T(),i=o.onCellWidthChange,c=o.onCellHeightChange,s=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{cellStyle:(e,t)=>({}),editData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n,l,r;return null===a||void 0===a||null===(n=a[t])||void 0===n||null===(l=n[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)},sourceData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},cellWidth:s,cellHeight:d,onChange:e=>{const t=[...a];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=Number(e.value)}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:i,onCellHeightChange:c,freezeColumns:0,freezeRows:0}))}function F(){const e=Object(n.useState)("initial"),t=Object(u.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)([]),i=Object(u.a)(o,2),c=i[0],s=i[1],d=T(),f=d.onCellWidthChange,y=d.onCellHeightChange,m=d.cellWidth,v=d.cellHeight;return l.a.createElement(l.a.Fragment,null,"initial"===a?l.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r("loading"),fetch("./out.json").then(e=>e.json()).then(e=>{s(e),r("done")})}},"Load global database of power plants"):"loading"===a?"Loading...":null,l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{cellStyle:(e,t)=>0===t?{weight:"bold",fontSize:14}:4===e?{textAlign:"right"}:1===e?{weight:"bold",color:"#3b85ff"}:2===e?{color:"#fc3bff"}:{},editData:(e,t)=>{var a;return null===c||void 0===c||null===(a=c[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return 4===e&&t>0?c&&c[t]&&c[t][e]?Number(c[t][e]).toFixed(2):"":null===c||void 0===c||null===(a=c[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===c||void 0===c||null===(a=c[t])||void 0===a?void 0:a[e]},cellWidth:m,cellHeight:v,onChange:e=>{const t=[...c];var a,n=Object(h.a)(e);try{for(n.s();!(a=n.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(l){n.e(l)}finally{n.f()}s(t)},readOnly:(e,t)=>!1,onCellWidthChange:f,onCellHeightChange:y,columnHeaderStyle:e=>{const t=(2421*e%255).toString(16).padStart(2,"0"),a=(3215*e%255).toString(16).padStart(2,"0"),n=(1243*e%255).toString(16).padStart(2,"0");return{backgroundColor:"#".concat(t).concat(a).concat(n,"55")}},columnHeaders:e=>""+e,freezeColumns:0,freezeRows:1})))}R.src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==",R.width=16,R.height=16;const P=["First","Second","Third","Fourth","Fifth"],Z=["Sixth","Seventh","Eighth","Ninth","Tenth"],J=[P,Z,P,Z,P,Z,P];function X(){const e=Object(n.useState)(JSON.parse(JSON.stringify(J))),t=Object(u.a)(e,2),a=t[0],r=t[1],o=T(),i=o.onCellWidthChange,c=o.onCellHeightChange,s=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{onSelectionChanged:(e,t,a,n)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===a||void 0===a||null===(n=a[t])||void 0===n?void 0:n[e]},cellWidth:s,cellHeight:d,onChange:e=>{const t=[...a];var n,l=Object(h.a)(e);try{for(l.s();!(n=l.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:i,onCellHeightChange:c,freezeColumns:0,freezeRows:0,inputComponent:G}))}function G(e,t,a,n){return l.a.createElement("div",{style:Object(d.a)(Object(d.a)({},a.style),{},{backgroundColor:"#fff"})},l.a.createElement("div",{style:{border:"1px solid #ddd",boxShadow:"3px 5px 5px #ddd"}},(t%2?Z:P).map(e=>l.a.createElement(K,{key:e,opt:e,value:a.value,clickHandler:()=>{n(e)}}))))}function K({opt:e,value:t,clickHandler:a}){const r=Object(n.useState)(!1),o=Object(u.a)(r,2),i=o[0],c=o[1];return l.a.createElement("div",{onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},style:{backgroundColor:t===e||i?"#f6f6f6":"#fff",padding:"5px 10px",cursor:"pointer"},value:e,onClick:()=>a(e)},e)}function Q(){const e=Object(n.useState)([[1,2,3],[10,20,30]]),t=Object(u.a)(e,1)[0];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(D,{sourceData:t,displayData:(e,a)=>{var n,l,r;return null===t||void 0===t||null===(n=t[a])||void 0===n||null===(l=n[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)}}))}var U=a(13),V=a.n(U);var q=function(){const e=Object(n.useRef)(null),t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],o=a[1];return l.a.createElement("div",{className:"container blue-bg",id:"home"},l.a.createElement("div",{className:"content flex-row header"},l.a.createElement("div",{className:"box text-box"},l.a.createElement("div",null,l.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),l.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",l.a.createElement("br",null),"And it's super fast.")),l.a.createElement("div",{className:"lib-box"},l.a.createElement("div",{className:"install-box",onClick:t=>{e.current.select(),document.execCommand("copy"),t.target.focus(),o("Copied!"),setTimeout(()=>{o("")},1e3)}},l.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==r&&l.a.createElement("div",{className:"copy-success"},r)),l.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",rel:"noopener noreferrer",className:"git-box",target:"_blank"},l.a.createElement("img",{src:V.a,alt:"Git"}),"view on github"))),l.a.createElement("div",{className:"box"},l.a.createElement(L,null))))};var _=function({title:e,id:t}){return l.a.createElement("div",{className:"title-separator",id:t||""},l.a.createElement("p",null,e||"No title"),l.a.createElement("div",{className:"separator"}))};var $=function({children:e}){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"content flex-row"},e))},ee=a(235),te=a(234);te.a.hljs.padding="10px 20px",te.a.hljs.background="#f8f9fa",te.a.hljs.width="100%",te.a.hljs.maxWidth="100%",te.a.hljs.overflow="auto",te.a.hljs.borderRadius="3px",te.a.hljs.fontSize="14px";function ae(){let e=Object(d.a)({},te.a);return e.hljs.height="100%",l.a.createElement(ee.a,{language:"javascript",style:e},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);')}function ne(){return l.a.createElement(ee.a,{language:"javascript",style:te.a},"import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}")}function le(){return l.a.createElement(ee.a,{language:"javascript",style:te.a},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);')}function re(){return l.a.createElement(ee.a,{language:"javascript",style:te.a},'...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);')}function oe(){return l.a.createElement(ee.a,{language:"javascript",style:te.a},"...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);")}var ie=function(){return l.a.createElement("div",{className:"footer"},l.a.createElement("p",{className:"copy"},"made by ",l.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};function ce({text:e}){return l.a.createElement("span",{className:"emphased"},e)}var se=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s,null),l.a.createElement(q,null),l.a.createElement(_,{title:"Get started",id:"usage"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width colored-pre",style:{overflowX:"auto"}},l.a.createElement("p",null,"Import the component and its style, and render it"),l.a.createElement(ne,null),l.a.createElement("div",{className:"spacer"}),l.a.createElement("p",null,"Display some data"),l.a.createElement(le,null))),l.a.createElement(_,{title:"Learn more about features",id:"features"}),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement(W,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Basic spreadsheet"),l.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize columns and rows."))),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement(Y,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Styling"),l.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns, and add clickable images."))),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement(B,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Formatting"),l.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(_,{title:"Big dataset example",id:"big dataset example"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("p",null,"Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it will be handled blazingly fast and super responsive because component is canvas-based and it draws only the small chunk of data user sees at the moment."),l.a.createElement("br",null),l.a.createElement(F,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(_,{title:"Custom input fields",id:"custom input example"}),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement(X,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Custom input component"),l.a.createElement("p",null,"If basic text input isn't enough, you can send your own React component to be displayed instead."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(_,{title:"Documentation",id:"documentation"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Displaying data"),l.a.createElement("p",null,"If you have some data you want to display, you send it via ",l.a.createElement(ce,{text:"sourceData"})," and"," ",l.a.createElement(ce,{text:"displayData"})," props."),l.a.createElement("p",null,"The first one receives unformatted data which is used for data manipulation, and the second one formatted which is used for displaying in cells."),l.a.createElement("br",null),l.a.createElement("p",null,"Each of this can be either array of arrays of values (where each array is representing data for one row) or function (which returns value based on x and y coordinates that are sent as arguments to your function)."))),l.a.createElement($,null,l.a.createElement("div",{className:"box colored-pre unmargin-pre",style:{maxWidth:"100%",overflow:"auto"}},l.a.createElement(ae,null)),l.a.createElement("div",{className:"box"},l.a.createElement(Q,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Editing data"),l.a.createElement("p",null,"Same as the previous two, prop ",l.a.createElement(ce,{text:"editData"})," can recieve either array of arrays of values or function for data which will be displayed in edit mode. Edit mode is activated by double click on the cell."),l.a.createElement("br",null),l.a.createElement("p",null,"Once edit is done, function sent in ",l.a.createElement(ce,{text:"onChange"})," prop will be called with array of changes as an argument. Each element of this array has value, x and y coordinates. Use this information to change values in your data array."),l.a.createElement("br",null),l.a.createElement("p",null,"Sheet also accepts ",l.a.createElement(ce,{text:"readOnly"})," prop which you can use if some cells should not be editable. Same as the most of sheet's props, you can send function, array of arrays, or a single value which then is applied to the whole table.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(re,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Column headers"),l.a.createElement("p",null,"By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via"," ",l.a.createElement(ce,{text:"columnHeaders"})," prop as an array or function."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Cell style and width/height"),l.a.createElement("p",null,"Use prop ",l.a.createElement(ce,{text:"cellStyle"})," and ",l.a.createElement(ce,{text:"columnHeaderStyle"})," for customizing cells visually."),l.a.createElement("br",null),l.a.createElement("p",null,"You can also use ",l.a.createElement(ce,{text:"cellWidth"})," and ",l.a.createElement(ce,{text:"cellHeight"})," props to customize cell size. If you send single value ","cellWidth={200}",", it will be applayed to all cells. If you send array of values ","cellWidth={[200, 80, 80]}",", they will be applied in respect to the index number."),l.a.createElement("br",null),l.a.createElement("p",null,"There are also ",l.a.createElement(ce,{text:"onCellWidthChange"})," and ",l.a.createElement(ce,{text:"onCellHeightChange"})," ","props for functions which are called when user drags cell for resize. You can use these for updating your cellWidth/cellHeight arrays.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(oe,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Selection"),l.a.createElement("p",null,"You can send function to ",l.a.createElement(ce,{text:"onSelectionChanged"})," prop. It will be called on selection change with x1, y1, x2 and y2 arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Right click handler"),l.a.createElement("p",null,"If you send a function to ",l.a.createElement(ce,{text:"onRightClick"})," prop, it will be called on right click with whole mouse event (extended with cellX and cellY values) as an argument."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Sticky columns/rows"),l.a.createElement("p",null,"Send a number to ",l.a.createElement(ce,{text:"freezeColumns"})," and/or ",l.a.createElement(ce,{text:"freezeRows"})," to make first n of columns/rows sticky."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement($,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Custom input"),l.a.createElement("p",null,"By default edit mode turns cell into text edit component. But you can send your custom input component via ",l.a.createElement(ce,{text:"inputComponent"})," props. It will be called with"," ",l.a.createElement(ce,{text:"x"}),", ",l.a.createElement(ce,{text:"y"}),", ",l.a.createElement(ce,{text:"inputProps"})," and"," ",l.a.createElement(ce,{text:"commitEditingCell"})," arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ie,null));o.a.render(l.a.createElement(se,null),document.getElementById("root"))},6:function(e,t,a){}},[[18,1,2]]]);
//# sourceMappingURL=main.2145c7e6.chunk.js.map