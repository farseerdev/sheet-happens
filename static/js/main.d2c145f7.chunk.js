(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{10:function(e,t,n){},15:function(e,t,n){e.exports=n.p+"static/media/logo.aef13910.svg"},17:function(e,t,n){e.exports=n.p+"static/media/git.f818b886.svg"},22:function(e,t,n){e.exports=n(247)},247:function(e,t,n){"use strict";n.r(t);n(10);var a=n(0),l=n.n(a),r=n(14),o=n.n(r),i=n(15),c=n.n(i);var u=function(){var e=function(e){var t=document.getElementById(e),n="home"===e?0:86,a=window.pageYOffset+t.getBoundingClientRect().top-n;window.scrollTo({top:a,behavior:"smooth"})};return l.a.createElement("div",{className:"container blue-bg menu"},l.a.createElement("div",{className:"content flex-row"},l.a.createElement("div",{className:"logo-box"},l.a.createElement("img",{src:c.a,alt:"Logo"}),l.a.createElement("h2",{className:"page-title"},"sheet - happens")),l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"nav-item",onClick:function(){return e("home")}},"home"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("usage")}},"usage"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("features")}},"features"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("documentation")}},"documentation"))))},s=n(1),d=n(7),f=n(3),v=n(2),h=n(16);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}for(var p="_PxIi8",b=[2e3,1e3],C=[0,0],x=[1,1],w=[-1,-1],E=[w,w],O=[],j=[],S={},M=[65536,65536],N="#1a66ff",D="#d8e6ff80",k="#0000001f",T="#1a66ff30",I="#1a66ff",A="#707070",H="#f6f9fc",R="#666666",z="#e8f0ff",L="#000000",W=6,P=50,B=22,Y=50,F=22,G=4,K=12,Z=.05,J={textAlign:"left",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},X={textAlign:"center",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},Q={color:"#1a66ff"},V={backgroundColor:"#1a66ff",color:"#ffffff"},U={ArrowRight:"right",ArrowLeft:"left",ArrowUp:"up",ArrowDown:"down"},q=function(e,t,n){return Math.max(Math.min(n,e),t)},$=function(e,t,n){return t<=e&&e<=n},_=function(e,t,n){return t<=e&&e<n},ee=function(e,t,n){return t<e&&e<n},te=function(e,t){return[e[0]+t[0],e[1]+t[1]]},ne=function(e,t){return[e[0]-t[0],e[1]-t[1]]},ae=function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]},le=function(e){return"left"===e?[-1,0]:"right"===e?[1,0]:"up"===e?[0,-1]:"down"===e?[0,1]:[0,0]},re=function(e,t){return e[0]===t[0]&&e[1]===t[1]},oe=function(e){var t=e[0][0],n=e[1][0];return-1===t&&-1===n},ie=function(e){var t=e[0][1],n=e[1][1];return-1===t&&-1===n},ce=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===n&&-1===r&&-1!==a&&-1!==o},ue=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===a&&-1===o&&-1!==n&&-1!==r},se=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===n&&-1===r&&-1===a&&-1===o},de=function(e,t){var n=fe(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1],u=t[0],s=t[1];return u>=l&&u<=i&&s>=r&&s<=c},fe=function(e){var t=e[0],n=e[1],a=t[0],l=t[1],r=n[0],o=n[1],i=Math.min(a,r),c=Math.max(a,r);return[[i,Math.min(l,o)],[c,Math.max(l,o)]]},ve=function(e,t){var n=e[0],a=n[0],l=n[1],r=e[1],o=r[0],i=r[1],c=t[0],u=t[1],s=c[0],d=c[1],f=(s-u[0]||1)*(a-o||1)<0,v=(d-u[1]||1)*(l-i||1)<0;return[[f?o:a,v?i:l],[f?a:o,v?l:i]]},he=function(e,t,n,a){if(null==a)return t;for(var l=0,r=n>0?1e3:Math.min(1e3,t+1);l<r&&e(t+l*n)===a;l++);return t+(l-1)*n},me=function(e,t){var n=t(e-1),a=t(e);return null!=n&&null!=a&&n===a},ge=function(e,t){return Array.isArray(e)?function(n){return n>=0&&n<e.length?e[n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},ye=function(e,t){return Array.isArray(e)?function(n,a){return a>=0&&a<e.length&&n>=0&&n<e[a].length?e[a][n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},pe=function(e){for(var t=0,n=0,a=0,l=10,r=1.5;a<4;){for(var o=!0,i=0;i<10;i++){var c=e(t,i);if(null!==c&&void 0!==c&&""!==c){o=!1;break}}if(o&&(a+=1),(t+=l)>65536)break;l=Math.floor(l*r)}for(a=0,l=10,r=1.5;a<4;){for(var u=!0,s=0;s<10;s++){var d=e(s,n);if(null!==d&&void 0!==d&&""!==d){u=!1;break}}if(u&&(a+=1),(n+=l)>65536)break;l=Math.floor(l*r)}return[t,n]},be=function(e,t,n){var a,l,r,o=le(n),i=(l=C,void 0===(r=M)&&(r=[1/0,1/0]),[q((a=t)[0],l[0],r[0]),q(a[1],l[1],r[1])]),c=e.apply(void 0,te(i,o)),u=""!==c&&null!==c&&void 0!==c;u||(i=te(i,o));for(var s=i,d=s[0],f=s[1];d<=65536&&f<=65536&&d>=0&&f>=0;){var v=e(d,f);if(u&&(""===v||null===v||void 0===v))return ne(i,o);if(!u&&""!==v&&null!==v&&void 0!==v)return i;var h=i=te(i,o);d=h[0],f=h[1]}return ae(i,[0,0])},Ce=function(e,t,n,a,l){var r=fe(e),o=r[0],i=o[0],c=o[1],u=r[1],s=u[0],d=u[1],f=fe(t),v=f[0],h=v[0],m=v[1],g=f[1],y=g[0],p=g[1],b=i,C=c,x=s,w=d,E=[];if(x-b===y-h){if(C===m?C=p+1:w=m-1,-1===b&&-1===x)b=0,x=pe(a)[0];for(var O=m,j=C;j<=w;j++){for(var S=b;S<=x;S++){var M=n(S,O);l(S,j)||E.push({x:S,y:j,value:M,source:{x:S,y:O}})}(O+=1)>p&&(O=m)}}else{if(b===h?b=y+1:x=h-1,-1===C&&-1===w)C=0,w=pe(a)[1];for(var N=h,D=b;D<=x;D++){for(var k=C;k<=w;k++){var T=n(N,k);l(D,k)||E.push({x:D,y:k,value:T,source:{x:N,y:k}})}(N+=1)>y&&(N=h)}}return E},xe=function(e,t){if(se(e))return"";var n=fe(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1];oe(e)&&(l=0,i=pe(t)[0]);ie(e)&&(r=0,c=pe(t)[1]);for(var u=[],s=r;s<=c;s++){for(var d=[],f=l;f<=i;f++){var v=t(f,s);null!==v&&void 0!==v&&d.push(null!=v?v:"")}u.push(d)}return function(e){return e.map((function(e){return e.join("\t")})).join("\n")}(u)},we=function(e,t,n){var a=document.createElement("div");a.innerHTML=t.trim();var l=fe(e)[0],r=l[0],o=l[1],i=oe(e)?0:r,c=ie(e)?0:o,u=[],s=function e(t){for(var n,a=y(t.children);!(n=a()).done;){var l=n.value;if("TABLE"===l.nodeName)return l;var r=e(l);if(r)return r}}(a);if(!s)return null;for(var d,f=i,v=c,h=y(s.children);!(d=h()).done;){var m=d.value;if("TBODY"===m.nodeName)for(var g,p=y(m.children);!(g=p()).done;){var b=g.value,C=i;if("TR"===b.nodeName){for(var x,w=y(b.children);!(x=w()).done;){var E=x.value;if("TD"===E.nodeName){var O="";if(0!==E.children.length&&"P"===E.children[0].nodeName){var j=E.children[0];O=0!==j.children.length&&"FONT"===j.children[0].nodeName?j.children[0].textContent.trim():j.textContent.trim()}else O=E.textContent.trim();O=(O=O.replaceAll("\n","")).replaceAll(/\s\s+/g," "),null!==n&&void 0!==n&&n(C,v)||u.push({x:C,y:v,value:O}),C++}}v++}f=Math.max(f,C-1)}}return{selection:[[i,c],[f,Math.max(c,v-1)]],changes:u}},Ee=function(e,t,n){for(var a=fe(e)[0],l=a[0],r=a[1],o=oe(e)?0:l,i=ie(e)?0:r,c=t.split(/\r?\n/),u=o,s=i+c.length-1,d=[],f=0;f<c.length;f++){var v=c[f].split("\t");u=Math.max(u,o+v.length-1);for(var h=0;h<v.length;h++){var m=o+h,g=i+f;null!==n&&void 0!==n&&n(m,g)||d.push({x:m,y:g,value:v[h]})}}return{selection:[[o,i],[u,s]],changes:d}},Oe=function(e,t,n,a,l){var r=e[0],o=e[1],i=t[0],c=t[1],u=n[0],s=n[1],d=function(e,t,n){return e<t?0:n+t},f=function(e,t){void 0===t&&(t=0);var n=d(e,r,u),l=a.getStart(e)-a.getStart(n),o=e<r?0:a.getStart(r)-a.getStart(0),c=e<0?i:a.getSize(e);return e<0?0:i+l+o+t*c},v=function(e,t){void 0===t&&(t=0);var n=d(e,o,s),a=l.getStart(e)-l.getStart(n),r=e<o?0:l.getStart(o)-l.getStart(0),i=e<0?c:l.getSize(e);return e<0?0:c+a+r+t*i},h=function(e,t){return void 0===t&&(t=0),a.getStart(e)+t*(e<0?0:a.getSize(e))},m=function(e,t){return void 0===t&&(t=0),l.getStart(e)+t*(e<0?0:l.getSize(e))},g=function(e,t,n,a,l,r){var o=e-n;if(o<0)return-1;var i=r.getStart,c=r.lookupIndex;return c(o<i(a)?o:i(l+a)+o-(i(a)-i(0)),t)},y=function(e,t){return void 0===t&&(t=0),g(e,t,i,r,u,a)},p=function(e,t){return void 0===t&&(t=0),g(e,t,c,o,s,l)},b=function(e,t,n){return e<0?-1:(0,n.lookupIndex)(e,t)},x=function(e,t){return void 0===t&&(t=0),b(e,t,a)},w=function(e,t){return void 0===t&&(t=0),b(e,t,l)},E=function(e,t,n,a,l){for(var r,o,i,c=[].concat((r=n,void 0===o&&(o=0),void 0===i&&(i=1),Array.from({length:r}).map((function(e,t){return o+i*t})))),u=l.getStart,s=e-t+u(a),d=a+n;u(d)<=s;++d)c.push(d);return c};return{columnToPixel:f,rowToPixel:v,cellToPixel:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[f(n,r),v(a,o)]},columnToAbsolute:h,rowToAbsolute:m,cellToAbsolute:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[h(n,r),m(a,o)]},pixelToColumn:y,pixelToRow:p,pixelToCell:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[y(n,r),p(a,o)]},absoluteToColumn:x,absoluteToRow:w,absoluteToCell:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[x(n,r),w(a,o)]},getVisibleCells:function(e){var t=e[0],n=e[1];return{columns:E(t,i,r,u,a),rows:E(n,c,o,s,l)}},getIndentX:function(){return i},getIndentY:function(){return c},getVersion:function(){return a.getVersion()+l.getVersion()}}},je=function(e){var t=Se(256),n=Se(256),a=0;t.set(0,0);var l=function(t){if(t<0)return 0;if(n.has(t))return n.get(t);var a=e(t)||0;return n.set(t,a),a},r=function(e){if(e<0)return 0;if(t.has(e))return t.get(e);for(var n=t.tail()||0;n<e;){var a=l(n),r=(t.get(n)||0)+a;t.set(++n,r)}return t.get(e)};return{getSize:l,getStart:function(e){return r(e)},getEnd:function(e){return r(e+1)},getVersion:function(){return a},lookupIndex:function(e,n){void 0===n&&(n=0);for(var a=t.tail()||0;r(a)<e&&l(a);)a+=64;for(var o=0,i=a;o<i;){var c=o+Math.floor((i-o)/2)+1;r(c)-(n?n*l(c-1):0)<=e?o=c:i=c-1}return o},setSizer:function(t){e=t},clearAfter:function(e){e=Math.max(0,e),t.truncate(e),n.truncate(e),a++}}},Se=function(e){var t,n;void 0===e&&(e=128);var a=0,l=function(e){var a=new Uint8Array(e),l=new Uint32Array(e);t&&r(t,a),n&&r(n,l),t=a,n=l};l(e);var r=function(e,t){for(var n=Math.min(e.length,t.length),a=0;a<n;++a)t[a]=e[a]};return{truncate:function(e){var r=n.length;if(!(r<e)){if(r>Math.round(1.2*e))l(e);else for(var o=e;o<r;++o)t[o]=0;for(a=Math.min(a,e);a>0&&!t[a];)a--}},set:function(e,r){!function(e){var t=n.length,a=Math.round(1.2*t);t<e&&l(Math.max(a,e))}(e+1),n[e]=r,t[e]=1,a=Math.max(a,e)},get:function(e){return t[e]?n[e]:null},has:function(e){return!!t[e]},tail:function(){return t[a]?a:null}}},Me=function(e,t,n,a,l){return void 0===l&&(l=n.textAlign),"left"===l?e+n.marginLeft:"center"===l?e+.5*t-a/2:"right"===l?e+(t-n.marginRight-a):e},Ne=function(e,t,n,a,l,r,o,i){var c=[];if(null===t)return c;var u=m({},a,n);e.fillStyle=u.color,e.font=u.weight+" "+u.fontSize+"px "+u.fontFamily,e.textAlign=u.textAlign;var s=Math.floor(r+.5*i);if(e.save(),e.beginPath(),e.rect(l,r,o,i),e.clip(),""!==u.backgroundColor&&(e.fillStyle=u.backgroundColor,e.fillRect(l,r,o,i),e.fillStyle=u.color),"string"===typeof t||"number"===typeof t){var d=Me(l,o,u,0),f=""+t;e.fillText(f,d,s)}else if("object"===typeof t)for(var v,h=y(t.items);!(v=h()).done;){var g=v.value,p=0,b=0,C=0,x=0;if(g.content instanceof HTMLImageElement)C=g.width||o,x=g.height||i,p=Me(l,o,u,C,g.horizontalAlign)+g.x,b=s+g.y,e.drawImage(g.content,p,b,C,x);else if("string"===typeof g.content||"number"===typeof g.content){g.horizontalAlign&&(e.textAlign=g.horizontalAlign);var w=Me(l,o,u,0,g.horizontalAlign),E=""+g.content,O=w+g.x,j=s+g.y;e.fillText(E,O,j);var S=e.measureText(E);p=O-S.actualBoundingBoxLeft,b=j-S.actualBoundingBoxAscent,C=O+S.actualBoundingBoxRight-p,x=j+S.actualBoundingBoxDescent-b}g.onClick&&c.push({rect:[[p,b],[p+C,b+x]],obj:g})}return e.restore(),c},De=function(e,t){var n=t.cellToPixel,a=ce(e),l=ue(e),r=fe(e),o=r[0],i=r[1],c=n(o),u=c[0],s=c[1],d=n(i,x),f=d[0],v=d[1];return a&&(f=1e5),l&&(v=1e5),[[u,s],[f,v]]},ke=function(e,t,n,a,l){var r=t.cellToPixel,o=t.columnToAbsolute,i=t.rowToAbsolute,c=ce(e),u=ue(e),s=n[0],d=n[1],f=a[0],v=a[1],h=l[0],m=l[1],g=fe(e),y=g[0],p=g[1],b=y[0],C=y[1],w=p[0],E=p[1],O=r(y),j=O[0],S=O[1],M=r(p,x),N=M[0],D=M[1],k=o(s),T=i(d),I=!1;if(ee(s,b,w+1)){var A=f+k;N<=A&&(N=A,I=!0)}if(ee(d,C,E+1)){var H=v+T;D<=H&&(D=H,I=!0)}if(_(b,s,h+s)){j=-1e5;var R=h+s-1;w<=R&&(N=w===R?f:-1e5,I=!0)}if(_(C,d,m+d)){S=-1e5;var z=m+d-1;E<=z&&(D=E===z?v:-1e5,I=!0)}return c&&h>0&&(I=!0),u&&m>0&&(I=!0),c&&(N=1e5),u&&(D=1e5),[[[j,S],[N,D]],I]},Te=function(e){var t=e.getBoundingClientRect(),n=t.width,a=t.height,l=window.devicePixelRatio,r=void 0===l?1:l;r<1&&(r=1);var o=Math.round(n*r),i=Math.round(a*r);if(e.width!==o||e.height!==i){var c=e.getContext("2d");return c&&(e.width=o,e.height=i,c.scale(r,r)),!0}return!1},Ie=function(e){for(var t="",n=0;e>0;)n=(e-1)%26,t=String.fromCharCode(65+n)+t,e=(e-n)/26|0;return t||""},Ae=function(e,t,n){for(var a,l=function(e){return("0"+Math.round(e).toString(16)).slice(-2)},r=function(e){return 1-Math.pow(1-e,2.2)},o=0;o<=16;++o){var i=o/16;e.addColorStop(i,t+l(255*r(n*(a=i,1-Math.sin(a*Math.PI/2))*.5)))}},He=Object(a.forwardRef)((function(e,t){var n,r,o,i,c=Object(a.useRef)(null),u=Object(a.useRef)(null),s=Object(a.useState)(b),d=s[0],f=s[1],v=Object(a.useState)(C),g=v[0],M=v[1],q=null!=(n=e.selection)?n:E,_=Object(a.useState)(q),ee=_[0],ie=_[1],pe=Object(a.useState)(null),Se=pe[0],Me=pe[1],He=Object(a.useState)(null),Re=He[0],ze=He[1],Le=Object(a.useState)(null),We=Le[0],Pe=Le[1],Be=Object(a.useState)(w),Ye=Be[0],Fe=Be[1],Ge=Object(a.useState)(q),Ke=Ge[0],Ze=Ge[1];Ke!==q&&(Ze(q),ie(q));var Je=Object(a.useState)(""),Xe=Je[0],Qe=Je[1],Ve=Object(a.useState)(!1),Ue=Ve[0],qe=Ve[1],$e=Object(h.a)({ref:c}),_e=$e.width,et=void 0===_e?3e3:_e,tt=$e.height,nt=void 0===tt?3e3:tt,at=Object(a.useMemo)((function(){return ge(e.cellWidth,100)}),[e.cellWidth]),lt=Object(a.useMemo)((function(){return ge(e.cellHeight,22)}),[e.cellHeight]),rt=Object(a.useMemo)((function(){return ge(e.columnHeaders,null)}),[e.columnHeaders]),ot=Object(a.useMemo)((function(){return ge(e.columnHeaderStyle,{})}),[e.columnHeaderStyle]),it=Object(a.useMemo)((function(){return ge(e.canSizeColumn,!0)}),[e.canSizeColumn]),ct=Object(a.useMemo)((function(){return ge(e.canSizeRow,!0)}),[e.canSizeRow]),ut=Object(a.useMemo)((function(){return ge(e.canOrderColumn,!0)}),[e.canOrderColumn]),st=Object(a.useMemo)((function(){return ge(e.canOrderRow,!0)}),[e.canOrderRow]),dt=Object(a.useMemo)((function(){return ge(e.rowGroupKeys,null)}),[e.rowGroupKeys]),ft=Object(a.useMemo)((function(){return ge(e.columnGroupKeys,null)}),[e.columnGroupKeys]),vt=Object(a.useMemo)((function(){return ye(e.readOnly,!1)}),[e.readOnly]),ht=Object(a.useMemo)((function(){return ye(e.sourceData,null)}),[e.sourceData]),mt=Object(a.useMemo)((function(){return ye(e.displayData,"")}),[e.displayData]),gt=Object(a.useMemo)((function(){return ye(e.editData,"")}),[e.editData]),yt=Object(a.useMemo)((function(){return ye(e.editKeys,"")}),[e.editKeys]),pt=Object(a.useMemo)((function(){return ye(e.cellStyle,J)}),[e.cellStyle]),bt=Object(a.useMemo)((function(){return function(e){var t,n,a;return{freezeColumns:(null===e||void 0===e?void 0:e.freezeColumns)||0,freezeRows:(null===e||void 0===e?void 0:e.freezeRows)||0,hideColumnHeaders:(null===e||void 0===e?void 0:e.hideColumnHeaders)||!1,hideRowHeaders:(null===e||void 0===e?void 0:e.hideRowHeaders)||!1,hideGridlines:(null===e||void 0===e?void 0:e.hideGridlines)||!1,hideScrollBars:(null===e||void 0===e?void 0:e.hideScrollBars)||!1,columnHeaderHeight:null!==e&&void 0!==e&&e.hideColumnHeaders?1:B,rowHeaderWidth:null!==e&&void 0!==e&&e.hideRowHeaders?1:P,shadowBlur:null!=(t=null===e||void 0===e?void 0:e.shadowBlur)?t:K,shadowOpacity:null!=(n=null===e||void 0===e?void 0:e.shadowOpacity)?n:Z,shadowColor:null!=(a=null===e||void 0===e?void 0:e.shadowColor)?a:L}}(e.sheetStyle)}),[e.sheetStyle]),Ct=null!=(r=e.secondarySelections)?r:O,xt=d[0],wt=d[1],Et=Ye[0],Ot=Ye[1],jt=-1!==Et&&-1!==Ot,St=!1!==(null!=(o=e.cacheLayout)&&o),Mt="number"===typeof e.cacheLayout?e.cacheLayout:0,Nt=Object(a.useMemo)((function(){return je(at)}),[St?Mt:at]),Dt=Object(a.useMemo)((function(){return je(lt)}),[St?Mt:lt]);Object(a.useMemo)((function(){St&&(Nt.setSizer(at),Dt.setSizer(lt))}),[St,Mt,at,lt]);var kt=bt.freezeColumns,Tt=bt.freezeRows,It=bt.rowHeaderWidth,At=bt.columnHeaderHeight,Ht=Object(a.useMemo)((function(){return Oe([kt,Tt],[It,At],g,Nt,Dt)}),[kt,Tt,It,At,g,Nt,Dt]),Rt=Ht.getVisibleCells,zt=Ht.cellToPixel,Lt=Ht.getVersion,Wt=Object(a.useMemo)((function(){return Rt([et,nt])}),[Rt,et,nt,Lt()]);Object(a.useLayoutEffect)((function(){e.onScrollChange&&e.onScrollChange([].concat(Wt.rows),[].concat(Wt.columns))}),[Wt,e.onScrollChange]);var Pt=function(t,n,a,l){void 0===n&&(n=!0),void 0===a&&(a=!1),void 0===l&&(l=!1),l||(ue(t)&&ft&&(t=function(e,t){var n=fe(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1],u=t(l),s=t(i),d=he(t,l,-1,u),f=he(t,i,1,s);return ve([[d,r],[f,c]],e)}(t,ft)),ce(t)&&dt&&(t=function(e,t){var n=fe(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1],u=t(r),s=t(c),d=he(t,r,-1,u),f=he(t,c,1,s);return ve([[l,d],[i,f]],e)}(t,dt))),function(e,t){var n=e[0],a=e[1],l=t[0],r=t[1];return re(n,l)&&re(a,r)}(ee,t)||ie(t);var r=u.current;if(r){if(n){var o=t,i=o[0],c=o[1];!function(e,t,n,a,l,r,o,i){var c=t[0],u=t[1],s=n[0],d=n[1],f=l[0],v=l[1],h=o.cellToAbsolute,m=o.cellToPixel,g=o.columnToPixel,y=o.rowToPixel,p=h(a),b=p[0],C=p[1],w=m(t),E=w[0],O=w[1],j=m(t,x),S=j[0],M=j[1],N=l[0],D=l[1];if(E<=b&&(N=c-a[0]),O<=C&&(D=u-a[1]),S>s)for(var k=S-s+g(N);g(++N)<k;);if(M>d)for(var T=M-d+y(D);y(++D)<T;);var I=[N>=0?N:f,D>=0?D:v];if(!re(I,l)){var A=h(I),H=h([0,0],[.5,.5]),R=H[0],z=H[1];i(I,ae(r,A)),setTimeout((function(){var t=A[0],n=A[1];e.scrollLeft=t-R,e.scrollTop=n-z}))}}(r,a?c:i,[et,nt],[kt,Tt],g,d,Ht,(function(e,t){M(e),f(t)}))}if(e.onSelectionChanged){var s=fe(t),v=s[0],h=v[0],m=v[1],y=s[1],p=y[0],b=y[1];e.onSelectionChanged(h,m,p,b)}}},Bt=function(t){if(e.onChange){var n=Ye[0],a=Ye[1];e.onChange([{x:n,y:a,value:void 0!==t?t:Xe}])}Fe(w)},Yt=function(e,t){void 0===t&&(t=!1);var n=e[0],a=e[1];if(!vt(n,a)){var l=gt(n,a),r="";null!==l&&void 0!==l&&(r=l),Fe(e),Qe(r),qe(t),Ut(yt.apply(void 0,e))}},Ft=Object(a.useRef)(j),Gt=Object(a.useRef)(null);!function(e,t,n,l){Object(a.useLayoutEffect)((function(){var a=e.current;if(a&&!n&&!se(t)){var r=xe(t,l);r.match(/^[\t\n]*$/)&&(r=" "+r),a.value=r}}),[t,n,l,e]),Object(a.useLayoutEffect)((function(){var t=e.current;if(t){if(!n&&document.activeElement!==t){var a=document.activeElement.tagName.toLowerCase();"div"===a&&"true"===document.activeElement.contentEditable||"input"===a||"textarea"===a||"select"===a||(t.focus({preventScroll:!0}),t.select())}}}))}(Gt,ee,jt,gt),function(e,t,n,l,r){Object(a.useEffect)((function(){var a=function(a){var o=e.current;if(o&&a.target===o){a.preventDefault();var i,c=a.clipboardData||window.clipboardData,u=c.types;if(u.includes("text/html")){var s=c.getData("text/html");i=we(t,s,r)}else if(u.includes("text/plain")){var d=c.getData("text/plain");i=Ee(t,d,r)}if(i){var f=i,v=f.selection,h=f.changes;null===l||void 0===l||l(h),null===n||void 0===n||n(v)}}};return window.document.addEventListener("paste",a),function(){window.document.removeEventListener("paste",a)}}),[e,t])}(Gt,ee,Pt,e.onChange,vt);var Kt=function(e,t,n,l,r){return Object(a.useCallback)((function(a){if(a.target&&a.target instanceof Element){var o=n.absoluteToCell,i=(0,n.cellToAbsolute)([0,0],[.5,.5]),c=i[0],u=i[1],s=[a.target.scrollLeft+c,a.target.scrollTop+u],d=o(s);re(d,e)||null===l||void 0===l||l(d);var f,v,h=s[0],m=s[1],g=t[0]<h+1?1.5:1,y=t[1]<m+1?1.5:1;(g>1||y>1)&&(null===r||void 0===r||r((v=[g,y],[(f=t)[0]*v[0],f[1]*v[1]])))}}),[n,l,r])}(g,d,Ht,M,f),Zt=function(e,t,n,l,r,o,i,c,u,s,d,f,v,h,g,p,b,w,E,O,j,S,M,N,D,k,T,I,A,H,R){var z=Object(a.useState)(null),L=z[0],P=z[1],B=Object(a.useState)(null),K=B[0],Z=B[1],J=Object(a.useState)(null),X=J[0],Q=J[1],V=Object(a.useState)(null),U=V[0],q=V[1],_=Object(a.useState)(null),ee=_[0],le=_[1],re=Object(a.useState)(!1),ie=re[0],se=re[1],ve=Object(a.useState)(!1),he=ve[0],ge=ve[1],ye=Object(a.useState)(!1),pe=ye[0],be=ye[1],xe=Object(a.useState)(!1),we=xe[0],Ee=xe[1],Oe=h.hideRowHeaders,je=h.hideColumnHeaders,Se=f.cellToPixel,Me=(0,f.getVersion)(),Ne=Object(a.useMemo)((function(){var e=fe(t)[1],n=e[0],a=e[1];return ce(t)?ne(te(Se([0,a],[0,1]),[.5*W,0]),x):ue(t)?ne(te(Se([n,0],[1,0]),[0,.5*W]),x):function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1!==n&&-1!==r&&-1!==a&&-1!==o}(t)?ne(Se([n,a],x),x):null}),[t,Se,Me]),De={selection:t,knobArea:n,editMode:l,editData:r,sourceData:o,cellLayout:f,visibleCells:v,hitTarget:L,knobPosition:Ne,columnResize:K,rowResize:X,columnDrag:U,rowDrag:ee,draggingKnob:ie,draggingSelection:he,draggingRowSelection:pe,draggingColumnSelection:we},ke=Object(a.useRef)(De);ke.current=De;var Te=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return null;var t=e.target.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}),[]),Ie=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return[0,0];var t=e.target;return[t.scrollLeft,t.scrollTop]}),[]),Ae=Object(a.useCallback)((function(t){var n=e.current;if(!n)return null;for(var a,l=y(n);!(a=l()).done;){var r=a.value,o=r.rect;if(de(o,t))return r}return null}),[e]),He=Object(a.useCallback)((function(){window.document.body.style.cursor="auto"}),[]),Re=Object(a.useCallback)((function(e){var t,n,a=ke.current,r=a.selection,o=a.cellLayout,i=o.columnToPixel,f=o.rowToPixel,v=o.pixelToCell,h=o.getIndentX,m=o.getIndentY,g=a.visibleCells,p=g.columns,b=g.rows,C=a.knobPosition;if(0===e.button){null===(t=e.target)||void 0===t||null===(n=t.setPointerCapture)||void 0===n||n.call(t,e.pointerId);var x=Te(e);if(x){var j=x[0],M=x[1],N=Ae(x);if(N)return P(N),void(ke.current.hitTarget=N);for(var D=fe(r),H=D[0],z=H[0],L=H[1],B=D[1],Y=B[0],F=B[1],K=[],J=[],X=z;X<=Y;X++)K.push(X);for(var V=L;V<=F;V++)J.push(V);if(!je&&M<m()){if(k){var U=i(z)+G,_=i(Y,1)-G;if($(j,U,_))for(var ee,te=y(p);!(ee=te()).done;){var ne=ee.value,ae=i(ne,0),re=i(ne,1);if(ue(r)&&$(j,ae,re)&&$(ne,z,Y)&&s(ne)){window.document.body.style.cursor="grabbing";var oe=K,ie=i(Y,1)-i(z),de=Ie(e)[0];return q({anchor:j,scroll:de,size:ie,indices:oe}),void(null===O||void 0===O||O([0,0]))}}}if(I)for(var ve,he=y(p);!(ve=he()).done;){var me=ve.value,ye=i(me,1);if(Math.abs(ye-j)<G&&c(me)){window.document.body.style.cursor="col-resize";var pe=ue(r)&&Y===me,Ce=pe?K:[me],xe=pe?i(Y,1)-i(z):i(me,1)-i(me),we=Ie(e)[0];return void Z({anchor:j,scroll:we,size:xe,indices:Ce})}}}if(!Oe&&j<h()){if(T){var Se=f(L)+G,Me=f(F,1)-G;if($(M,Se,Me))for(var Ne,De=y(b);!(Ne=De()).done;){var He=Ne.value,Re=f(He,0),ze=f(He,1);if(ce(r)&&$(M,Re,ze)&&$(He,L,F)&&d(He)){window.document.body.style.cursor="grabbing";var Le=J,We=f(F,1)-f(L),Pe=Ie(e)[1];return le({anchor:M,scroll:Pe,size:We,indices:Le}),void(null===O||void 0===O||O([0,0]))}}}if(A)for(var Be,Ye=y(b);!(Be=Ye()).done;){var Fe=Be.value,Ge=f(Fe,1);if(Math.abs(Ge-M)<G&&u(Fe)){window.document.body.style.cursor="row-resize";var Ke=ce(r)&&F===Fe,Ze=Ke?J:[Fe],Je=Ke?f(F,1)-f(L):f(Fe,1)-f(Fe),Xe=Ie(e)[1];return void Q({anchor:M,scroll:Xe,size:Je,indices:Ze})}}}if(C){var Qe=C[0],Ve=C[1];if(Math.abs(j-Qe)<W&&Math.abs(M-Ve)<W)return se(!0),void(null===E||void 0===E||E(r))}var Ue=v(x),qe=e.shiftKey?[].concat(r[0]):Ue;l&&(R||null===w||void 0===w||w());var $e=!0;!Oe&&j<h()&&($e=!1,be(!0),qe[0]=-1,Ue[0]=-1),!je&&M<m()&&($e=!1,Ee(!0),qe[1]=-1,Ue[1]=-1),ge(!0),null===S||void 0===S||S([qe,Ue],$e,!0)}}}),[Te,Ie,Ae,k,T,I,A,E,S,w,c,u,s,d,R]),ze=Object(a.useCallback)((function(e){var t,n=ke.current,a=n.knobArea,l=n.selection,r=n.sourceData,o=n.editData,c=n.columnDrag,u=n.rowDrag,s=n.draggingKnob,d=n.hitTarget,f=n.cellLayout,v=f.pixelToColumn,h=f.pixelToRow,m=f.getIndentX,g=f.getIndentY;if(a&&s){var y=Ce(a,l,r,o,i);null===D||void 0===D||D(y),null===S||void 0===S||S(a,!0,!0),null===E||void 0===E||E(null)}var p=Te(e);if(p&&(c||u)){window.document.body.style.cursor="auto",null===O||void 0===O||O(null),null===j||void 0===j||j(null);var b=p[0],C=p[1],x=fe(l),w=x[0],I=w[0],A=w[1],H=x[1],R=H[0],z=H[1],L=v(Math.max(b,m()),.5),W=h(Math.max(C,g()),.5);if(c){var B=c.indices;if(!(L>=I&&L<=R+1)){var Y=L>I?L-B.length:L;null===S||void 0===S||S([[Y,A],[Y+R-I,z]],!1,!1,!0),null===k||void 0===k||k(B,Y),null===M||void 0===M||M(Math.min(I,Y))}}if(u){var F=u.indices;if(!(W>=A&&W<=z+1)){var G=W>A?W-F.length:W;null===S||void 0===S||S([[I,G],[R,G+z-A]],!1,!1,!0),null===T||void 0===T||T(F,G),null===N||void 0===N||N(Math.min(A,G))}}}if((ge(!1),be(!1),Ee(!1),se(!1),Z(null),q(null),Q(null),le(null),p&&d)&&(P(null),JSON.stringify(d.rect)===JSON.stringify(null===(t=Ae(p))||void 0===t?void 0:t.rect))){var K,J=d.obj;null===(K=J.onClick)||void 0===K||K.call(J,e)}}),[Te,Ae,D,S,E,j,k,T]),Le=Object(a.useCallback)((function(e){var t=ke.current,n=t.selection,a=t.visibleCells,l=t.knobPosition,r=t.columnResize,o=t.columnDrag,i=t.rowResize,f=t.rowDrag,v=t.draggingKnob,h=t.draggingSelection,m=t.draggingColumnSelection,b=t.draggingRowSelection,x=t.cellLayout,w=x.columnToPixel,D=x.rowToPixel,H=x.pixelToCell,R=x.pixelToColumn,z=x.pixelToRow,L=x.getIndentX,P=x.getIndentY,B=Te(e);if(B){window.document.body.style.cursor="auto",Ae(B)?window.document.body.style.cursor="pointer":o||f?window.document.body.style.cursor="grabbing":r?(window.document.body.style.cursor="col-resize",e.preventDefault()):i?(window.document.body.style.cursor="row-resize",e.preventDefault()):(b||m)&&e.preventDefault();var K=a.columns,Z=a.rows,J=B[0],X=B[1],Q=fe(n),V=Q[0],U=V[0],q=V[1],_=Q[1],ee=_[0],te=_[1];if(!(r||o||i||f||b||m)){if(!je&&X<P()){if(k){var ne=w(U)+G,le=w(ee,1)-G;if($(J,ne,le))for(var re,ie=y(K);!(re=ie()).done;){var se=re.value,de=w(se),ve=w(se,1);if(!m&&ue(n)&&$(J,de,ve)&&$(se,U,ee)&&s(se))return void(window.document.body.style.cursor="grab")}}if(I)for(var he,ge=y(K);!(he=ge()).done;){var ye=he.value,pe=w(ye,1);if(Math.abs(pe-J)<G&&c(ye))return void(window.document.body.style.cursor="col-resize")}}if(!Oe&&J<L()){if(T){var be=D(q)+G,Ce=D(te,1)-G;if($(X,be,Ce))for(var xe,we=y(Z);!(xe=we()).done;){var Ee=xe.value,Se=D(Ee),Me=D(Ee,1);if(!b&&ce(n)&&$(X,Se,Me)&&$(Ee,q,te)&&d(Ee))return void(window.document.body.style.cursor="grab")}}if(A)for(var Ne,De=y(Z);!(Ne=De()).done;){var He=Ne.value,Re=D(He,1);if(Math.abs(Re-X)<G&&u(He))return void(window.document.body.style.cursor="row-resize")}}if(l){var ze=l[0],Le=l[1];if(Math.abs(J-ze)<W&&Math.abs(X-Le)<W)return void(window.document.body.style.cursor="crosshair")}}if(r){if(I){var We=r.size,Pe=r.anchor,Be=r.scroll,Ye=r.indices,Fe=Ie(e)[0],Ge=Math.max(We+J-Pe+Be-Fe,Y*Ye.length);null===M||void 0===M||M(Ye[0]-1),I(Ye,Ge/Ye.length)}}else if(i){if(A){var Ke=i.size,Ze=i.anchor,Je=i.scroll,Xe=i.indices,Qe=Ie(e)[1],Ve=Math.max(Ke+X-Ze+Je-Qe,F*Xe.length);null===N||void 0===N||N(Xe[0]-1),A(Xe,Ve/Xe.length)}}else{if(h){var Ue=n[0],qe=H(B),$e=Ue[0],_e=Ue[1],et=qe[0],tt=qe[1];b?null===S||void 0===S||S([[-1,_e],[-1,Math.max(0,tt)]],!1):m?null===S||void 0===S||S([[$e,-1],[Math.max(0,et),-1]],!1):null===S||void 0===S||S([ae(Ue,C),ae(qe,C)],!1)}if(v){window.document.body.style.cursor="crosshair";var nt=H(B),at=nt[0],lt=nt[1],rt=fe(n),ot=rt[0],it=ot[0],ct=ot[1],ut=rt[1],st=ut[0],dt=ut[1],ft=Math.min(at-it,st-at,0),vt=Math.min(lt-ct,dt-lt,0);oe(n)||ft>vt?lt<ct?ct=lt:lt>dt&&(dt=lt):at<it?it=at:at>st&&(st=at),null===E||void 0===E||E([[it,ct],[st,dt]])}if(o||f){var ht=B[0],mt=B[1];if(o){var gt=R(Math.max(ht,L()),.5),yt=gt>=U&&gt<=ee+1,pt=me(gt,g),bt=o.anchor,Ct=o.scroll,xt=ht-bt,wt=Ie(e)[0];null===O||void 0===O||O([xt+wt-Ct,0]),null===j||void 0===j||j(yt||pt?null:[[gt,-1],[gt,-1]])}if(f){var Et=z(Math.max(mt,P()),.5),Ot=Et>=q&&Et<=te+1,jt=me(Et,p),St=f.anchor,Mt=f.scroll,Nt=mt-St,Dt=Ie(e)[1];null===O||void 0===O||O([0,Nt+Dt-Mt]),null===j||void 0===j||j(Ot||jt?null:[[-1,Et],[-1,Et]])}}}}}),[Te,Ie,Ae,I,A,O,j,S,E,N,M]),We=Object(a.useCallback)((function(e){var t=ke.current.cellLayout.pixelToCell;if(e.preventDefault(),!e.shiftKey){var n=Te(e);if(n)if(Ae(n))window.document.body.style.cursor="pointer";else{var a=t(n);l&&(null===w||void 0===w||w()),null===b||void 0===b||b(a)}}}),[Te,Ae,w,b]),Pe=Object(a.useCallback)((function(e){var n=ke.current.cellLayout,a=n.pixelToCell,l=n.getIndentX,r=n.getIndentY,o=Te(e);if(o){var i=o[0],c=o[1];if(!(i<=l()||c<=r())){var u=a(o);de(t,u)||null===S||void 0===S||S([u,u]),Le(e);var s=m({},e,{cellX:u[0],cellY:u[1]});null===H||void 0===H||H(s)}}}),[Te,S,Le,H]);return{knobPosition:Ne,mouseHandlers:{onPointerLeave:He,onPointerDown:Re,onPointerMove:Le,onPointerUp:ze,onDoubleClick:We,onContextMenu:Pe}}}(Ft,ee,Se,jt,gt,ht,vt,it,ct,ut,st,Ht,Wt,bt,ft,dt,Yt,Bt,Me,ze,Pe,Pt,e.cacheLayout?Nt.clearAfter:void 0,e.cacheLayout?Dt.clearAfter:void 0,e.onChange,e.onColumnOrderChange,e.onRowOrderChange,e.onCellWidthChange,e.onCellHeightChange,e.onRightClick,e.dontCommitEditOnSelectionChange),Jt=Zt.mouseHandlers,Xt=Zt.knobPosition;Object(a.useLayoutEffect)((function(){var e=c.current;if(e){var t=e.getContext("2d");if(t){var n=window.requestAnimationFrame((function(){Ft.current=function(e,t,n,a,l,r,o,i,c,u,s,d,f,v,h){var g=e.canvas,p=g.width,b=g.height,C=a.hideGridlines,x=a.hideRowHeaders,w=a.hideColumnHeaders,E=a.rowHeaderWidth,O=a.columnHeaderHeight,j=a.freezeColumns,M=a.freezeRows,L=a.shadowBlur,P=a.shadowColor,B=a.shadowOpacity,Y=n.columns,F=n.rows,G=t.columnToPixel,K=t.rowToPixel,Z=t.columnToAbsolute,U=t.rowToAbsolute,q=[],_=[j,M],ee=[E,O];Te(g),e.clearRect(0,0,p,b),e.fillStyle="white",e.fillRect(0,0,p,b),e.shadowColor="#00000080";for(var te,ne=y(F);!(te=ne()).done;)for(var ae,le=te.value,re=y(Y);!(ae=re()).done;){var oe=ae.value,ie=G(oe),de=G(oe,1),ve=K(le),he=K(le,1),me=l(oe,le).fillColor;me&&(e.fillStyle=me,e.fillRect(ie,ve,de-ie,he-ve))}var ge=!se(r),ye=ce(r),pe=ue(r),be=ke(r,t,_,ee,h),Ce=be[0],xe=be[1];if(ge){var we=Ce[0],Ee=we[0],Oe=we[1],je=Ce[1],Se=je[0],Me=je[1];e.fillStyle=D,e.fillRect(Ee,Oe,Se-Ee,Me-Oe)}if(!x&&(e.fillStyle=H,e.fillRect(0,0,E,e.canvas.height),ge&&!pe)){var He=Ce[0][1],Re=Ce[1][1];e.fillStyle=z,e.fillRect(0,He,E,Re-He)}if(!w&&(e.fillStyle=H,e.fillRect(0,0,e.canvas.width,O),ge&&!ye)){var ze=Ce[0][0],Le=Ce[1][0];e.fillStyle=z,e.fillRect(ze,0,Le-ze,O)}e.strokeStyle=k,e.lineWidth=1;var We=C?E:e.canvas.width,Pe=C?O:e.canvas.height,Be=function(t,n){e.beginPath(),e.moveTo(t-.5,0),e.lineTo(t-.5,n),e.stroke()},Ye=function(t,n){e.beginPath(),e.moveTo(0,t-.5),e.lineTo(n,t-.5),e.stroke()};Be(E,e.canvas.height),Ye(O,e.canvas.width);for(var Fe,Ge=y(Y);!(Fe=Ge()).done;){Be(G(Fe.value,1),Pe)}for(var Ke,Ze=y(F);!(Ke=Ze()).done;){Ye(K(Ke.value,1),We)}var Je=fe(r),Xe=Je[0],Qe=Xe[0],Ve=Xe[1],Ue=Je[1],qe=Ue[0],$e=Ue[1];if(!x){e.textBaseline="middle",e.textAlign="center",e.font=J.fontSize+"px "+J.fontFamily,e.fillStyle=R;for(var _e,et=y(F);!(_e=et()).done;){var tt=_e.value,nt=""+(tt+1),at=$(tt,Ve,$e),lt=ye&&!pe&&at?V:at?Q:S,rt=K(tt),ot=K(tt,1);q.push.apply(q,Ne(e,nt,lt,X,0,rt,E,ot-rt))}}if(!w){e.textBaseline="middle",e.textAlign="center";for(var it,ct=y(Y);!(it=ct()).done;){var ut,st=it.value,dt=null!=(ut=d(st))?ut:Ie(st+1),ft=$(st,Qe,qe),vt=pe&&!ye&&ft?V:S,ht=ft?Q:S,mt=m({},f(st),ht,vt),gt=G(st),yt=G(st,1);q.push.apply(q,Ne(e,dt,mt,X,gt,0,yt-gt,O))}}if(ge){e.strokeStyle=N,e.lineWidth=2;var pt=Ce[0],bt=pt[0],Ct=pt[1],xt=Ce[1],wt=xt[0],Et=xt[1];e.strokeRect(bt,Ct,wt-bt-1,Et-Ct-1)}for(var Ot,jt=y(o);!(Ot=jt()).done;){var St=Ot.value,Mt=St.span;if(!se(Mt)){var Nt=ke(Mt,t,_,ee,h)[0],Dt=Nt[0],kt=Dt[0],Tt=Dt[1],It=Nt[1],At=It[0],Ht=It[1];e.strokeStyle=St.color,e.lineWidth=1,e.beginPath(),e.strokeRect(kt-1,Tt-1,At-kt+1,Ht-Tt+1)}}if(c){var Rt=fe(c),zt=Rt[0],Lt=zt[0],Wt=zt[1],Pt=Rt[1],Bt=Pt[0],Yt=Pt[1],Ft=G(Lt),Gt=K(Wt),Kt=G(Bt,1),Zt=K(Yt,1);e.strokeStyle=A,e.setLineDash([3,3]),e.lineWidth=1,e.strokeRect(Ft-1,Gt-1,Kt-Ft+1,Zt-Gt+1),e.setLineDash([])}if(i&&!xe){var Jt=i[0],Xt=i[1];e.fillStyle=N,e.fillRect(Jt-.5*W,Xt-.5*W,W,W)}if(u){var Qt=u[0],Vt=u[1],Ut=De(r,t),qt=Ut[0],$t=qt[0],_t=qt[1],en=Ut[1],tn=en[0],nn=en[1];e.fillStyle=T,e.fillRect($t+Qt,_t+Vt,tn-$t,nn-_t)}if(s){var an=De(s,t),ln=an[0],rn=ln[0],on=ln[1],cn=an[1],un=cn[0],sn=cn[1];e.strokeStyle=I,e.lineWidth=2,ue(s)&&(un=rn),ce(s)&&(sn=on),e.strokeRect(rn-1,on-1,un-rn,sn-on)}var dn=h[0],fn=h[1],vn=M>0&&fn>0,hn=j>0&&dn>0;if(vn||hn){if(vn){var mn=O+U(M),gn=e.createLinearGradient(0,mn,0,mn+L);Ae(gn,P,B),e.fillStyle=gn,e.fillRect(0,mn,p,L)}if(hn){var yn=E+Z(j),pn=e.createLinearGradient(yn,0,yn+L,0);Ae(pn,P,B),e.fillStyle=pn,e.fillRect(yn,0,L,b)}}e.textBaseline="middle";for(var bn,Cn=y(F);!(bn=Cn()).done;)for(var xn,wn=bn.value,En=y(Y);!(xn=En()).done;){var On=xn.value,jn=G(On),Sn=G(On,1),Mn=K(wn),Nn=K(wn,1),Dn=v(On,wn);if(null!==Dn&&void 0!==Dn){var kn=l(On,wn);q.push.apply(q,Ne(e,Dn,kn,J,jn,Mn,Sn-jn,Nn-Mn))}}return q}(t,Ht,Wt,bt,pt,ee,Ct,Xt,Se,Re,We,rt,ot,mt,g)}));return function(){window.cancelAnimationFrame(n)}}}}),[Ht,Wt,bt,pt,ee,Ct,Xt,Se,Re,We,rt,ot,mt,g]);var Qt=Object(a.useState)(""),Vt=Qt[0],Ut=Qt[1],qt=C,$t=0,_t=0,en="right";if(jt){var tn=pt.apply(void 0,Ye);qt=zt(Ye),qt=te(qt,x),$t=at(Et)-3,_t=lt(Ot)-3,en=tn.textAlign||J.textAlign||"left",yt.apply(void 0,Ye)!==Vt&&(Ut(""),Fe(w))}var nn=qt,an=nn[0],ln=nn[1],rn={value:Xe,autoFocus:!0,onKeyDown:function(e){if("Escape"!==e.key){var t="Enter"===e.key?"down":"Tab"===e.key?"right":Ue?U[e.key]:null;if(t){e.preventDefault();var n=le(t),a=ae(te(Ye,n),C);Bt(),Pt([a,a])}}else Fe(w)},style:{position:"absolute",left:an,top:ln,padding:"0px 4px",width:$t,height:_t,outline:"none",border:"none",textAlign:en,color:"black",fontSize:J.fontSize,fontFamily:"sans-serif"}},on=null===(i=e.inputComponent)||void 0===i?void 0:i.call(e,Et,Ot,m({},rn,{onChange:Qe}),Bt),cn=p,un={position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",borderBottom:"1px solid #ddd"},sn={width:et,height:nt,outline:"1px solid #ddd"};bt.hideScrollBars&&(delete sn.outline,delete un.borderBottom,cn="");var dn=Object(a.useMemo)((function(){var t;return null===(t=e.renderInside)||void 0===t?void 0:t.call(e,{visibleCells:Wt,cellLayout:Ht,selection:ee,editMode:jt})}),[e.renderInside,Wt,Ht,ee,jt]),fn=Object(a.useMemo)((function(){var t;return null===(t=e.renderOutside)||void 0===t?void 0:t.call(e,{visibleCells:Wt,cellLayout:Ht,selection:ee,editMode:jt})}),[e.renderOutside,Wt,Ht,ee,jt]);return Object(a.useImperativeHandle)(t,(function(){return m({},Ht,{startEditingCell:Yt})}),[Ht,Yt]),l.a.createElement("div",{style:{position:"relative",height:"100%",overflow:"hidden"}},l.a.createElement("canvas",{style:sn,ref:c}),l.a.createElement("div",Object.assign({ref:u},Jt,{onScroll:Kt,className:cn,style:un}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:wt+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:xt+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}}),dn?l.a.createElement("div",{style:{position:"sticky",left:0,top:0}},dn):null),fn?l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}},fn):null,l.a.createElement("textarea",{style:{position:"absolute",top:0,left:0,width:1,height:1,opacity:.01},ref:Gt,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onFocus:function(e){return e.target.select()},tabIndex:0,onKeyDown:function(t){if(jt&&Ue&&t.key in U)Bt();else if(!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())if(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase())if("Backspace"!==t.key&&"Delete"!==t.key){if(!se(ee)){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key){var n=ee[0],a=n[0],l=n[1];return vt(a,l)?void t.preventDefault():void Yt(n,"Enter"!==t.key)}if(t.key in U){var r=ee[0],o=ee[1],i=U[t.key],c=le(i);return o=t.metaKey||t.ctrlKey?be(mt,o,i):ae(te(o,c),C),t.shiftKey||(r=o),void Pt([r,o],!0,!0)}t.preventDefault()}}else{var u=fe(ee),s=u[0],d=s[0],f=s[1],v=u[1],h=v[0],m=v[1];ce(ee)&&(d=0,h=65536),ue(ee)&&(f=0,m=65536);for(var g=[],y=f;y<=m;y++)for(var p=d;p<=h;p++)vt(p,y)||g.push({x:p,y:y,value:null});e.onChange&&e.onChange(g)}else{var b=Gt.current;null===b||void 0===b||b.select()}}}),jt&&(void 0!==on?on:l.a.createElement("input",Object.assign({},rn,{type:"text",onFocus:function(e){return e.target.select()},onChange:function(e){return Qe(e.target.value)}}))))})),Re=(n(27),[]),ze=0;ze<1e3;ze++){for(var Le=[],We=0;We<100;We++)Le.push("Row: ".concat(ze,", Col: ").concat(We));Re.push(Le)}for(var Pe=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],Be=[],Ye=0;Ye<1e3;Ye++){for(var Fe=[],Ge=0;Ge<100;Ge++)Fe.push(1e6*Math.random());Be.push(Fe)}var Ke=new Image;Ke.src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=",Ke.width=10,Ke.height=10;function Ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},r=Object(a.useState)(e),o=Object(s.a)(r,2),i=o[0],c=o[1],u=Object(a.useState)(t),d=Object(s.a)(u,2),h=d[0],m=d[1],g=function(e,t){var a,l=Object(v.a)(i),r=Object(f.a)(e);try{for(r.s();!(a=r.n()).done;){var o=a.value,u=n(o);if(u>l.length)for(var s=l.length;s<=u;s++)l.push(100);l[u]=t}}catch(d){r.e(d)}finally{r.f()}c(l)},y=function(e,t){var n,a=Object(v.a)(h),r=Object(f.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=l(o);if(i>a.length)for(var c=a.length;c<=i;c++)a.push(22);a[i]=t}}catch(u){r.e(u)}finally{r.f()}m(a)},p=function(e){var t;return null!==(t=i[n(e)])&&void 0!==t?t:100},b=function(e){var t;return null!==(t=h[l(e)])&&void 0!==t?t:22};return{onCellWidthChange:g,onCellHeightChange:y,cellWidth:p,cellHeight:b}}function Je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(a.useState)(e),l=Object(s.a)(n,2),r=l[0],o=l[1],i=Object(a.useState)(t),c=Object(s.a)(i,2),u=c[0],d=c[1],f=function(e){var t;return null!==(t=r[e])&&void 0!==t?t:e},h=function(e){var t;return null!==(t=u[e])&&void 0!==t?t:e},m=function(e,t){for(var n=Object(v.a)(r),a=e[0],l=Math.max(t+e.length,e.reduce((function(e,t){return Math.max(e,t)})));n.length<l;)n.push(n.length);n.splice(a,e.length),n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){return f(e)}))))),o(n)},g=function(e,t){for(var n=Object(v.a)(u),a=e[0],l=Math.max(t+e.length,e.reduce((function(e,t){return Math.max(e,t)})));n.length<l;)n.push(n.length);n.splice(a,e.length),n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){return h(e)}))))),d(n)};return{getColumnOrder:f,getRowOrder:h,onColumnOrderChange:m,onRowOrderChange:g}}function Xe(){var e=Object(a.useState)(Re),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Je(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=Ze([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,editKeys:function(e,t){return"".concat(e,",").concat(t)},cacheLayout:!0}))}function Qe(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Pe))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Je(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=Ze([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,cacheLayout:!0}))}var Ve=new Image;function Ue(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Pe))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Ze(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight,h=["#f00","#0f0","#00f","#000"],m=["left","right","center"],g=["normal","bold","lighter"],y=[0,0,0,0,20];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:function(e){return 0===e?{items:[{content:"A",x:0,y:0,horizontalAlign:"center"},{content:Ke,x:0,y:-6,width:12,height:12,horizontalAlign:"right",onClick:function(){console.log("click")}}]}:null},cellStyle:function(e,t){return 0===e||0===t?{fillColor:"#6DA2FB22",marginRight:10}:{color:h[t%4],textAlign:m[e%3],marginRight:y[e%5],weight:g[t%3]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,l;return 0===e&&t>0&&t<9?{items:[{content:Ve,x:0,y:-8,width:16,height:16,horizontalAlign:"right",onClick:function(){!function(e,t){var a=Object(v.a)(n);a[t]&&void 0!==a[t][e]&&(a[t][e]+=1),r(a)}(e,t)}},{content:null===n||void 0===n||null===(l=n[t])||void 0===l?void 0:l[e],x:0,y:0,horizontalAlign:"left"}]}:null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,sheetStyle:{freezeColumns:1,freezeRows:1},cacheLayout:!0}))}function qe(){var e=Object(a.useState)(Be),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Ze(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,l,r;return null===n||void 0===n||null===(a=n[t])||void 0===a||null===(l=a[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=Number(o.value)}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,cacheLayout:!0}))}function $e(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Pe))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Ze(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{selection:[[1,2],[1,2]],onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=o.x,c=o.y,u=o.value;a[c]||(a[c]=[]),a[c][i]=u}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,renderInside:function(e){var t=e.visibleCells,n=e.cellLayout,a=e.selection;if(!e.editMode){var r=[1,2],o=Object(s.a)(a,1)[0],i=o[0]===r[0]&&o[1]===r[1];if(!(t.columns.includes(r[0])&&t.rows.includes(r[1])))return null;var c=n.cellToPixel(r,[0,0]),u=Object(s.a)(c,2)[1],d=n.cellToPixel(r,[1,1]),f=Object(s.a)(d,1)[0],v=l.a.createElement("div",{style:{position:"absolute",left:f,top:u,marginLeft:"-12px",borderTop:"12px solid blue",borderLeft:"12px solid transparent",pointerEvents:"none"}}),h=i?l.a.createElement("div",{style:{position:"absolute",left:f,top:u,padding:10,background:"#fff",border:"1px solid #ccc"}},"Hello world"):null;return l.a.createElement("div",{onPointerDown:function(e){return e.stopPropagation()}},h,v)}},cacheLayout:!0}))}function _e(){var e=Object(a.useState)(Re),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Je(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=Ze([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight,b=[1,1,1,2,2,2,3,3,4,4,5,6,6,7,8,8],C=b.map((function(e,t){return b[d(t)]})),x=C.map((function(e,t){return e!==C[t-1]})).reduce((function(e,t){var n,a=null!==(n=e.at(-1))&&void 0!==n?n:1,l=t?1-a:a;return e.push(l),e}),[]);return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{fillColor:["#ffffff","#e0e0e0"][x[t]]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,rowGroupKeys:function(e){return C[e]},editKeys:function(e,t){return"".concat(e,",").concat(t)},cacheLayout:!0}))}function et(){var e=Object(a.useState)("initial"),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(s.a)(o,2),c=i[0],u=i[1],d=Ze(),h=d.onCellWidthChange,m=d.onCellHeightChange,g=d.cellWidth,y=d.cellHeight;return l.a.createElement(l.a.Fragment,null,"initial"===n?l.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),r("loading"),fetch("./out.json").then((function(e){return e.json()})).then((function(e){u(e),r("done")}))}},"Load global database of power plants"):"loading"===n?"Loading...":null,l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{cellStyle:function(e,t){return 0===t?{weight:"bold",fontSize:14}:4===e?{textAlign:"right"}:1===e?{weight:"bold",color:"#3b85ff"}:2===e?{color:"#fc3bff"}:{}},editData:function(e,t){var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},displayData:function(e,t){var n;return 4===e&&t>0?c&&c[t]&&c[t][e]?Number(c[t][e]).toFixed(2):"":null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},sourceData:function(e,t){var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},cellWidth:g,cellHeight:y,onChange:function(e){var t,n=Object(v.a)(c),a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var l=t.value;n[l.y]||(n[l.y]=[]),n[l.y][l.x]=l.value}}catch(r){a.e(r)}finally{a.f()}u(n)},readOnly:function(e,t){return!1},onCellWidthChange:h,onCellHeightChange:m,columnHeaderStyle:function(e){var t=(2421*e%255).toString(16).padStart(2,"0"),n=(3215*e%255).toString(16).padStart(2,"0"),a=(1243*e%255).toString(16).padStart(2,"0");return{backgroundColor:"#".concat(t).concat(n).concat(a,"55")}},columnHeaders:function(e){return""+e},sheetStyle:{freezeColumns:0,freezeRows:1},cacheLayout:!0})))}Ve.src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==",Ve.width=16,Ve.height=16;var tt=["First","Second","Third","Fourth","Fifth"],nt=["Sixth","Seventh","Eighth","Ninth","Tenth"],at=[tt,nt,tt,nt,tt,nt,tt];function lt(){var e=Object(a.useState)(JSON.parse(JSON.stringify(at))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Ze(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,inputComponent:rt,cacheLayout:!0}))}function rt(e,t,n,a){return l.a.createElement("div",{style:Object(d.a)(Object(d.a)({},n.style),{},{backgroundColor:"#fff"})},l.a.createElement("div",{style:{border:"1px solid #ddd",boxShadow:"3px 5px 5px #ddd"}},(t%2?nt:tt).map((function(e){return l.a.createElement(ot,{key:e,opt:e,value:n.value,clickHandler:function(){a(e)}})}))))}function ot(e){var t=e.opt,n=e.value,r=e.clickHandler,o=Object(a.useState)(!1),i=Object(s.a)(o,2),c=i[0],u=i[1];return l.a.createElement("div",{onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)},style:{backgroundColor:n===t||c?"#f6f6f6":"#fff",padding:"5px 10px",cursor:"pointer"},value:t,onClick:function(){return r(t)}},t)}function it(){var e=Object(a.useState)([[1,2,3],[10,20,30]]),t=Object(s.a)(e,1)[0];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(He,{sourceData:t,displayData:function(e,n){var a,l,r;return null===t||void 0===t||null===(a=t[n])||void 0===a||null===(l=a[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)}}))}var ct=n(17),ut=n.n(ct);var st=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],o=n[1];return l.a.createElement("div",{className:"container blue-bg",id:"home"},l.a.createElement("div",{className:"content flex-row header"},l.a.createElement("div",{className:"box text-box"},l.a.createElement("div",null,l.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),l.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",l.a.createElement("br",null),"And it's super fast.")),l.a.createElement("div",{className:"lib-box"},l.a.createElement("div",{className:"install-box",onClick:function(t){e.current.select(),document.execCommand("copy"),t.target.focus(),o("Copied!"),setTimeout((function(){o("")}),1e3)}},l.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==r&&l.a.createElement("div",{className:"copy-success"},r)),l.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",rel:"noopener noreferrer",className:"git-box",target:"_blank"},l.a.createElement("img",{src:ut.a,alt:"Git"}),"view on github"))),l.a.createElement("div",{className:"box"},l.a.createElement(Xe,null))))};var dt=function(e){var t=e.title,n=e.id;return l.a.createElement("div",{className:"title-separator",id:n||""},l.a.createElement("p",null,t||"No title"),l.a.createElement("div",{className:"separator"}))};var ft=function(e){var t=e.children;return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"content flex-row"},t))},vt=n(251),ht=n(250);ht.a.hljs.padding="10px 20px",ht.a.hljs.background="#f8f9fa",ht.a.hljs.width="100%",ht.a.hljs.maxWidth="100%",ht.a.hljs.overflow="auto",ht.a.hljs.borderRadius="3px",ht.a.hljs.fontSize="14px";function mt(){var e=Object(d.a)({},ht.a);return e.hljs.height="100%",l.a.createElement(vt.a,{language:"javascript",style:e},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);')}function gt(){return l.a.createElement(vt.a,{language:"javascript",style:ht.a},"import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}")}function yt(){return l.a.createElement(vt.a,{language:"javascript",style:ht.a},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);')}function pt(){return l.a.createElement(vt.a,{language:"javascript",style:ht.a},'...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);')}function bt(){return l.a.createElement(vt.a,{language:"javascript",style:ht.a},"...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);")}var Ct=function(){return l.a.createElement("div",{className:"footer"},l.a.createElement("p",{className:"copy"},"made by ",l.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};function xt(e){var t=e.text;return l.a.createElement("span",{className:"emphased"},t)}var wt=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(u,null),l.a.createElement(st,null),l.a.createElement(dt,{title:"Get started",id:"usage"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width colored-pre",style:{overflowX:"auto"}},l.a.createElement("p",null,"Import the component and its style, and render it"),l.a.createElement(gt,null),l.a.createElement("div",{className:"spacer"}),l.a.createElement("p",null,"Display some data"),l.a.createElement(yt,null))),l.a.createElement(dt,{title:"Learn more about features",id:"features"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement(Qe,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Basic spreadsheet"),l.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize and reorder columns and rows."))),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement(Ue,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Styling"),l.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns, and add clickable images."))),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement(qe,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Formatting"),l.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement($e,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Overlays"),l.a.createElement("p",null,"You can attach HTML overlays to the sheet, for additional controls, notes, etc."))),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement(_e,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Grouped rows and columns"),l.a.createElement("p",null,"You can make rows act as a group for drag-and-drop operation."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(dt,{title:"Big dataset example",id:"big dataset example"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("p",null,"Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it will be handled blazingly fast and super responsive because component is canvas-based and it draws only the small chunk of data user sees at the moment."),l.a.createElement("br",null),l.a.createElement(et,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(dt,{title:"Custom input fields",id:"custom input example"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement(lt,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Custom input component"),l.a.createElement("p",null,"If basic text input isn't enough, you can send your own React component to be displayed instead."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(dt,{title:"Documentation",id:"documentation"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Displaying data"),l.a.createElement("p",null,"If you have some data you want to display, you send it via ",l.a.createElement(xt,{text:"sourceData"})," and"," ",l.a.createElement(xt,{text:"displayData"})," props."),l.a.createElement("p",null,"The first one receives unformatted data which is used for data manipulation, and the second one formatted which is used for displaying in cells."),l.a.createElement("br",null),l.a.createElement("p",null,"Each of this can be either array of arrays of values (where each array is representing data for one row) or function (which returns value based on x and y coordinates that are sent as arguments to your function)."))),l.a.createElement(ft,null,l.a.createElement("div",{className:"box colored-pre unmargin-pre",style:{maxWidth:"100%",overflow:"auto"}},l.a.createElement(mt,null)),l.a.createElement("div",{className:"box"},l.a.createElement(it,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Editing data"),l.a.createElement("p",null,"Same as the previous two, prop ",l.a.createElement(xt,{text:"editData"})," can recieve either array of arrays of values or function for data which will be displayed in edit mode. Edit mode is activated by double click on the cell."),l.a.createElement("br",null),l.a.createElement("p",null,"Once edit is done, function sent in ",l.a.createElement(xt,{text:"onChange"})," prop will be called with array of changes as an argument. Each element of this array has value, x and y coordinates. Use this information to change values in your data array."),l.a.createElement("br",null),l.a.createElement("p",null,"Sheet also accepts ",l.a.createElement(xt,{text:"readOnly"})," prop which you can use if some cells should not be editable. Same as the most of sheet's props, you can send function, array of arrays, or a single value which then is applied to the whole table.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(pt,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Column headers"),l.a.createElement("p",null,"By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via"," ",l.a.createElement(xt,{text:"columnHeaders"})," prop as an array or function."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Cell style and width/height"),l.a.createElement("p",null,"Use prop ",l.a.createElement(xt,{text:"cellStyle"})," and ",l.a.createElement(xt,{text:"columnHeaderStyle"})," for customizing cells visually."),l.a.createElement("br",null),l.a.createElement("p",null,"You can also use ",l.a.createElement(xt,{text:"cellWidth"})," and ",l.a.createElement(xt,{text:"cellHeight"})," props to customize cell size. If you send single value ","cellWidth={200}",", it will be applied to all cells. If you send array of values ","cellWidth={[200, 80, 80]}",", they will be applied in respect to the index number."),l.a.createElement("br",null),l.a.createElement("p",null,"There are also ",l.a.createElement(xt,{text:"onCellWidthChange"})," and ",l.a.createElement(xt,{text:"onCellHeightChange"})," ","props for functions which are called when user drags cell for resize. You can use these for updating your cellWidth/cellHeight arrays.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(bt,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Selection"),l.a.createElement("p",null,"You can send a function to the ",l.a.createElement(xt,{text:"onSelectionChanged"})," prop. It will be called on selection change with x1, y1, x2 and y2 arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Right click handler"),l.a.createElement("p",null,"If you send a function to ",l.a.createElement(xt,{text:"onRightClick"})," prop, it will be called on right click with whole mouse event (extended with cellX and cellY values) as an argument."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Sticky columns/rows"),l.a.createElement("p",null,"Send a number to ",l.a.createElement(xt,{text:"freezeColumns"})," and/or ",l.a.createElement(xt,{text:"freezeRows"})," to make first n of columns/rows sticky."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ft,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Custom input"),l.a.createElement("p",null,"By default edit mode turns the cell into a text edit component. But you can send your custom input component via ",l.a.createElement(xt,{text:"inputComponent"})," props. It will be called with"," ",l.a.createElement(xt,{text:"x"}),", ",l.a.createElement(xt,{text:"y"}),", ",l.a.createElement(xt,{text:"inputProps"})," and"," ",l.a.createElement(xt,{text:"commitEditingCell"})," arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(Ct,null))};o.a.render(l.a.createElement(wt,null),document.getElementById("root"))},27:function(e,t,n){}},[[22,1,2]]]);
//# sourceMappingURL=main.d2c145f7.chunk.js.map