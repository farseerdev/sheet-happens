(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{11:function(e,t,n){e.exports=n.p+"static/media/logo.aef13910.svg"},13:function(e,t,n){e.exports=n.p+"static/media/git.f818b886.svg"},18:function(e,t,n){e.exports=n(231)},23:function(e,t,n){},231:function(e,t,n){"use strict";n.r(t);n(6);var a=n(0),l=n.n(a),o=n(10),i=n.n(o),r=n(11),c=n.n(r);var s=function(){const e=e=>{var t=document.getElementById(e),n="home"===e?0:86,a=window.pageYOffset+t.getBoundingClientRect().top-n;window.scrollTo({top:a,behavior:"smooth"})};return l.a.createElement("div",{className:"container blue-bg menu"},l.a.createElement("div",{className:"content flex-row"},l.a.createElement("div",{className:"logo-box"},l.a.createElement("img",{src:c.a,alt:"Logo"}),l.a.createElement("h2",{className:"page-title"},"sheet - happens")),l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"nav-item",onClick:()=>e("home")},"home"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("usage")},"usage"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("features")},"features"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("documentation")},"documentation"))))},d=n(2),u=n(3),h=n(1),y=n(12),f="_styles-module__sheetscroll__PxIi8";const m={textAlign:"left",fontSize:13,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},x={textAlign:"center",fontSize:13,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""};function g(e){const t=e.getBoundingClientRect(),n=t.width,a=t.height;let l=window.devicePixelRatio,o=void 0===l?1:l;o<1&&(o=1);const i=Math.round(n*o),r=Math.round(a*o);if(e.width!==i||e.height!==r){const t=e.getContext("2d");return t&&(e.width=i,e.height=r,t.scale(o,o)),!0}return!1}function v(e,t){return Array.isArray(e)?n=>n>=0&&n<e.length?e[n]:t:"function"===typeof e?e:null!==e&&void 0!==e?()=>e:()=>t}function p(e,t){return Array.isArray(e)?(n,a)=>a>=0&&a<e.length&&n>=0&&n<e[a].length?e[a][n]:t:"function"===typeof e?e:null!==e&&void 0!==e?()=>e:()=>t}function b(e,t,n,a,l){return l||(l=n.textAlign),"left"===l?e+n.marginLeft:"center"===l?e+.5*t-a/2:"right"===l?e+(t-n.marginRight-a):e}function w(e,t,n,a,l,o,i,r){if(null===t)return;const c=C(n,a);e.fillStyle=c.color,e.font=c.weight+" "+c.fontSize+"px "+c.fontFamily,e.textAlign=c.textAlign;const s=o+.5*r;if(e.save(),e.beginPath(),e.rect(l,o,i,r),e.clip(),""!==c.backgroundColor&&(e.fillStyle=c.backgroundColor,e.fillRect(l,o,i,r),e.fillStyle=c.color),"string"===typeof t||"number"===typeof t){const n=b(l,i,c,0);e.fillText(""+t,n,s)}else if("object"===typeof t){var d,u=Object(h.a)(t.items);try{for(u.s();!(d=u.n()).done;){const t=d.value;if(t.content instanceof HTMLImageElement){const n=b(l,i,c,t.width||i,t.horiozntalAlign);e.drawImage(t.content,n+t.x,s+t.y,t.width||i,t.height||r)}else if("string"===typeof t.content||"number"===typeof t.content){t.horiozntalAlign&&(e.textAlign=t.horiozntalAlign);const n=b(l,i,c,0,t.horiozntalAlign);e.fillText(""+t.content,n+t.x,s+t.y)}}}catch(y){u.e(y)}finally{u.f()}}e.restore()}function E(e,t,n,a,l){const o=[],i=[],r=[];let c=0;i.push(n),o.push(e>0?0:a),c=n+t(e>0?0:a),r.push(c);let s=e>0?1:a+1;if(e>0){for(;s<e;s++)o.push(s),i.push(c),c+=t(s),r.push(c);s=Math.max(a,e)}for(;o.push(s),i.push(c),c+=t(s),r.push(c),!(r[r.length-1]>=l);)s++;return{index:o,start:i,end:r}}function C(e,t){return Object(u.a)(Object(u.a)({},t),e)}function j(e){let t="",n=0;for(;e>0;)n=(e-1)%26,t=String.fromCharCode(65+n)+t,e=(e-n)/26|0;return t||""}function O(e,t,n,a){let l=0,o=0;for(let i=0;i<a.index.length;i++)if(e>=a.start[i]&&e<=a.end[i]){l=a.index[i];break}for(let i=0;i<n.index.length;i++)if(t>=n.start[i]&&t<=n.end[i]){o=n.index[i];break}return{x:l,y:o}}function S(e){let t=e.x1,n=e.x2;e.x1>e.x2&&(t=e.x2,n=e.x1);let a=e.y1,l=e.y2;return e.y1>e.y2&&(a=e.y2,l=e.y1),[t,a,n,l]}function H(e,t,n,a,l,o,i,r){let c=r.rowHeaderWidth;const s=a.index.findIndex(t=>t===e);if(-1!==s)c=a.start[s];else{for(let e=0;e<l.x;e++)c-=o(e);for(let t=0;t<e;t++)c+=o(t)}let d=r.columnHeaderHeight;const u=n.index.findIndex(e=>e===t);if(-1!==u)d=n.start[u];else{for(let e=0;e<l.y;e++)d-=i(e);for(let e=0;e<t;e++)d+=i(e)}return{x:c,y:d}}function M(e){let t=0,n=0,a=0,l=10,o=1.5;for(;a<4;){let n=!0;for(let a=0;a<10;a++){const l=e(t,a);if(null!==l&&void 0!==l&&""!==l){n=!1;break}}if(n&&(a+=1),t+=l,t>65536)break;l=Math.floor(l*o)}for(a=0,l=10,o=1.5;a<4;){let t=!0;for(let a=0;a<10;a++){const l=e(a,n);if(null!==l&&void 0!==l&&""!==l){t=!1;break}}if(t&&(a+=1),n+=l,n>65536)break;l=Math.floor(l*o)}return{x:t,y:n}}var N=function(e){var t,n,o,i,r,c,s;const N=Object(a.useRef)(null),D=Object(a.useRef)(null),k=Object(a.useRef)(null),A=Object(a.useState)({x:5e3,y:5e3}),I=Object(d.a)(A,2),W=I[0],z=I[1],R=Object(a.useState)({x:0,y:0}),T=Object(d.a)(R,2),L=T[0],Y=T[1],B=Object(a.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),F=Object(d.a)(B,2),P=F[0],Z=F[1],G=Object(a.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),J=Object(d.a)(G,2),X=J[0],K=J[1],Q=Object(a.useState)({x:-1,y:-1}),U=Object(d.a)(Q,2),_=U[0],V=U[1],q=Object(a.useState)(""),$=Object(d.a)(q,2),ee=$[0],te=$[1],ne=Object(a.useState)(""),ae=Object(d.a)(ne,2),le=ae[0],oe=ae[1],ie=Object(a.useState)(!1),re=Object(d.a)(ie,2),ce=re[0],se=re[1],de=Object(a.useState)(!1),ue=Object(d.a)(de,2),he=ue[0],ye=ue[1],fe=Object(a.useState)(!1),me=Object(d.a)(fe,2),xe=me[0],ge=me[1],ve=Object(a.useState)(!1),pe=Object(d.a)(ve,2),be=pe[0],we=pe[1],Ee=Object(a.useState)(null),Ce=Object(d.a)(Ee,2),je=Ce[0],Oe=Ce[1],Se=Object(a.useState)(null),He=Object(d.a)(Se,2),Me=He[0],Ne=He[1],De=Object(a.useState)(!1),ke=Object(d.a)(De,2),Ae=ke[0],Ie=ke[1],We=Object(a.useState)(!1),ze=Object(d.a)(We,2),Re=ze[0],Te=ze[1],Le=Object(a.useState)({x:-1,y:-1,hitTarget:null}),Ye=Object(d.a)(Le,2),Be=Ye[0],Fe=Ye[1],Pe=Object(y.a)({ref:N}),Ze=Pe.width,Ge=void 0===Ze?3e3:Ze,Je=Pe.height,Xe=void 0===Je?3e3:Je,Ke=Object(a.useMemo)(()=>v(e.cellWidth,100),[e.cellWidth]),Qe=Object(a.useMemo)(()=>v(e.cellHeight,22),[e.cellHeight]),Ue=Object(a.useMemo)(()=>v(e.columnHeaders,null),[e.columnHeaders]),_e=Object(a.useMemo)(()=>v(e.columnHeaderStyle,{}),[e.columnHeaderStyle]),Ve=Object(a.useMemo)(()=>p(e.readOnly,!1),[e.readOnly]),qe=Object(a.useMemo)(()=>p(e.sourceData,null),[e.sourceData]),$e=Object(a.useMemo)(()=>p(e.displayData,""),[e.displayData]),et=Object(a.useMemo)(()=>p(e.editData,""),[e.editData]),tt=Object(a.useMemo)(()=>p(e.editKeys,""),[e.editKeys]),nt=Object(a.useMemo)(()=>p(e.cellStyle,m),[e.cellStyle]),at=Object(a.useMemo)(()=>{var t,n,a,l,o,i,r,c;return{freezeColumns:(null===(t=e.sheetStyle)||void 0===t?void 0:t.freezeColumns)||0,freezeRows:(null===(n=e.sheetStyle)||void 0===n?void 0:n.freezeRows)||0,hideColumnHeaders:(null===(a=e.sheetStyle)||void 0===a?void 0:a.hideColumnHeaders)||!1,hideRowHeaders:(null===(l=e.sheetStyle)||void 0===l?void 0:l.hideRowHeaders)||!1,hideGridlines:(null===(o=e.sheetStyle)||void 0===o?void 0:o.hideGridlines)||!1,columnHeaderHeight:null!==(i=e.sheetStyle)&&void 0!==i&&i.hideColumnHeaders?1:22,rowHeaderWidth:null!==(r=e.sheetStyle)&&void 0!==r&&r.hideRowHeaders?1:50,hideScrollBars:(null===(c=e.sheetStyle)||void 0===c?void 0:c.hideScrollBars)||!1}},[null===(t=e.sheetStyle)||void 0===t?void 0:t.freezeColumns,null===(n=e.sheetStyle)||void 0===n?void 0:n.freezeRows,null===(o=e.sheetStyle)||void 0===o?void 0:o.hideColumnHeaders,null===(i=e.sheetStyle)||void 0===i?void 0:i.hideGridlines,null===(r=e.sheetStyle)||void 0===r?void 0:r.hideRowHeaders,null===(c=e.sheetStyle)||void 0===c?void 0:c.hideScrollBars]);Object(a.useEffect)(()=>{(tt?tt(_.x,_.y):"")!==le&&(V({x:-1,y:-1}),oe(""))},[tt]);const lt=Object(a.useMemo)(()=>E(at.freezeColumns,Ke,at.rowHeaderWidth,L.x,Ge),[at,Ke,L.x,Ge]),ot=Object(a.useMemo)(()=>E(at.freezeRows,Qe,at.columnHeaderHeight,L.y,Xe),[at,Qe,L.y,Xe]);Object(a.useEffect)(()=>{e.onScrollChange&&e.onScrollChange([...ot.index],[...lt.index])},[ot,lt,e.onScrollChange]);const it=(t,n,a,l,o=!0)=>{if(P.x1===t&&P.x2===a&&P.y1===n&&P.y2===l||Z({x1:t,y1:n,x2:a,y2:l}),o){const e={x:L.x,y:L.y};let t=-1,n=-1;if(-1!==a&&(!lt.index.includes(a)||lt.index[lt.index.length-1]===a)){const n=lt.index[lt.index.length-1],l=lt.index[at.freezeColumns];let o=0;a>=n?o=1+a-n:a<l&&(o=a-l);const i=Math.max(L.x,at.freezeColumns)+o;e.x=i,t=30*i}if(-1!==l&&(!ot.index.includes(l)||ot.index[ot.index.length-1]===l)){const t=ot.index[at.freezeRows],a=ot.index[ot.index.length-1];let o=0;l>=a?o=1+l-a:l<t&&(o=l-t);const i=Math.max(L.y,at.freezeRows)+o;e.y=i,n=30*i}if(e.x!==L.x||L.y!==e.y){Y({x:e.x,y:e.y});const a=Object(u.a)({},W);a.x=Math.max(a.x,t),a.y=Math.max(a.y,n),z(a),setTimeout(()=>{D.current&&(-1!==t&&(D.current.scrollLeft=t),-1!==n&&(D.current.scrollTop=n))},0)}}if(e.onSelectionChanged){let o=t,i=n,r=a,c=l;o>r&&(o=a,r=t),i>c&&(i=l,c=n),e.onSelectionChanged(o,i,r,c)}},rt=Object(a.useMemo)(()=>{if(-1===P.x1&&-1===P.x2&&-1!==P.y1&&-1!==P.y2){let e=P.y2;P.y1>P.y2&&(e=P.y1);const t=H(0,e,ot,lt,L,Ke,Qe,at);return{x:t.x+3,y:t.y+Qe(e)}}if(-1!==P.x1&&-1!==P.x2&&-1===P.y1&&-1===P.y2){let e=P.x2;P.x1>P.x2&&(e=P.x1);const t=H(e,0,ot,lt,L,Ke,Qe,at);return{x:t.x+Ke(e),y:t.y+3}}if(-1!==P.x2&&-1!==P.y2){let e=P.x2;P.x1>P.x2&&(e=P.x1);let t=P.y2;P.y1>P.y2&&(t=P.y1);const n=H(e,t,ot,lt,L,Ke,Qe,at);return{x:n.x+Ke(e),y:n.y+Qe(t)}}return{x:-1,y:-1}},[P,ot,lt,L,Ke,Qe,at]),ct=Object(a.useMemo)(()=>{const e={},t=N.current;if(!t)return e;g(t);let n=at.columnHeaderHeight,a=at.rowHeaderWidth;var l,o=Object(h.a)(lt.index);try{for(o.s();!(l=o.n()).done;){const t=l.value,n=Ue(t),o=Ke(t);if(n&&"object"===typeof n&&n.items){let l;var i,r=Object(h.a)(n.items);try{for(r.s();!(i=r.n()).done;){const n=i.value;if(n.onClick){l||(l=C(_e(t),m));const i=b(a,o,l,n.content instanceof HTMLImageElement?n.width||o:0,n.horiozntalAlign)+n.x,r=.5*at.columnHeaderHeight+n.y,c=i+(n.width||0),s=r+(n.height||0),d={x:i,y:r,w:n.width,h:n.height,onClick:n.onClick},u=Math.floor(i/10),h=Math.floor(c/10),y=Math.floor(r/10),f=Math.floor(s/10);for(let t=u;t<=h;t++){e[t]||(e[t]={});const n=e[t];for(let e=y;e<=f;e++)n[e]||(n[e]=[]),n[e].push(d)}}}}catch(x){r.e(x)}finally{r.f()}}a+=o}}catch(x){o.e(x)}finally{o.f()}var c,s=Object(h.a)(ot.index);try{for(s.s();!(c=s.n()).done;){const t=c.value;a=at.rowHeaderWidth;var d,u=Object(h.a)(lt.index);try{for(u.s();!(d=u.n()).done;){const l=d.value,o=$e(l,t),i=Ke(l);if(null===o||void 0===o){a+=i;continue}const r=a,c=n+.5*Qe(t);if("object"===typeof o&&o.items){let n;var y,f=Object(h.a)(o.items);try{for(f.s();!(y=f.n()).done;){const a=y.value;if(a.onClick){n||(n=C(nt(l,t),m));const o=b(r,i,n,a.content instanceof HTMLImageElement?a.width||i:0,a.horiozntalAlign)+a.x,s=c+a.y,d=o+(a.width||0),u=s+(a.height||0),h={x:o,y:s,w:a.width,h:a.height,onClick:a.onClick},y=Math.floor(o/10),f=Math.floor(d/10),x=Math.floor(s/10),g=Math.floor(u/10);for(let t=y;t<=f;t++){e[t]||(e[t]={});const n=e[t];for(let e=x;e<=g;e++)n[e]||(n[e]=[]),n[e].push(h)}}}}catch(x){f.e(x)}finally{f.f()}}a+=i}}catch(x){u.e(x)}finally{u.f()}n+=Qe(t)}}catch(x){s.e(x)}finally{s.f()}return e},[$e,e.cellWidth,e.cellHeight,N,lt,ot,L.x,L.y,at]);Object(a.useEffect)(()=>{const t=N.current;if(!t)return;const n=t.getContext("2d");if(!n)return;let a=window.requestAnimationFrame(()=>{!function(e,t,n,a,l,o,i,r,c,s,y,f,v,p,b,E){g(e.canvas),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.fillRect(0,0,e.canvas.width,e.canvas.height);let C=E.columnHeaderHeight;var O,M=Object(h.a)(t.index);try{for(M.s();!(O=M.n()).done;){const t=O.value;let i=E.rowHeaderWidth;var N,D=Object(h.a)(n.index);try{for(D.s();!(N=D.n()).done;){const n=N.value,r=a(n,t);r.fillColor&&(e.fillStyle=r.fillColor,e.fillRect(i,C,l(n),o(t))),i+=l(n)}}catch(se){D.e(se)}finally{D.f()}C+=o(t)}}catch(se){M.e(se)}finally{M.f()}let k=!1;const A=S(i),I=Object(d.a)(A,4),W=I[0],z=I[1],R=I[2],T=I[3],L=-1!==W&&-1!==R||-1!==z&&-1!==T,Y=-1===W&&-1===R&&-1!==z&&-1!==T,B=-1!==W&&-1!==R&&-1===z&&-1===T,F=H(W,z,t,n,p,l,o,E),P=H(R,T,t,n,p,l,o,E);if(P.x+=l(R),P.y+=o(T),F.x>=P.x){P.x=F.x;let e=W;for(;n.index.includes(e);)P.x+=l(e),e++;k=!0}if(F.y>=P.y){P.y=F.y;let e=z;for(;t.index.includes(e);)P.y+=o(e),e++;k=!0}if(L)if(e.fillStyle="#e9f0fd",Y){const t=Math.max(-100,F.x);e.fillRect(t,F.y,1e5,P.y-F.y)}else if(B){const t=Math.max(0,F.y);e.fillRect(F.x,t,P.x-F.x,1e5)}else e.fillRect(F.x,F.y,P.x-F.x,P.y-F.y);E.hideRowHeaders||(e.fillStyle="#f8f9fa",e.fillRect(0,0,E.rowHeaderWidth,e.canvas.height),L&&(e.fillStyle="#e8eaed",e.fillRect(0,F.y,E.rowHeaderWidth,P.y-F.y))),E.hideColumnHeaders||(e.fillStyle="#f8f9fa",e.fillRect(0,0,e.canvas.width,E.columnHeaderHeight),L&&(e.fillStyle="#e8eaed",e.fillRect(F.x,0,P.x-F.x,E.columnHeaderHeight))),e.strokeStyle="#e2e3e3",e.lineWidth=1;let Z=E.rowHeaderWidth,G=E.columnHeaderHeight,J=!0;const X=E.hideGridlines?E.columnHeaderHeight:e.canvas.height;var K,Q=Object(h.a)(n.index);try{for(Q.s();!(K=Q.n()).done;){const t=K.value;e.beginPath(),e.moveTo(Z,0),J?(E.hideRowHeaders||e.lineTo(Z,e.canvas.height),J=!1):e.lineTo(Z,X),e.stroke(),Z+=l(t)}}catch(se){Q.e(se)}finally{Q.f()}const U=E.hideGridlines?E.rowHeaderWidth:e.canvas.width;J=!0;var _,V=Object(h.a)(t.index);try{for(V.s();!(_=V.n()).done;){const t=_.value;e.beginPath(),e.moveTo(0,G),J?(E.hideColumnHeaders||e.lineTo(e.canvas.width,G),J=!1):e.lineTo(U,G),e.stroke(),G+=o(t)}}catch(se){V.e(se)}finally{V.f()}if(!E.hideRowHeaders){G=E.columnHeaderHeight,e.textBaseline="middle",e.textAlign="center",e.font=m.fontSize+"px "+m.fontFamily,e.fillStyle="#666666";var q,$=Object(h.a)(t.index);try{for($.s();!(q=$.n()).done;){const t=q.value,n=t+1;let a={};Y&&z<=t&&T>=t&&(a=Object(u.a)(Object(u.a)({},a),{},{backgroundColor:"#cccccc"})),w(e,""+n,a,x,0,G,E.rowHeaderWidth,o(t)),G+=o(t)}}catch(se){$.e(se)}finally{$.f()}}if(!E.hideColumnHeaders){Z=E.rowHeaderWidth,e.textBaseline="middle",e.textAlign="center";var ee,te=Object(h.a)(n.index);try{for(te.s();!(ee=te.n()).done;){const t=ee.value,n=l(t),a=s(t),o=null!==a?a:j(t+1);let i=y(t);B&&W<=t&&R>=t&&(i=Object(u.a)(Object(u.a)({},i),{},{backgroundColor:"#cccccc"})),w(e,o,i,x,Z,0,n,E.columnHeaderHeight),Z+=n}}catch(se){te.e(se)}finally{te.f()}}if(L){if(e.strokeStyle="#1b73e7",e.lineWidth=1,e.beginPath(),Y){const t=Math.max(-100,F.x);e.rect(t,F.y,1e5,P.y-F.y)}else if(B){const t=Math.max(-100,F.y);e.rect(F.x,t,P.x-F.x,1e5)}else e.rect(F.x,F.y,P.x-F.x,P.y-F.y);e.stroke()}var ne,ae=Object(h.a)(r);try{for(ae.s();!(ne=ae.n()).done;){const a=ne.value,i=S(a.span),r=Object(d.a)(i,4),c=r[0],s=r[1],u=r[2],h=r[3];if(!(-1!==c&&-1!==u||-1!==s&&-1!==h))continue;const y=-1===c&&-1===u&&-1!==s&&-1!==h,f=-1!==c&&-1!==u&&-1===s&&-1===h,m=H(c,s,t,n,p,l,o,E),x=H(u,h,t,n,p,l,o,E);if(x.x+=l(u),x.y+=o(h),m.x>=x.x){x.x=m.x;let e=c;for(;n.index.includes(e);)x.x+=l(e),e++}if(m.y>=x.y){x.y=m.y;let e=s;for(;t.index.includes(e);)x.y+=o(e),e++}if(e.strokeStyle=a.color,e.lineWidth=1,e.beginPath(),y){const t=Math.max(-100,m.x);e.rect(t,m.y,1e5,x.y-m.y)}else if(f){const t=Math.max(-100,m.y);e.rect(m.x,t,x.x-m.x,1e5)}else e.rect(m.x,m.y,x.x-m.x,x.y-m.y);e.stroke()}}catch(se){ae.e(se)}finally{ae.f()}if(c){let a=f.x1,i=f.x2;f.x1>f.x2&&(a=f.x2,i=f.x1);let r=f.y1,c=f.y2;f.y1>f.y2&&(r=f.y2,c=f.y1);const s=H(a,r,t,n,p,l,o,E),d=H(i+1,c+1,t,n,p,l,o,E);e.strokeStyle="#707070",e.setLineDash([3,3]),e.lineWidth=1,e.beginPath(),Y?e.rect(s.x,s.y-1,1e5,d.y-s.y):B?e.rect(s.x,s.y-1,d.x-s.x,1e5):e.rect(s.x,s.y-1,d.x-s.x,d.y-s.y),e.stroke(),e.setLineDash([])}L&&!k&&(e.fillStyle="#1b73e7",e.fillRect(b.x-3,b.y-3,6,6)),e.textBaseline="middle";let le=E.columnHeaderHeight;var oe,ie=Object(h.a)(t.index);try{for(ie.s();!(oe=ie.n()).done;){const t=oe.value;let i=E.rowHeaderWidth;const r=o(t);var re,ce=Object(h.a)(n.index);try{for(ce.s();!(re=ce.n()).done;){const n=re.value,o=v(n,t),c=l(n);if(null!==o&&void 0!==o){w(e,o,a(n,t),m,i,le,c,r)}i+=c}}catch(se){ce.e(se)}finally{ce.f()}le+=r}}catch(se){ie.e(se)}finally{ie.f()}}(n,ot,lt,nt,Ke,Qe,P,e.secondarySelections||[],xe,Ue,_e,X,$e,L,rt,at)});return()=>{window.cancelAnimationFrame(a)}},[N,ot,lt,nt,Ke,Qe,P,e.secondarySelections,xe,Ue,_e,X,$e,L,rt,at]);const st=()=>{k.current&&(k.current.focus({preventScroll:!0}),k.current.select())};Object(a.useEffect)(()=>{pt||ft()},[P,et]),Object(a.useEffect)(()=>{if(!pt)if(document.activeElement===k.current)st();else{const e=document.activeElement.tagName.toLowerCase();"div"===e&&"true"===document.activeElement.contentEditable||"input"===e||"textarea"===e||"select"===e||st()}});const dt=e=>{if(!k)return;if(e.target!==k.current)return;e.preventDefault();const t=e.clipboardData||window.clipboardData,n=t.types;if(n.includes("text/html")){const e=t.getData("text/html");ht(e)}else if(n.includes("text/plain")){const e=t.getData("text/plain");yt(e)}};Object(a.useEffect)(()=>(window.document.addEventListener("paste",dt),()=>{window.document.removeEventListener("paste",dt)}));const ut=e=>{var t,n=Object(h.a)(e.children);try{for(n.s();!(t=n.n()).done;){const e=t.value;if("TABLE"===e.nodeName)return e;const n=ut(e);if(n)return n}}catch(a){n.e(a)}finally{n.f()}},ht=t=>{const n=document.createElement("div");n.innerHTML=t.trim();let a=-1,l=-1;if(-1!==P.x1&&-1===P.x2&&(a=P.x1),-1!==P.y1&&-1===P.y2&&(l=P.y1),-1!==P.x1&&-1!==P.x2&&(a=Math.min(P.x1,P.x2)),-1!==P.y1&&-1!==P.y2&&(l=Math.min(P.y1,P.y2)),-1===a||-1===l)return;let o=a,i=l;const r=[],c=ut(n);if(!c)return;var s,d=Object(h.a)(c.children);try{for(d.s();!(s=d.n()).done;){const e=s.value;if("TBODY"===e.nodeName){var u,y=Object(h.a)(e.children);try{for(y.s();!(u=y.n()).done;){const e=u.value;if(o=a,"TR"===e.nodeName){var f,m=Object(h.a)(e.children);try{for(m.s();!(f=m.n()).done;){const e=f.value;if("TD"===e.nodeName){let t="";if(0!==e.children.length&&"P"===e.children[0].nodeName){const n=e.children[0];t=0!==n.children.length&&"FONT"===n.children[0].nodeName?n.children[0].textContent.trim():n.textContent.trim()}else t=e.textContent.trim();t=t.replaceAll("\n",""),t=t.replaceAll(/\s\s+/g," "),r.push({y:i,x:o,value:t}),o++}}}catch(x){m.e(x)}finally{m.f()}i++}}}catch(x){y.e(x)}finally{y.f()}}}}catch(x){d.e(x)}finally{d.f()}e.onChange&&e.onChange(r),it(a,l,o-1,i-1,!1)},yt=t=>{let n=-1,a=-1;if(-1!==P.x1&&-1===P.x2&&(n=P.x1),-1!==P.x1&&-1!==P.x2&&(n=Math.min(P.x1,P.x2)),-1===P.x1&&-1===P.x2&&-1!==P.y1&&-1!==P.y2&&(n=0),-1!==P.y1&&-1===P.y2&&(a=P.y1),-1!==P.y1&&-1!==P.y2&&(a=Math.min(P.y1,P.y2)),-1===P.y1&&-1===P.y2&&-1!==P.x2&&-1!==P.x2&&(a=0),-1===n||-1===a)return;const l=t.split(/\r?\n/);let o=n,i=a+l.length-1;const r=[];for(let e=0;e<l.length;e++){const t=l[e].split("\t");n+t.length-1>o&&(o=n+t.length-1);for(let l=0;l<t.length;l++)r.push({y:a+e,x:n+l,value:t[l]})}e.onChange&&e.onChange(r),it(n,a,o,i,!1)},ft=()=>{if(-1===P.x1&&-1===P.y1&&-1===P.x2&&-1===P.y2)return;let e=P.y1,t=P.y2;e>t&&(e=P.y2,t=P.y1);let n=P.x1,a=P.x2;if(n>a&&(n=P.x2,a=P.x1),-1===n&&-1===a){n=0,a=M(et).x}if(-1===e&&-1===t){e=0,t=M(et).y}let l="",o="";for(let i=e;i<=t;i++){let e=!1;for(let t=n;t<=a;t++){const n=et(t,i);null!==n&&void 0!==n&&(o+=n,e=!0),t!==a&&(o+="\t")}i!==t&&(o+="\n"),e&&(l+=o,o="")}k.current&&(k.current.value=l)},mt=t=>{e.onChange&&e.onChange([{x:_.x,y:_.y,value:void 0!==t?t:ee}]),V({x:-1,y:-1}),oe("")},xt=e=>{if(Ve(e.x,e.y))return;const t=et(e.x,e.y);let n="";null!==t&&void 0!==t&&(n=t);const a=tt?tt(e.x,e.y):"";V(e),oe(a),te(n),ye(!1)},gt=t=>{if(xe){let t=P.x1,n=P.x2;P.x1>P.x2&&(t=P.x2,n=P.x1);let a=P.y1,l=P.y2;P.y1>P.y2&&(a=P.y2,l=P.y1);let o=X.x1,i=X.x2;X.x1>X.x2&&(o=X.x2,i=X.x1);let r=X.y1,c=X.y2;X.y1>X.y2&&(r=X.y2,c=X.y1);let s=o,d=r,u=i,h=c;const y=[];if(u-s===n-t){if(d===a?d=l+1:h=a-1,-1===s&&-1===u){const e=M(et);s=0,u=e.x}let e=a;for(let t=d;t<=h;t++){for(let n=s;n<=u;n++){const a=qe(n,e);y.push({x:n,y:t,value:a,source:{x:n,y:e}})}e+=1,e>l&&(e=a)}}else{if(s===t?s=n+1:u=t-1,-1===d&&-1===h){const e=M(et);d=0,h=e.y}let e=t;for(let a=s;a<=u;a++){for(let t=d;t<=h;t++){const n=qe(e,t);y.push({x:a,y:t,value:n,source:{x:e,y:t}})}e+=1,e>n&&(e=t)}}e.onChange&&e.onChange(y),it(X.x1,X.y1,X.x2,X.y2)}if(we(!1),Ie(!1),Te(!1),ge(!1),Oe(null),Ne(null),-1!==Be.x&&-1!==Be.y&&null!==Be.hitTarget){if(!t.target||!(t.target instanceof Element))return;const e=t.target.getBoundingClientRect(),n=t.clientX-e.left,a=t.clientY-e.top,l=Be.hitTarget;l.x<=n&&n<=l.x+l.w&&l.y<=a&&a<=l.y+l.h&&l.onClick(t),Fe({x:-1,y:-1,hitTarget:null})}};Object(a.useEffect)(()=>(window.addEventListener("mouseup",gt),()=>{window.removeEventListener("mouseup",gt)}));const vt=t=>{if(!t.target||!(t.target instanceof Element))return;const n=t.target.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;window.document.body.style.cursor="auto";const o=Math.floor(a/10),i=Math.floor(l/10);if(ct[o]&&ct[o][i]){var r,c=Object(h.a)(ct[o][i]);try{for(c.s();!(r=c.n()).done;){const e=r.value;e.x<=a&&a<=e.x+e.w&&e.y<=l&&l<=e.y+e.h&&(window.document.body.style.cursor="pointer")}}catch(f){c.e(f)}finally{c.f()}}if(!at.hideColumnHeaders&&e.onCellWidthChange&&l<at.columnHeaderHeight){let e=at.rowHeaderWidth;var s,d=Object(h.a)(lt.index);try{for(d.s();!(s=d.n()).done;){const t=s.value;if(Math.abs(e-a)<4){window.document.body.style.cursor="col-resize";break}e+=Ke(t)}}catch(f){d.e(f)}finally{d.f()}}if(!at.hideRowHeaders&&e.onCellHeightChange&&a<at.rowHeaderWidth){let e=at.columnHeaderHeight;var u,y=Object(h.a)(ot.index);try{for(y.s();!(u=y.n()).done;){const t=u.value;if(Math.abs(e-l)<4){window.document.body.style.cursor="row-resize";break}e+=Qe(t)}}catch(f){y.e(f)}finally{y.f()}}if(Math.abs(a-rt.x)<6&&Math.abs(l-rt.y)<6&&(window.document.body.style.cursor="crosshair"),je){if(e.onCellWidthChange){const t=Math.max(je.oldWidth+a-je.startX,50);e.onCellWidthChange(je.colIndices,t)}}else if(Me){if(e.onCellHeightChange){const t=Math.max(Me.oldHeight+l-Me.startY,22);e.onCellHeightChange(Me.rowIndices,t)}}else{if(be){const e=O(a,l,ot,lt);Ae?it(-1,P.y1,-1,e.y,!1):Re?it(P.x1,-1,e.x,-1,!1):it(P.x1,P.y1,e.x,e.y)}if(xe){window.document.body.style.cursor="crosshair";const e=O(a,l,ot,lt);let t=P.x1,n=P.y1,o=P.x2,i=P.y2;t>o&&(t=P.x2,o=P.x1),n>i&&(n=P.y2,i=P.y1);let r=0;e.x<t&&(r=e.x-t),e.x>o&&(r=o-e.x);let c=0;e.y<n&&(c=e.y-n),e.y>i&&(c=i-e.y),-1===t&&-1===o||r>c?e.y<n?n=e.y:i=e.y:e.x<t?t=e.x:o=e.x,K({x1:t,y1:n,x2:o,y2:i})}}},pt=-1!==_.x&&-1!==_.y;let bt={x:0,y:0},wt=0,Et=0,Ct="right";if(pt){bt=H(_.x,_.y,ot,lt,L,Ke,Qe,at);const e=nt(_.x,_.y);bt.x+=1,bt.y+=1,wt=Ke(_.x)-2,Et=Qe(_.y)-2,Ct=e.textAlign||m.textAlign||"left"}const jt={value:ee,autoFocus:!0,onKeyDown:e=>{if("Escape"===e.key)return V({x:-1,y:-1}),void oe("");if("Enter"===e.key&&(mt(),it(P.x1,P.y1+1,P.x1,P.y1+1)),"Tab"===e.key&&(e.preventDefault(),mt(),it(P.x1+1,P.y1,P.x1+1,P.y1)),ce&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e.key)){e.preventDefault(),mt();let t=P.x1,n=P.y1,a=P.x1,l=P.y1;"ArrowRight"===e.key?(t=P.x1+1,a=P.x1+1):"ArrowLeft"===e.key?(t=P.x1-1,a=P.x1-1):"ArrowUp"===e.key?(n=P.y1-1,l=P.y1-1):"ArrowDown"===e.key&&(n=P.y1+1,l=P.y1+1),it(t,n,a,l)}},style:{position:"absolute",top:bt.y,left:bt.x,width:wt,height:Et,outline:"none",border:"none",textAlign:Ct,color:"black",fontSize:m.fontSize,fontFamily:"sans-serif"}},Ot=null===(s=e.inputComponent)||void 0===s?void 0:s.call(e,_.x,_.y,Object(u.a)(Object(u.a)({},jt),{},{onChange:te}),mt);let St=f;const Ht={position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",borderBottom:"1px solid #ddd"},Mt={width:"calc(100% - 14px)",height:"calc(100% - 15px)",outline:"1px solid #ddd"};return at.hideScrollBars&&(delete Mt.outline,delete Ht.borderBottom,St="",Mt.width="calc(100%)"),l.a.createElement("div",{style:{position:"relative",height:"100%"}},l.a.createElement("canvas",{style:Mt,ref:N}),l.a.createElement("div",{ref:D,onDoubleClick:e=>{if(e.preventDefault(),!e.target||!(e.target instanceof Element)||he)return;const t=e.target.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top,l=Math.floor(n/10),o=Math.floor(a/10);if(ct[l]&&ct[l][o]){var i,r=Object(h.a)(ct[l][o]);try{for(r.s();!(i=r.n()).done;){const e=i.value;if(e.x<=n&&n<=e.x+e.w&&e.y<=a&&a<=e.y+e.h)return}}catch(s){r.e(s)}finally{r.f()}}const c=O(n,a,ot,lt);se(!1),pt&&mt(),xt(c)},onMouseDown:t=>{if(0!==t.button)return;if(!t.target||!(t.target instanceof Element))return;we(!1);const n=t.target.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;if(a>Ge||l>Xe)return;const o=Math.floor(a/10),i=Math.floor(l/10);if(ct[o]&&ct[o][i]){var r,c=Object(h.a)(ct[o][i]);try{for(c.s();!(r=c.n()).done;){const e=r.value;if(e.x<=a&&a<=e.x+e.w&&e.y<=l&&l<=e.y+e.h)return void Fe({x:a,y:l,hitTarget:e})}}catch(f){c.e(f)}finally{c.f()}}if(!at.hideColumnHeaders&&l<at.columnHeaderHeight)for(let e=0;e<lt.index.length;e++){const t=lt.start[e],n=lt.end[e],l=lt.index[e];if(Math.abs(t-a)<4||Math.abs(n-a)<4){window.document.body.style.cursor="col-resize";const e=[];if(-1!==P.x1&&-1!==P.x2&&-1===P.y1&&-1===P.y2){const t=Math.min(P.x1,P.x2),n=Math.max(P.x1,P.x2);for(let a=t;a<=n;a++)e.push(a)}return 0===e.length&&e.push(l),void Oe({startX:n,oldWidth:Ke(l),colIndices:e})}}if(!at.hideRowHeaders&&a<at.rowHeaderWidth)for(let e=0;e<ot.index.length;e++){const t=ot.start[e],n=ot.end[e],a=ot.index[e];if(Math.abs(t-l)<4||Math.abs(n-l)<4){window.document.body.style.cursor="row-resize";const e=[];if(-1===P.x1&&-1===P.x2&&-1!==P.y1&&-1!==P.y2){const t=Math.min(P.y1,P.y2),n=Math.max(P.y1,P.y2);for(let a=t;a<=n;a++)e.push(a)}return 0===e.length&&e.push(a),void Ne({startY:n,oldHeight:Qe(a),rowIndices:e})}}if(Math.abs(a-rt.x)<6&&Math.abs(l-rt.y)<6)return ge(!0),void K({x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2});const s=O(a,l,ot,lt),d=he?{x:P.x1,y:P.y1}:Object(u.a)({},s);pt&&(e.dontCommitEditOnSelectionChange||mt());let y=!0;!at.hideRowHeaders&&a<at.rowHeaderWidth?(y=!1,Ie(!0),d.x=-1,s.x=-1):Ie(!1),!at.hideColumnHeaders&&l<at.columnHeaderHeight?(y=!1,Te(!0),d.y=-1,s.y=-1):Te(!1),we(!0),it(d.x,d.y,s.x,s.y,y),e.dontCommitEditOnSelectionChange||(V({x:-1,y:-1}),oe(""))},onMouseMove:vt,onMouseLeave:()=>{window.document.body.style.cursor="auto"},onContextMenu:t=>{var n;if(!t.target||!(t.target instanceof Element))return;const a=t.target.getBoundingClientRect(),l=t.clientX-a.left,o=t.clientY-a.top,i=O(l,o,ot,lt),r=i.x,c=i.y;let s=P.x1,d=P.x2,h=P.y1,y=P.y2;if(s>d){var f=[d,s];s=f[0],d=f[1]}if(h>y){var m=[y,h];h=m[0],y=m[1]}if(!(o>at.columnHeaderHeight&&l>at.rowHeaderWidth))return;r>=s&&r<=d&&c>=h&&c<=y||it(r,c,r,c),vt(t);const x=Object(u.a)(Object(u.a)({},t),{},{cellX:r,cellY:c});null===(n=e.onRightClick)||void 0===n||n.call(e,x)},onScroll:e=>{if(!e.target||!(e.target instanceof Element))return;const t=e.target.scrollLeft,n=e.target.scrollTop,a=Math.floor(t/30),l=Math.floor(n/30);a===L.x&&l===L.y||Y({x:a,y:l});let o=Object(u.a)({},W);W.x/(t+.5)<1&&(o.x*=1.5),W.y/(n+.5)<1&&(o.y*=1.5),o.x===W.x&&W.y===o.y||z(Object(u.a)({},o))},className:St,style:Ht},l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:W.y+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:W.x+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}})),l.a.createElement("textarea",{style:{position:"absolute",top:0,left:0,width:1,height:1,opacity:.01},ref:k,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onFocus:e=>e.target.select(),tabIndex:0,onKeyDown:t=>{if(pt&&ce&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key))mt();else if("Shift"!==t.key){if((!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())&&(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase()))if("Backspace"!==t.key&&"Delete"!==t.key){if(-1!==P.x1&&-1!==P.x2&&-1!==P.y1&&-1!==P.y2){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key)return Ve(P.x1,P.y1)?void t.preventDefault():(xt({x:P.x1,y:P.y1}),void se("Enter"!==t.key));if(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key)){let e={x:P.x1,y:P.y1},n={x:P.x2,y:P.y2},a={x:0,y:0},l="right";if("ArrowRight"===t.key||"Tab"===t.key?(a.x=1,l="right"):"ArrowLeft"===t.key?(a.x=-1,l="left"):"ArrowUp"===t.key?(a.y=-1,l="up"):"ArrowDown"===t.key&&(a.y=1,l="down"),t.metaKey||t.ctrlKey){const e=function(e,t,n){let a=Object(u.a)({},t),l={x:0,y:0};"up"===n?l.y=-1:"down"===n?l.y=1:"left"===n?l.x=-1:"right"===n&&(l.x=1);const o=65536,i=65536;a.x>o&&(a.x=o),a.y>i&&(a.y=i);const r=e(a.x+l.x,a.y+l.y),c=""!==r&&null!==r&&void 0!==r;for(c||(a.x+=l.x,a.y+=l.y);a.x<=o&&a.y<=i&&a.x>=0&&a.y>=0;){const t=e(a.x,a.y);if(c&&(""===t||null===t||void 0===t))return{x:a.x-l.x,y:a.y-l.y};if(!c&&""!==t&&null!==t&&void 0!==t)return Object(u.a)({},a);a.x+=l.x,a.y+=l.y}return a}($e,n,l);a.x=e.x-n.x,a.y=e.y-n.y}return n.x+=a.x,n.y+=a.y,n.x<0&&(n.x=0),n.y<0&&(n.y=0),t.shiftKey||(e=Object(u.a)({},n)),void it(e.x,e.y,n.x,n.y)}t.preventDefault()}}else{let t=P.x1,n=P.y1,a=P.x2,l=P.y2;t>a&&(t=P.x2,a=P.x1),n>l&&(n=P.y2,l=P.y1),-1===t&&-1===a&&-1!==n&&-1!==l&&(t=0,a=65536),-1!==t&&-1!==a&&-1===n&&-1===l&&(n=0,l=65536);const o=[];for(let e=n;e<=l;e++)for(let n=t;n<=a;n++)o.push({x:n,y:e,value:null});e.onChange&&e.onChange(o)}}else ye(!0)},onKeyUp:e=>{ye(e.shiftKey)}}),pt&&(void 0!==Ot?Ot:l.a.createElement("input",Object.assign({},jt,{type:"text",onFocus:e=>e.target.select(),onChange:e=>te(e.target.value)}))))};n(23);const D=[];for(let se=0;se<1e3;se++){const e=[];for(let t=0;t<100;t++)e.push("Row: ".concat(se,", Col: ").concat(t));D.push(e)}const k=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],A=[];for(let se=0;se<1e3;se++){const e=[];for(let t=0;t<100;t++)e.push(1e6*Math.random());A.push(e)}const I=new Image;I.src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=",I.width=10,I.height=10;function W(e=[],t=[]){const n=Object(a.useState)(e),l=Object(d.a)(n,2),o=l[0],i=l[1],r=Object(a.useState)(t),c=Object(d.a)(r,2),s=c[0],u=c[1];return{onCellWidthChange:(e,t)=>{const n=[...o];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;if(e>n.length)for(let t=n.length;t<=e;t++)n.push(100);n[e]=t}}catch(r){l.e(r)}finally{l.f()}i(n)},onCellHeightChange:(e,t)=>{const n=[...s];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;if(e>n.length)for(let t=n.length;t<=e;t++)n.push(22);n[e]=t}}catch(o){l.e(o)}finally{l.f()}u(n)},cellWidth:o,cellHeight:s}}function z(){const e=Object(a.useState)(D),t=Object(d.a)(e,2),n=t[0],o=t[1],i=W(),r=i.onCellWidthChange,c=i.onCellHeightChange,s=i.cellWidth,u=i.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:s,cellHeight:u,onChange:e=>{const t=[...n];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(i){l.e(i)}finally{l.f()}o(t)},readOnly:(e,t)=>!1,onCellWidthChange:r,onCellHeightChange:c}))}function R(){const e=Object(a.useState)(JSON.parse(JSON.stringify(k))),t=Object(d.a)(e,2),n=t[0],o=t[1],i=W(),r=i.onCellWidthChange,c=i.onCellHeightChange,s=i.cellWidth,u=i.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:s,cellHeight:u,onChange:e=>{const t=[...n];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(i){l.e(i)}finally{l.f()}o(t)},readOnly:(e,t)=>!1,onCellWidthChange:r,onCellHeightChange:c}))}const T=new Image;function L(){const e=Object(a.useState)(JSON.parse(JSON.stringify(k))),t=Object(d.a)(e,2),n=t[0],o=t[1],i=W(),r=i.onCellWidthChange,c=i.onCellHeightChange,s=i.cellWidth,u=i.cellHeight,y=["#f00","#0f0","#00f","#000"],f=["left","right","center"],m=["normal","bold","lighter"],x=[0,0,0,0,20];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:e=>0===e?{items:[{content:"A",x:0,y:0,horiozntalAlign:"center"},{content:I,x:0,y:-6,width:12,height:12,horiozntalAlign:"right",onClick:()=>{console.log("click")}}]}:null,cellStyle:(e,t)=>0===e||0===t?{fillColor:"#6DA2FB22",marginRight:10}:{color:y[t%4],textAlign:f[e%3],marginRight:x[e%5],weight:m[t%3]},editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a,l;return 0===e&&t>0&&t<9?{items:[{content:T,x:0,y:-8,width:16,height:16,horiozntalAlign:"right",onClick:()=>{((e,t)=>{const a=[...n];a[t]&&void 0!==a[t][e]&&(a[t][e]+=1),o(a)})(e,t)}},{content:null===n||void 0===n||null===(l=n[t])||void 0===l?void 0:l[e],x:0,y:0,horiozntalAlign:"left"}]}:null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:s,cellHeight:u,onChange:e=>{const t=[...n];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(i){l.e(i)}finally{l.f()}o(t)},readOnly:(e,t)=>!1,onCellWidthChange:r,onCellHeightChange:c,sheetStyle:{freezeColumns:1,freezeRows:1}}))}function Y(){const e=Object(a.useState)(A),t=Object(d.a)(e,2),n=t[0],o=t[1],i=W(),r=i.onCellWidthChange,c=i.onCellHeightChange,s=i.cellWidth,u=i.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a,l,o;return null===n||void 0===n||null===(a=n[t])||void 0===a||null===(l=a[e])||void 0===l||null===(o=l.toFixed)||void 0===o?void 0:o.call(l,2)},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:s,cellHeight:u,onChange:e=>{const t=[...n];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=Number(e.value)}}catch(i){l.e(i)}finally{l.f()}o(t)},readOnly:(e,t)=>!1,onCellWidthChange:r,onCellHeightChange:c}))}function B(){const e=Object(a.useState)("initial"),t=Object(d.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),r=Object(d.a)(i,2),c=r[0],s=r[1],u=W(),y=u.onCellWidthChange,f=u.onCellHeightChange,m=u.cellWidth,x=u.cellHeight;return l.a.createElement(l.a.Fragment,null,"initial"===n?l.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),o("loading"),fetch("./out.json").then(e=>e.json()).then(e=>{s(e),o("done")})}},"Load global database of power plants"):"loading"===n?"Loading...":null,l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{cellStyle:(e,t)=>0===t?{weight:"bold",fontSize:14}:4===e?{textAlign:"right"}:1===e?{weight:"bold",color:"#3b85ff"}:2===e?{color:"#fc3bff"}:{},editData:(e,t)=>{var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n;return 4===e&&t>0?c&&c[t]&&c[t][e]?Number(c[t][e]).toFixed(2):"":null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},cellWidth:m,cellHeight:x,onChange:e=>{const t=[...c];var n,a=Object(h.a)(e);try{for(a.s();!(n=a.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(l){a.e(l)}finally{a.f()}s(t)},readOnly:(e,t)=>!1,onCellWidthChange:y,onCellHeightChange:f,columnHeaderStyle:e=>{const t=(2421*e%255).toString(16).padStart(2,"0"),n=(3215*e%255).toString(16).padStart(2,"0"),a=(1243*e%255).toString(16).padStart(2,"0");return{backgroundColor:"#".concat(t).concat(n).concat(a,"55")}},columnHeaders:e=>""+e,sheetStyle:{freezeColumns:0,freezeRows:1}})))}T.src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==",T.width=16,T.height=16;const F=["First","Second","Third","Fourth","Fifth"],P=["Sixth","Seventh","Eighth","Ninth","Tenth"],Z=[F,P,F,P,F,P,F];function G(){const e=Object(a.useState)(JSON.parse(JSON.stringify(Z))),t=Object(d.a)(e,2),n=t[0],o=t[1],i=W(),r=i.onCellWidthChange,c=i.onCellHeightChange,s=i.cellWidth,u=i.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:s,cellHeight:u,onChange:e=>{const t=[...n];var a,l=Object(h.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(i){l.e(i)}finally{l.f()}o(t)},readOnly:(e,t)=>!1,onCellWidthChange:r,onCellHeightChange:c,inputComponent:J}))}function J(e,t,n,a){return l.a.createElement("div",{style:Object(u.a)(Object(u.a)({},n.style),{},{backgroundColor:"#fff"})},l.a.createElement("div",{style:{border:"1px solid #ddd",boxShadow:"3px 5px 5px #ddd"}},(t%2?P:F).map(e=>l.a.createElement(X,{key:e,opt:e,value:n.value,clickHandler:()=>{a(e)}}))))}function X({opt:e,value:t,clickHandler:n}){const o=Object(a.useState)(!1),i=Object(d.a)(o,2),r=i[0],c=i[1];return l.a.createElement("div",{onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},style:{backgroundColor:t===e||r?"#f6f6f6":"#fff",padding:"5px 10px",cursor:"pointer"},value:e,onClick:()=>n(e)},e)}function K(){const e=Object(a.useState)([[1,2,3],[10,20,30]]),t=Object(d.a)(e,1)[0];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(N,{sourceData:t,displayData:(e,n)=>{var a,l,o;return null===t||void 0===t||null===(a=t[n])||void 0===a||null===(l=a[e])||void 0===l||null===(o=l.toFixed)||void 0===o?void 0:o.call(l,2)}}))}var Q=n(13),U=n.n(Q);var _=function(){const e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(d.a)(t,2),o=n[0],i=n[1];return l.a.createElement("div",{className:"container blue-bg",id:"home"},l.a.createElement("div",{className:"content flex-row header"},l.a.createElement("div",{className:"box text-box"},l.a.createElement("div",null,l.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),l.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",l.a.createElement("br",null),"And it's super fast.")),l.a.createElement("div",{className:"lib-box"},l.a.createElement("div",{className:"install-box",onClick:t=>{e.current.select(),document.execCommand("copy"),t.target.focus(),i("Copied!"),setTimeout(()=>{i("")},1e3)}},l.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==o&&l.a.createElement("div",{className:"copy-success"},o)),l.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",rel:"noopener noreferrer",className:"git-box",target:"_blank"},l.a.createElement("img",{src:U.a,alt:"Git"}),"view on github"))),l.a.createElement("div",{className:"box"},l.a.createElement(z,null))))};var V=function({title:e,id:t}){return l.a.createElement("div",{className:"title-separator",id:t||""},l.a.createElement("p",null,e||"No title"),l.a.createElement("div",{className:"separator"}))};var q=function({children:e}){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"content flex-row"},e))},$=n(235),ee=n(234);ee.a.hljs.padding="10px 20px",ee.a.hljs.background="#f8f9fa",ee.a.hljs.width="100%",ee.a.hljs.maxWidth="100%",ee.a.hljs.overflow="auto",ee.a.hljs.borderRadius="3px",ee.a.hljs.fontSize="14px";function te(){let e=Object(u.a)({},ee.a);return e.hljs.height="100%",l.a.createElement($.a,{language:"javascript",style:e},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);')}function ne(){return l.a.createElement($.a,{language:"javascript",style:ee.a},"import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}")}function ae(){return l.a.createElement($.a,{language:"javascript",style:ee.a},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);')}function le(){return l.a.createElement($.a,{language:"javascript",style:ee.a},'...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);')}function oe(){return l.a.createElement($.a,{language:"javascript",style:ee.a},"...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);")}var ie=function(){return l.a.createElement("div",{className:"footer"},l.a.createElement("p",{className:"copy"},"made by ",l.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};function re({text:e}){return l.a.createElement("span",{className:"emphased"},e)}var ce=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s,null),l.a.createElement(_,null),l.a.createElement(V,{title:"Get started",id:"usage"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width colored-pre",style:{overflowX:"auto"}},l.a.createElement("p",null,"Import the component and its style, and render it"),l.a.createElement(ne,null),l.a.createElement("div",{className:"spacer"}),l.a.createElement("p",null,"Display some data"),l.a.createElement(ae,null))),l.a.createElement(V,{title:"Learn more about features",id:"features"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement(R,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Basic spreadsheet"),l.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize columns and rows."))),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement(L,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Styling"),l.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns, and add clickable images."))),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement(Y,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Formatting"),l.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(V,{title:"Big dataset example",id:"big dataset example"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("p",null,"Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it will be handled blazingly fast and super responsive because component is canvas-based and it draws only the small chunk of data user sees at the moment."),l.a.createElement("br",null),l.a.createElement(B,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(V,{title:"Custom input fields",id:"custom input example"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement(G,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Custom input component"),l.a.createElement("p",null,"If basic text input isn't enough, you can send your own React component to be displayed instead."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(V,{title:"Documentation",id:"documentation"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Displaying data"),l.a.createElement("p",null,"If you have some data you want to display, you send it via ",l.a.createElement(re,{text:"sourceData"})," and"," ",l.a.createElement(re,{text:"displayData"})," props."),l.a.createElement("p",null,"The first one receives unformatted data which is used for data manipulation, and the second one formatted which is used for displaying in cells."),l.a.createElement("br",null),l.a.createElement("p",null,"Each of this can be either array of arrays of values (where each array is representing data for one row) or function (which returns value based on x and y coordinates that are sent as arguments to your function)."))),l.a.createElement(q,null,l.a.createElement("div",{className:"box colored-pre unmargin-pre",style:{maxWidth:"100%",overflow:"auto"}},l.a.createElement(te,null)),l.a.createElement("div",{className:"box"},l.a.createElement(K,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Editing data"),l.a.createElement("p",null,"Same as the previous two, prop ",l.a.createElement(re,{text:"editData"})," can recieve either array of arrays of values or function for data which will be displayed in edit mode. Edit mode is activated by double click on the cell."),l.a.createElement("br",null),l.a.createElement("p",null,"Once edit is done, function sent in ",l.a.createElement(re,{text:"onChange"})," prop will be called with array of changes as an argument. Each element of this array has value, x and y coordinates. Use this information to change values in your data array."),l.a.createElement("br",null),l.a.createElement("p",null,"Sheet also accepts ",l.a.createElement(re,{text:"readOnly"})," prop which you can use if some cells should not be editable. Same as the most of sheet's props, you can send function, array of arrays, or a single value which then is applied to the whole table.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(le,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Column headers"),l.a.createElement("p",null,"By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via"," ",l.a.createElement(re,{text:"columnHeaders"})," prop as an array or function."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Cell style and width/height"),l.a.createElement("p",null,"Use prop ",l.a.createElement(re,{text:"cellStyle"})," and ",l.a.createElement(re,{text:"columnHeaderStyle"})," for customizing cells visually."),l.a.createElement("br",null),l.a.createElement("p",null,"You can also use ",l.a.createElement(re,{text:"cellWidth"})," and ",l.a.createElement(re,{text:"cellHeight"})," props to customize cell size. If you send single value ","cellWidth={200}",", it will be applayed to all cells. If you send array of values ","cellWidth={[200, 80, 80]}",", they will be applied in respect to the index number."),l.a.createElement("br",null),l.a.createElement("p",null,"There are also ",l.a.createElement(re,{text:"onCellWidthChange"})," and ",l.a.createElement(re,{text:"onCellHeightChange"})," ","props for functions which are called when user drags cell for resize. You can use these for updating your cellWidth/cellHeight arrays.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(oe,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Selection"),l.a.createElement("p",null,"You can send function to ",l.a.createElement(re,{text:"onSelectionChanged"})," prop. It will be called on selection change with x1, y1, x2 and y2 arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Right click handler"),l.a.createElement("p",null,"If you send a function to ",l.a.createElement(re,{text:"onRightClick"})," prop, it will be called on right click with whole mouse event (extended with cellX and cellY values) as an argument."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Sticky columns/rows"),l.a.createElement("p",null,"Send a number to ",l.a.createElement(re,{text:"freezeColumns"})," and/or ",l.a.createElement(re,{text:"freezeRows"})," to make first n of columns/rows sticky."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(q,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Custom input"),l.a.createElement("p",null,"By default edit mode turns cell into text edit component. But you can send your custom input component via ",l.a.createElement(re,{text:"inputComponent"})," props. It will be called with"," ",l.a.createElement(re,{text:"x"}),", ",l.a.createElement(re,{text:"y"}),", ",l.a.createElement(re,{text:"inputProps"})," and"," ",l.a.createElement(re,{text:"commitEditingCell"})," arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(ie,null));i.a.render(l.a.createElement(ce,null),document.getElementById("root"))},6:function(e,t,n){}},[[18,1,2]]]);
//# sourceMappingURL=main.a43a27e2.chunk.js.map