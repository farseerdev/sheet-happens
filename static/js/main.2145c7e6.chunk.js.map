{"version":3,"sources":["assets/logo.svg","assets/git.svg","components/Menu.js","../../src/index.tsx","components/SheetBox.js","components/Header.js","components/TitleSeparator.js","components/Wrap.js","components/Code.js","components/Footer.js","App.js","index.js"],"names":["module","exports","Menu","scrollTo","elId","element","document","getElementById","headerOffset","offsetPosition","window","pageYOffset","getBoundingClientRect","top","behavior","className","src","Logo","alt","onClick","defaultCellStyle","textAlign","fontSize","marginRight","marginLeft","color","fontFamily","weight","fillColor","backgroundColor","defaultColumnHeaderStyle","resizeCanvas","canvas","width","height","devicePixelRatio","ratio","newCanvasWidth","Math","newCanvasHeight","context","createRowOrColumnPropFunction","Array","rowOrColIndex","rowColProp","createCellPropFunction","y","cellProp","x","applyAlignment","alignment","style","start","cellSize","imageWidth","drawCell","cellContent","finalStyle","createStyleObject","yy","yCoord","cellHeight","xx","xCoord","cellWidth","obj","finalX","calculateRowsOrColsSizes","visible","end","prev","freezeCount","startingSize","size","ind","startingIndex","index","optionalStyle","excelHeaderString","num","s","t","String","absCoordianteToCell","cellX","cellY","i","columnSizes","absX","rowSizes","absY","cellToAbsCoordinate","indX","dataOffset","indY","props","canvasRef","useRef","overlayRef","copyPasteTextAreaRef","useState","maxScroll","setMaxScroll","setDataOffset","x1","y1","x2","y2","selection","setSelection","knobArea","setKnobArea","editCell","setEditCell","editValue","setEditValue","editKey","setEditKey","arrowKeyCommitMode","setArrowKeyCommitMode","shiftKeyDown","setShiftKeyDown","knobDragInProgress","setKnobDragInProgress","selectionInProgress","setSelectionInProgress","columnResize","setColumnResize","rowResize","setRowResize","rowSelectionInProgress","setRowSelectionInProgress","columnSelectionInProgress","setColumnSelectionInProgress","hitTarget","buttonClickMouseDownCoordinates","setButtonClickMouseDownCoordinates","useResizeObserver","ref","canvasWidth","canvasHeight","freezeColumns","freezeRows","useMemo","columnHeaders","columnHeaderStyle","cellReadOnly","sourceData","displayData","editData","editKeys","cellStyle","useEffect","changeSelection","scrollToP2","newDataOffset","newScrollLeft","newScrollTop","lastVisibleColumnIndex","firstVisibleColumnIndex","increment","newX","firstVisibleRowIndex","lastVisibleRowIndex","newY","newMaxScroll","setTimeout","sx1","sy1","sx2","sy2","knobCoordinates","sely2","c","knobSize","selx2","hitMap","hitM","ch","cellW","absX1","absY1","columnHeaderHeight","absX2","absY2","w","h","x1key","x2key","y1key","y2key","xkey","xbin","ykey","animationFrameId","yCoord1","xCoord1","hideKnob","selx1","sely1","selectionActive","rowSelectionActive","colSelectionActive","p1","p2","currentCol","currentRow","p1x","p1y","startX","col","startY","row","chStyle","cw","chcontent","kx1","kx2","ky1","ky2","knobPoint1","knobPoint2","renderOnCanvas","setFocusToTextArea","preventScroll","setCopyPasteText","activeTagName","onPaste","e","clipboardData","types","text","parsePastedText","pastedHtml","parsePastedHtml","html","div","pasteLocX","pasteLocY","changes","tableNode","findTable","child","maybeTable","tableChild","tr","td","str","p","value","rows","pasteX2","pasteY2","cols","dy1","dy2","dx1","dx2","max","howManyEmpty","growthIncrement","growthIncrementFactor","allEmpty","data","findApproxMaxEditDataIndex","cptext","cptextTemp","nonEmpty","commitEditingCell","startEditingCell","editDataValue","val","editDataKey","onMouseUp","fx1","fy1","fx2","fy2","srcY","srcX","rect","onMouseMove","hitTargetKeyX","hitTargetKeyY","newWidth","newHeight","sel2","cell","xCellDiff","yCellDiff","editMode","editTextPosition","editTextWidth","editTextHeight","editTextTextAlign","inputProps","autoFocus","onKeyDown","includes","position","left","outline","border","input","onChange","onDoubleClick","onMouseDown","colIdx","indices","min","oldWidth","colIndices","rowIdx","oldHeight","rowIndices","sel1","onMouseLeave","onContextMenu","ev","onScroll","styles","overflow","borderBottom","opacity","autoComplete","autoCorrect","autoCapitalize","spellCheck","onFocus","tabIndex","incr","direction","first","firstFilled","findInDisplayData","onKeyUp","type","initialDataBig","r","push","initialDataBasic","initialDataFormatting","random","triangleDown","Image","useWidthHeigthControl","initialWidths","initialHeights","setCellWidth","setCellHeight","onCellWidthChange","idx","length","onCellHeightChange","SheetBoxHeader","setData","onSelectionChanged","onRightClick","newData","change","readOnly","SheetBoxBasic","JSON","parse","stringify","faCheck","SheetBoxStyle","colors","items","content","horiozntalAlign","console","log","undefined","incrementCell","SheetBoxFormatting","toFixed","Number","SheetBoxVeryBigData","loadingStatus","setLoadingStatus","href","preventDefault","fetch","then","response","json","dataset","toString","padStart","g","b","customInputOptions","customInputOptions2","customInputData","SheetBoxCustomInput","inputComponent","CustomInput","boxShadow","map","opt","CustomOption","key","clickHandler","hover","setHover","onMouseEnter","padding","cursor","SheetBoxSourceDisplayData","Header","textAreaRef","copySuccess","setCopySuccess","id","current","select","execCommand","target","focus","rel","GitIcon","TitleSeparator","title","Wrap","children","xcode","hljs","background","maxWidth","borderRadius","SourceDisplayDataCode","xcode2","language","InitSheetCode","InitSheetWithDataCode","EditDataCode","CellStyleSizeCode","Footer","Emphased","App","overflowX","ReactDOM","render"],"mappings":"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","file":"static/js/main.2145c7e6.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.aef13910.svg\";","module.exports = __webpack_public_path__ + \"static/media/git.f818b886.svg\";","import React from 'react';\nimport Logo from '../assets/logo.svg';\n\nfunction Menu() {\n    const scrollTo = (elId) => {\n        var element = document.getElementById(elId);\n        var headerOffset = elId === 'home' ? 0 : 86;\n        var elementPosition = window.pageYOffset + element.getBoundingClientRect().top;\n        var offsetPosition = elementPosition - headerOffset;\n\n        window.scrollTo({\n             top: offsetPosition,\n             behavior: \"smooth\"\n        });\n    }\n\n    return (\n        <div className=\"container blue-bg menu\">\n            <div className=\"content flex-row\">\n                <div className=\"logo-box\">\n                    <img src={Logo} alt=\"Logo\" />\n                    <h2 className=\"page-title\">sheet - happens</h2>\n                </div>\n                <div className=\"nav\">\n                    <div className=\"nav-item\" onClick={() => scrollTo('home')} >home</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('usage')} >usage</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('features')} >features</div>\n                    <div className=\"nav-item\" onClick={() => scrollTo('documentation')} >documentation</div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Menu;\n","import styles from './styles.module.css';\nimport React, {\n    useRef,\n    useEffect,\n    useState,\n    useMemo,\n    MouseEvent,\n    KeyboardEvent,\n    UIEvent,\n    CSSProperties,\n    ReactElement,\n} from 'react';\nimport useResizeObserver from 'use-resize-observer';\n\nconst selBorderColor = '#1b73e7';\nconst selBackColor = '#e9f0fd';\nconst knobSize = 6;\nconst gridColor = '#e2e3e3';\nconst knobAreaBorderColor = '#707070';\nconst rowHeaderWidth = 50;\nconst rowHeaderBackgroundColor = '#f8f9fa';\nconst rowHeaderTextColor = '#666666';\nconst rowHeaderSelectedBackgroundColor = '#e8eaed';\nconst columnHeaderHeight = 22;\nconst columnHeaderBackgroundColor = rowHeaderBackgroundColor;\nconst columnHeaderSelectedBackgroundColor = rowHeaderSelectedBackgroundColor;\nconst xBinSize = 10;\nconst yBinSize = 10;\nconst scrollSpeed = 30;\nconst resizeColumnRowMouseThreshold = 4;\nconst minimumColumnWidth = 50;\nconst minimumRowHeight = 22;\nconst rowColHeaderSelectionColor = '#AAAAAA';\nconst maxSearchableRowOrCol = 65536;\n\nconst defaultCellStyle: Required<Style> = {\n    textAlign: 'left',\n    fontSize: 13,\n    marginRight: 5,\n    marginLeft: 5,\n    color: '#000',\n    fontFamily: 'sans-serif',\n    weight: '',\n    fillColor: '',\n    backgroundColor: '',\n};\n\nconst defaultColumnHeaderStyle: Required<Style> = {\n    textAlign: 'center',\n    fontSize: 13,\n    marginRight: 5,\n    marginLeft: 5,\n    color: '#000',\n    fontFamily: 'sans-serif',\n    weight: '',\n    fillColor: '',\n    backgroundColor: '',\n};\n\ntype PropTypes = string | number | boolean | Style | CellContentType;\ntype RowOrColumnProperty<T extends PropTypes> = T | Array<T> | ((index: number) => T);\ntype CellProperty<T extends PropTypes> = T | Array<Array<T>> | ((x: number, y: number) => T);\ntype CellContentType = null | number | string | CellContent;\ntype RowOrColumnPropertyFunction<T extends PropTypes> = (rowOrColIndex: number) => T;\ntype CellPropertyFunction<T extends PropTypes> = (x: number, y: number) => T;\ntype InputStyle = Pick<\n    CSSProperties,\n    | 'position'\n    | 'top'\n    | 'left'\n    | 'width'\n    | 'height'\n    | 'outline'\n    | 'border'\n    | 'textAlign'\n    | 'color'\n    | 'fontSize'\n    | 'fontFamily'\n>;\nexport interface SheetInputProps {\n    value: string;\n    autoFocus: boolean;\n    onKeyDown: React.KeyboardEventHandler<HTMLElement>;\n    onChange: (valiue: string) => void;\n    style: InputStyle;\n}\ninterface CellCoordinate {\n    x: number;\n    y: number;\n}\n\ninterface Selection {\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n}\n\nexport interface Change {\n    x: number;\n    y: number;\n    value: string | number | null;\n}\n\nexport interface CellContentItem {\n    content: HTMLImageElement | string | number;\n    x: number;\n    y: number;\n    width?: number;\n    height?: number;\n    horiozntalAlign?: 'left' | 'right' | 'center';\n    onClick?: (e: MouseEvent) => void;\n}\n\nexport interface CellContent {\n    items: Array<CellContentItem>;\n}\n\nexport interface SheetMouseEvent extends MouseEvent {\n    cellX: number;\n    cellY: number;\n}\n\nexport interface SheetProps {\n    freezeColumns?: number;\n    freezeRows?: number;\n    cellWidth?: RowOrColumnProperty<number>;\n    cellHeight?: RowOrColumnProperty<number>;\n    columnHeaders?: RowOrColumnProperty<CellContentType>;\n    columnHeaderStyle?: RowOrColumnProperty<Style>;\n    cellStyle?: CellProperty<Style>;\n    readOnly?: CellProperty<boolean>;\n    sourceData?: CellProperty<string | number | null>;\n    displayData?: CellProperty<CellContentType>;\n    editData?: CellProperty<string>;\n    editKeys?: CellProperty<string>;\n    inputComponent?: (\n        x: number,\n        y: number,\n        props: SheetInputProps,\n        commitEditingCell?: () => void\n    ) => ReactElement | undefined;\n    onSelectionChanged?: (x1: number, y1: number, x2: number, y2: number) => void;\n    onRightClick?: (e: SheetMouseEvent) => void;\n    onChange?: (changes: Array<Change>) => void;\n    onCellWidthChange?: (indices: number[], value: number) => void;\n    onCellHeightChange?: (indices: number[], value: number) => void;\n    onScrollChange?: (scrollX: number, scrolLY: number) => void;\n}\n\nexport interface Style {\n    color?: string;\n    fontSize?: number;\n    fontFamily?: string;\n    textAlign?: 'right' | 'left' | 'center';\n    marginRight?: number;\n    marginLeft?: number;\n    weight?: string;\n    fillColor?: string;\n    backgroundColor?: string;\n}\n\ninterface RowOrColumnSize {\n    index: number[];\n    start: number[];\n    end: number[];\n}\n\nfunction resizeCanvas(canvas: HTMLCanvasElement) {\n    const { width, height } = canvas.getBoundingClientRect();\n    let { devicePixelRatio: ratio = 1 } = window;\n    if (ratio < 1) {\n        ratio = 1;\n    }\n    const newCanvasWidth = Math.round(width * ratio);\n    const newCanvasHeight = Math.round(height * ratio);\n\n    if (canvas.width !== newCanvasWidth || canvas.height !== newCanvasHeight) {\n        const context = canvas.getContext('2d');\n        if (context) {\n            canvas.width = newCanvasWidth;\n            canvas.height = newCanvasHeight;\n            context.scale(ratio, ratio);\n        }\n        return true;\n    }\n\n    return false;\n}\n\n// todo first figure out the function\nfunction createRowOrColumnPropFunction<T extends PropTypes>(\n    rowColProp: RowOrColumnProperty<T> | undefined,\n    defaultValue: T\n): RowOrColumnPropertyFunction<T> {\n    if (Array.isArray(rowColProp)) {\n        return (rowOrColIndex: number) => {\n            if (rowOrColIndex >= 0 && rowOrColIndex < rowColProp.length) {\n                return rowColProp[rowOrColIndex];\n            } else {\n                return defaultValue;\n            }\n        };\n    } else if (typeof rowColProp === 'function') {\n        return rowColProp;\n    } else if (rowColProp !== null && rowColProp !== undefined) {\n        return () => rowColProp;\n    } else {\n        return () => defaultValue;\n    }\n}\n\nfunction createCellPropFunction<T extends PropTypes>(\n    cellProp: CellProperty<T> | undefined,\n    defaultValue: T\n): CellPropertyFunction<T> {\n    if (Array.isArray(cellProp)) {\n        return (x: number, y: number) => {\n            if (y >= 0 && y < cellProp.length) {\n                if (x >= 0 && x < cellProp[y].length) {\n                    return cellProp[y][x];\n                } else {\n                    return defaultValue;\n                }\n            } else {\n                return defaultValue;\n            }\n        };\n    } else if (typeof cellProp === 'function') {\n        return cellProp;\n    } else if (cellProp !== null && cellProp !== undefined) {\n        return () => cellProp;\n    } else {\n        return () => defaultValue;\n    }\n}\n\nfunction applyAlignment(\n    start: number,\n    cellSize: number,\n    style: Required<Style>,\n    imageWidth: number,\n    alignment?: 'left' | 'center' | 'right'\n): number {\n    if (!alignment) {\n        alignment = style.textAlign;\n    }\n    if (alignment === 'left') {\n        return start + style.marginLeft;\n    } else if (alignment === 'center') {\n        return start + cellSize * 0.5 - imageWidth / 2;\n    } else if (alignment === 'right') {\n        return start + (cellSize - style.marginRight - imageWidth);\n    }\n    return start;\n}\n\nfunction drawCell(\n    context: CanvasRenderingContext2D,\n    cellContent: CellContentType,\n    style: Style,\n    defaultCellStyle: Required<Style>,\n    xCoord: number,\n    yCoord: number,\n    cellWidth: number,\n    cellHeight: number\n) {\n    if (cellContent === null) {\n        return;\n    }\n    const finalStyle = createStyleObject(style, defaultCellStyle);\n    context.fillStyle = finalStyle.color;\n    context.font = finalStyle.weight + ' ' + finalStyle.fontSize + 'px ' + finalStyle.fontFamily;\n    context.textAlign = finalStyle.textAlign;\n\n    const yy = yCoord + cellHeight * 0.5;\n\n    context.save();\n    context.beginPath();\n    context.rect(xCoord, yCoord, cellWidth, cellHeight);\n    context.clip();\n\n    if (finalStyle.backgroundColor !== '') {\n        context.fillStyle = finalStyle.backgroundColor;\n        context.fillRect(xCoord, yCoord, cellWidth, cellHeight);\n        context.fillStyle = finalStyle.color;\n    }\n\n    if (typeof cellContent === 'string' || typeof cellContent === 'number') {\n        const xx = applyAlignment(xCoord, cellWidth, finalStyle, 0);\n        context.fillText('' + cellContent, xx, yy);\n    } else if (typeof cellContent === 'object') {\n        for (const obj of cellContent.items) {\n            if (obj.content instanceof HTMLImageElement) {\n                const w = obj.width || cellWidth;\n                const finalX = applyAlignment(xCoord, cellWidth, finalStyle, w, obj.horiozntalAlign);\n                context.drawImage(\n                    obj.content,\n                    finalX + obj.x,\n                    yy + obj.y,\n                    obj.width || cellWidth,\n                    obj.height || cellHeight\n                );\n            } else if (typeof obj.content === 'string' || typeof obj.content === 'number') {\n                if (obj.horiozntalAlign) {\n                    context.textAlign = obj.horiozntalAlign;\n                }\n                const finalX = applyAlignment(xCoord, cellWidth, finalStyle, 0, obj.horiozntalAlign);\n                context.fillText('' + obj.content, finalX + obj.x, yy + obj.y);\n            }\n        }\n    }\n    context.restore();\n}\n\nfunction calculateRowsOrColsSizes(\n    freezeCount: number,\n    size: (index: number) => number,\n    startingSize: number,\n    startingIndex: number,\n    visibleArea: number\n): RowOrColumnSize {\n    const visible = [];\n    const start = [];\n    const end = [];\n    let prev = 0;\n\n    start.push(startingSize);\n    visible.push(freezeCount > 0 ? 0 : startingIndex);\n    let firstSize = freezeCount > 0 ? size(0) : size(startingIndex);\n    prev = startingSize + firstSize;\n    end.push(prev);\n\n    let ind = freezeCount > 0 ? 1 : startingIndex + 1;\n\n    if (freezeCount > 0) {\n        for (; ind < freezeCount; ind++) {\n            visible.push(ind);\n            start.push(prev);\n            prev = prev + size(ind);\n            end.push(prev);\n        }\n        ind = Math.max(startingIndex, freezeCount);\n    }\n\n    while (true) {\n        visible.push(ind);\n        start.push(prev);\n        prev = prev + size(ind);\n        end.push(prev);\n        if (end[end.length - 1] >= visibleArea) {\n            break;\n        }\n        ind++;\n    }\n    return {\n        index: visible,\n        start,\n        end,\n    };\n}\n\nfunction createStyleObject(optionalStyle: Style, defaultStyle: Required<Style>): Required<Style> {\n    return {\n        ...defaultStyle,\n        ...optionalStyle,\n    };\n}\n\nfunction excelHeaderString(num: number) {\n    let s = '';\n    let t = 0;\n    while (num > 0) {\n        t = (num - 1) % 26;\n        s = String.fromCharCode(65 + t) + s;\n        num = ((num - t) / 26) | 0;\n    }\n    return s || '';\n}\n\nfunction absCoordianteToCell(\n    absX: number,\n    absY: number,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize\n): CellCoordinate {\n    let cellX = 0;\n    let cellY = 0;\n\n    for (let i = 0; i < columnSizes.index.length; i++) {\n        if (absX >= columnSizes.start[i] && absX <= columnSizes.end[i]) {\n            cellX = columnSizes.index[i];\n            break;\n        }\n    }\n    for (let i = 0; i < rowSizes.index.length; i++) {\n        if (absY >= rowSizes.start[i] && absY <= rowSizes.end[i]) {\n            cellY = rowSizes.index[i];\n            break;\n        }\n    }\n\n    return { x: cellX, y: cellY };\n}\n\nfunction cellToAbsCoordinate(\n    cellX: number,\n    cellY: number,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize,\n    dataOffset: CellCoordinate,\n    cellWidth: RowOrColumnPropertyFunction<number>,\n    cellHeight: RowOrColumnPropertyFunction<number>\n): CellCoordinate {\n    let absX = rowHeaderWidth;\n    const indX = columnSizes.index.findIndex((i) => i === cellX);\n    if (indX !== -1) {\n        absX = columnSizes.start[indX];\n    } else {\n        for (let i = 0; i < dataOffset.x; i++) {\n            absX -= cellWidth(i);\n        }\n        for (let i = 0; i < cellX; i++) {\n            absX += cellWidth(i);\n        }\n    }\n\n    let absY = columnHeaderHeight;\n    const indY = rowSizes.index.findIndex((i) => i === cellY);\n    if (indY !== -1) {\n        absY = rowSizes.start[indY];\n    } else {\n        for (let i = 0; i < dataOffset.y; i++) {\n            absY -= cellHeight(i);\n        }\n        for (let i = 0; i < cellY; i++) {\n            absY += cellHeight(i);\n        }\n    }\n    return { x: absX, y: absY };\n}\n\nfunction findApproxMaxEditDataIndex(editData: CellPropertyFunction<string>) {\n    let x = 0;\n    let y = 0;\n    let howManyEmpty = 0;\n    let growthIncrement = 10;\n    let growthIncrementFactor = 1.5;\n\n    // x\n    while (howManyEmpty < 4) {\n        let allEmpty = true;\n        for (let yy = 0; yy < 10; yy++) {\n            const data = editData(x, yy);\n            if (data !== null && data !== undefined && data !== '') {\n                allEmpty = false;\n                break;\n            }\n        }\n        if (allEmpty) {\n            howManyEmpty += 1;\n        }\n        x += growthIncrement;\n        growthIncrement = Math.floor(growthIncrement * growthIncrementFactor);\n    }\n\n    howManyEmpty = 0;\n    growthIncrement = 10;\n    growthIncrementFactor = 1.5;\n\n    // y\n    while (howManyEmpty < 4) {\n        let allEmpty = true;\n        for (let xx = 0; xx < 10; xx++) {\n            const data = editData(xx, y);\n            if (data !== null && data !== undefined && data !== '') {\n                allEmpty = false;\n                break;\n            }\n        }\n        if (allEmpty) {\n            howManyEmpty += 1;\n        }\n        y += growthIncrement;\n        growthIncrement = Math.floor(growthIncrement * growthIncrementFactor);\n    }\n    return { x, y };\n}\n\nfunction findInDisplayData(\n    displayData: CellPropertyFunction<CellContentType>,\n    start: { x: number; y: number },\n    direction: 'up' | 'down' | 'left' | 'right'\n) {\n    let i = { ...start };\n    let increment = { x: 0, y: 0 };\n    if (direction === 'up') {\n        increment.y = -1;\n    } else if (direction === 'down') {\n        increment.y = 1;\n    } else if (direction === 'left') {\n        increment.x = -1;\n    } else if (direction === 'right') {\n        increment.x = 1;\n    }\n    const max = { x: maxSearchableRowOrCol, y: maxSearchableRowOrCol };\n    if (i.x > max.x) {\n        i.x = max.x;\n    }\n    if (i.y > max.y) {\n        i.y = max.y;\n    }\n\n    const first = displayData(i.x + increment.x, i.y + increment.y);\n    const firstFilled = first !== '' && first !== null && first !== undefined;\n\n    if (!firstFilled) {\n        i.x += increment.x;\n        i.y += increment.y;\n    }\n\n    while (i.x <= max.x && i.y <= max.y && i.x >= 0 && i.y >= 0) {\n        const data = displayData(i.x, i.y);\n\n        // if first cell is filled, find the latest filled cell, so first look for first unfilled\n        if (firstFilled && (data === '' || data === null || data === undefined)) {\n            return {\n                x: i.x - increment.x,\n                y: i.y - increment.y,\n            };\n        }\n        // if first cell is not filled, just find the first filled\n        if (!firstFilled && data !== '' && data !== null && data !== undefined) {\n            return { ...i };\n        }\n\n        i.x += increment.x;\n        i.y += increment.y;\n    }\n    return i;\n}\n\nfunction renderOnCanvas(\n    context: CanvasRenderingContext2D,\n    rowSizes: RowOrColumnSize,\n    columnSizes: RowOrColumnSize,\n    cellStyle: CellPropertyFunction<Style>,\n    cellWidth: RowOrColumnPropertyFunction<number>,\n    cellHeight: RowOrColumnPropertyFunction<number>,\n    selection: Selection,\n    knobDragInProgress: boolean,\n    columnHeaders: RowOrColumnPropertyFunction<CellContentType>,\n    columnHeaderStyle: RowOrColumnPropertyFunction<Style>,\n    knobArea: Selection,\n    displayData: CellPropertyFunction<CellContentType>,\n    dataOffset: CellCoordinate,\n    knobCoordinates: { x: number; y: number }\n) {\n    resizeCanvas(context.canvas);\n    context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n\n    // apply cell fill color\n    let yCoord1 = columnHeaderHeight;\n    for (const y of rowSizes.index) {\n        let xCoord1 = rowHeaderWidth;\n        for (const x of columnSizes.index) {\n            const style = cellStyle(x, y);\n            if (style.fillColor) {\n                context.fillStyle = style.fillColor;\n                context.fillRect(xCoord1, yCoord1, cellWidth(x), cellHeight(y));\n            }\n            xCoord1 += cellWidth(x);\n        }\n        yCoord1 += cellHeight(y);\n    }\n\n    let hideKnob = false;\n\n    let selx1 = selection.x1;\n    let selx2 = selection.x2;\n\n    if (selection.x1 > selection.x2) {\n        selx1 = selection.x2;\n        selx2 = selection.x1;\n    }\n\n    let sely1 = selection.y1;\n    let sely2 = selection.y2;\n\n    if (selection.y1 > selection.y2) {\n        sely1 = selection.y2;\n        sely2 = selection.y1;\n    }\n\n    const selectionActive = (selx1 !== -1 && selx2 !== -1) || (sely1 !== -1 && sely2 !== -1);\n\n    const rowSelectionActive = selx1 === -1 && selx2 === -1 && sely1 !== -1 && sely2 !== -1;\n    const colSelectionActive = selx1 !== -1 && selx2 !== -1 && sely1 === -1 && sely2 === -1;\n\n    const p1 = cellToAbsCoordinate(selx1, sely1, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n    const p2 = cellToAbsCoordinate(selx2, sely2, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n    p2.x += cellWidth(selx2);\n    p2.y += cellHeight(sely2);\n\n    if (p1.x >= p2.x) {\n        // recalculate if the selection span covers both frozen and unfrozen columns\n        p2.x = p1.x;\n        let currentCol = selx1;\n        while (columnSizes.index.includes(currentCol)) {\n            p2.x += cellWidth(currentCol);\n            currentCol++;\n        }\n        hideKnob = true;\n    }\n\n    if (p1.y >= p2.y) {\n        // recalculate if the selection span covers both frozen and unfrozen rows\n        p2.y = p1.y;\n        let currentRow = sely1;\n        while (rowSizes.index.includes(currentRow)) {\n            p2.y += cellHeight(currentRow);\n            currentRow++;\n        }\n        hideKnob = true;\n    }\n\n    // selection fill\n    if (selectionActive) {\n        context.fillStyle = selBackColor;\n        const p1x = Math.max(-100, p1.x);\n        const p1y = Math.max(-100, p1.y);\n        if (rowSelectionActive) {\n            context.fillRect(p1x, p1y, 100000, p2.y - p1.y);\n        } else if (colSelectionActive) {\n            context.fillRect(p1x, p1y, p2.x - p1.x, 100000);\n        } else {\n            context.fillRect(p1x, p1y, p2.x - p1.x, p2.y - p1.y);\n        }\n    }\n\n    // row header background\n    context.fillStyle = rowHeaderBackgroundColor;\n    context.fillRect(0, 0, rowHeaderWidth, context.canvas.height);\n\n    // row header selection\n    if (selectionActive) {\n        context.fillStyle = rowHeaderSelectedBackgroundColor;\n        context.fillRect(0, p1.y, rowHeaderWidth, p2.y - p1.y);\n    }\n\n    // column header background\n    context.fillStyle = columnHeaderBackgroundColor;\n    context.fillRect(0, 0, context.canvas.width, columnHeaderHeight);\n\n    // column header selection\n    if (selectionActive) {\n        context.fillStyle = columnHeaderSelectedBackgroundColor;\n        context.fillRect(p1.x, 0, p2.x - p1.x, columnHeaderHeight);\n    }\n\n    // grid\n    context.strokeStyle = gridColor;\n    context.lineWidth = 1;\n    let startX = rowHeaderWidth;\n\n    for (const col of columnSizes.index) {\n        context.beginPath();\n        context.moveTo(startX, 0);\n        context.lineTo(startX, context.canvas.height);\n        context.stroke();\n        startX += cellWidth(col);\n    }\n\n    let startY = columnHeaderHeight;\n    for (const row of rowSizes.index) {\n        context.beginPath();\n        context.moveTo(0, startY);\n        context.lineTo(context.canvas.width, startY);\n        context.stroke();\n        startY += cellHeight(row);\n    }\n\n    // row header text\n    startY = columnHeaderHeight;\n    context.textBaseline = 'middle';\n    context.textAlign = 'center';\n    context.font = defaultCellStyle.fontSize + 'px ' + defaultCellStyle.fontFamily;\n    context.fillStyle = rowHeaderTextColor;\n    for (const row of rowSizes.index) {\n        const cellContent = row + 1;\n        let chStyle = {};\n        if (rowSelectionActive && sely1 <= row && sely2 >= row) {\n            chStyle = { ...chStyle, backgroundColor: rowColHeaderSelectionColor };\n        }\n        drawCell(\n            context,\n            '' + cellContent,\n            chStyle,\n            defaultColumnHeaderStyle,\n            0,\n            startY,\n            rowHeaderWidth,\n            cellHeight(row)\n        );\n        startY += cellHeight(row);\n    }\n\n    // column header text\n    startX = rowHeaderWidth;\n    context.textBaseline = 'middle';\n    context.textAlign = 'center';\n    for (const col of columnSizes.index) {\n        const cw = cellWidth(col);\n        const ch = columnHeaders(col);\n        const chcontent = ch !== null ? ch : excelHeaderString(col + 1);\n        let chStyle = columnHeaderStyle(col);\n        if (colSelectionActive && selx1 <= col && selx2 >= col) {\n            chStyle = { ...chStyle, backgroundColor: rowColHeaderSelectionColor };\n        }\n        drawCell(context, chcontent, chStyle, defaultColumnHeaderStyle, startX, 0, cw, columnHeaderHeight);\n        startX += cw;\n    }\n\n    // selection outline\n    if (selectionActive) {\n        context.strokeStyle = selBorderColor;\n        context.lineWidth = 1;\n        const p1x = Math.max(-100, p1.x);\n        const p1y = Math.max(-100, p1.y);\n        context.beginPath();\n        if (rowSelectionActive) {\n            context.rect(p1x, p1y, 100000, p2.y - p1.y);\n        } else if (colSelectionActive) {\n            context.rect(p1x, p1y, p2.x - p1.x, 100000);\n        } else {\n            context.rect(p1x, p1y, p2.x - p1.x, p2.y - p1.y);\n        }\n        context.stroke();\n    }\n\n    // knob drag outline\n    if (knobDragInProgress) {\n        let kx1 = knobArea.x1;\n        let kx2 = knobArea.x2;\n        if (knobArea.x1 > knobArea.x2) {\n            kx1 = knobArea.x2;\n            kx2 = knobArea.x1;\n        }\n\n        let ky1 = knobArea.y1;\n        let ky2 = knobArea.y2;\n        if (knobArea.y1 > knobArea.y2) {\n            ky1 = knobArea.y2;\n            ky2 = knobArea.y1;\n        }\n        const knobPoint1 = cellToAbsCoordinate(kx1, ky1, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n        const knobPoint2 = cellToAbsCoordinate(\n            kx2 + 1,\n            ky2 + 1,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight\n        );\n        context.strokeStyle = knobAreaBorderColor;\n        context.setLineDash([3, 3]);\n        context.lineWidth = 1;\n        context.beginPath();\n        if (rowSelectionActive) {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, 100000, knobPoint2.y - knobPoint1.y);\n        } else if (colSelectionActive) {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, knobPoint2.x - knobPoint1.x, 100000);\n        } else {\n            context.rect(knobPoint1.x, knobPoint1.y - 1, knobPoint2.x - knobPoint1.x, knobPoint2.y - knobPoint1.y);\n        }\n        context.stroke();\n        context.setLineDash([]);\n    }\n\n    // selection knob\n    if (selectionActive && !hideKnob) {\n        context.fillStyle = selBorderColor;\n        context.fillRect(knobCoordinates.x - knobSize * 0.5, knobCoordinates.y - knobSize * 0.5, knobSize, knobSize);\n    }\n\n    // content\n    context.textBaseline = 'middle';\n\n    // draw content\n    let yCoord = columnHeaderHeight;\n    for (const y of rowSizes.index) {\n        let xCoord = rowHeaderWidth;\n        const ch = cellHeight(y);\n        for (const x of columnSizes.index) {\n            const cellContent = displayData(x, y);\n            const cw = cellWidth(x);\n            if (cellContent !== null && cellContent !== undefined) {\n                const style = cellStyle(x, y);\n                drawCell(context, cellContent, style, defaultCellStyle, xCoord, yCoord, cw, ch);\n            }\n            xCoord += cw;\n        }\n        yCoord += ch;\n    }\n}\n\nfunction Sheet(props: SheetProps) {\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const overlayRef = useRef<HTMLDivElement>(null);\n    const copyPasteTextAreaRef = useRef<HTMLTextAreaElement>(null);\n    const [maxScroll, setMaxScroll] = useState({ x: 5000, y: 5000 });\n    const [dataOffset, setDataOffset] = useState({ x: 0, y: 0 });\n    const [selection, setSelection] = useState({ x1: -1, y1: -1, x2: -1, y2: -1 });\n    const [knobArea, setKnobArea] = useState({ x1: -1, y1: -1, x2: -1, y2: -1 });\n    const [editCell, setEditCell] = useState({ x: -1, y: -1 });\n    const [editValue, setEditValue] = useState<string | number>('');\n    const [editKey, setEditKey] = useState<string>('');\n    const [arrowKeyCommitMode, setArrowKeyCommitMode] = useState(false);\n    const [shiftKeyDown, setShiftKeyDown] = useState(false);\n    const [knobDragInProgress, setKnobDragInProgress] = useState(false);\n    const [selectionInProgress, setSelectionInProgress] = useState(false);\n    const [columnResize, setColumnResize] = useState<{ startX: number; colIndices: number[]; oldWidth: number } | null>(\n        null\n    );\n    const [rowResize, setRowResize] = useState<{ startY: number; rowIndices: number[]; oldHeight: number } | null>(\n        null\n    );\n    const [rowSelectionInProgress, setRowSelectionInProgress] = useState(false);\n    const [columnSelectionInProgress, setColumnSelectionInProgress] = useState(false);\n    const [buttonClickMouseDownCoordinates, setButtonClickMouseDownCoordinates] = useState<any>({\n        x: -1,\n        y: -1,\n        hitTarget: null,\n    });\n    const { width: canvasWidth = 3000, height: canvasHeight = 3000 } = useResizeObserver({ ref: canvasRef });\n\n    const freezeColumns = props.freezeColumns || 0;\n    const freezeRows = props.freezeRows || 0;\n\n    const cellWidth = useMemo(() => createRowOrColumnPropFunction(props.cellWidth, 100), [props.cellWidth]);\n    const cellHeight = useMemo(() => createRowOrColumnPropFunction(props.cellHeight, 22), [props.cellHeight]);\n    const columnHeaders = useMemo(() => createRowOrColumnPropFunction(props.columnHeaders, null), [\n        props.columnHeaders,\n    ]);\n    const columnHeaderStyle = useMemo(() => createRowOrColumnPropFunction(props.columnHeaderStyle, {}), [\n        props.columnHeaderStyle,\n    ]);\n\n    const cellReadOnly = useMemo(() => createCellPropFunction(props.readOnly, false), [props.readOnly]);\n\n    const sourceData = useMemo(() => createCellPropFunction(props.sourceData, null), [props.sourceData]);\n    const displayData = useMemo(() => createCellPropFunction(props.displayData, ''), [props.displayData]);\n    const editData = useMemo(() => createCellPropFunction(props.editData, ''), [props.editData]);\n    const editKeys = useMemo(() => createCellPropFunction(props.editKeys, ''), [props.editKeys]);\n    const cellStyle = useMemo(() => createCellPropFunction(props.cellStyle, defaultCellStyle), [props.cellStyle]);\n\n    useEffect(() => {\n        const currEditKey = editKeys ? editKeys(editCell.x, editCell.y) : '';\n        if (currEditKey !== editKey) {\n            setEditCell({ x: -1, y: -1 });\n            setEditKey('');\n        }\n    }, [editKeys]);\n\n    const columnSizes = useMemo(\n        () => calculateRowsOrColsSizes(freezeColumns, cellWidth, rowHeaderWidth, dataOffset.x, canvasWidth),\n        [props.freezeColumns, cellWidth, dataOffset.x, canvasWidth]\n    );\n\n    const rowSizes = useMemo(\n        () => calculateRowsOrColsSizes(freezeRows, cellHeight, columnHeaderHeight, dataOffset.y, canvasHeight),\n        [props.freezeRows, cellHeight, dataOffset.y, canvasHeight]\n    );\n\n    const changeSelection = (x1: number, y1: number, x2: number, y2: number, scrollToP2 = true) => {\n        if (selection.x1 !== x1 || selection.x2 !== x2 || selection.y1 !== y1 || selection.y2 !== y2) {\n            setSelection({ x1, y1, x2, y2 });\n        }\n\n        if (scrollToP2) {\n            const newDataOffset = { x: dataOffset.x, y: dataOffset.y };\n            let newScrollLeft = -1;\n            let newScrollTop = -1;\n\n            if (\n                x2 !== -1 &&\n                (!columnSizes.index.includes(x2) || columnSizes.index[columnSizes.index.length - 1] === x2)\n            ) {\n                const lastVisibleColumnIndex = columnSizes.index[columnSizes.index.length - 1];\n                const firstVisibleColumnIndex = columnSizes.index[freezeColumns];\n                let increment = 0;\n                if (x2 >= lastVisibleColumnIndex) {\n                    increment = 1 + x2 - lastVisibleColumnIndex;\n                } else if (x2 < firstVisibleColumnIndex) {\n                    increment = x2 - firstVisibleColumnIndex;\n                }\n                const newX = Math.max(dataOffset.x, freezeColumns) + increment;\n                newDataOffset.x = newX;\n                newScrollLeft = newX * scrollSpeed;\n            }\n\n            if (y2 !== -1 && (!rowSizes.index.includes(y2) || rowSizes.index[rowSizes.index.length - 1] === y2)) {\n                const firstVisibleRowIndex = rowSizes.index[freezeRows];\n                const lastVisibleRowIndex = rowSizes.index[rowSizes.index.length - 1];\n                let increment = 0;\n                if (y2 >= lastVisibleRowIndex) {\n                    increment = 1 + y2 - lastVisibleRowIndex;\n                } else if (y2 < firstVisibleRowIndex) {\n                    increment = y2 - firstVisibleRowIndex;\n                }\n                const newY = Math.max(dataOffset.y, freezeRows) + increment;\n                newDataOffset.y = newY;\n                newScrollTop = newY * scrollSpeed;\n            }\n\n            if (newDataOffset.x !== dataOffset.x || dataOffset.y !== newDataOffset.y) {\n                setDataOffset({ x: newDataOffset.x, y: newDataOffset.y });\n                const newMaxScroll = { ...maxScroll };\n                newMaxScroll.x = Math.max(newMaxScroll.x, newScrollLeft);\n                newMaxScroll.y = Math.max(newMaxScroll.y, newScrollTop);\n                setMaxScroll(newMaxScroll);\n                setTimeout(() => {\n                    if (overlayRef.current) {\n                        if (newScrollLeft !== -1) {\n                            overlayRef.current.scrollLeft = newScrollLeft;\n                        }\n                        if (newScrollTop !== -1) {\n                            overlayRef.current.scrollTop = newScrollTop;\n                        }\n                    }\n                }, 0);\n            }\n        }\n\n        if (props.onSelectionChanged) {\n            let sx1 = x1;\n            let sy1 = y1;\n            let sx2 = x2;\n            let sy2 = y2;\n            if (sx1 > sx2) {\n                sx1 = x2;\n                sx2 = x1;\n            }\n            if (sy1 > sy2) {\n                sy1 = y2;\n                sy2 = y1;\n            }\n            props.onSelectionChanged(sx1, sy1, sx2, sy2);\n        }\n    };\n\n    const knobCoordinates = useMemo(() => {\n        if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n            let sely2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sely2 = selection.y1;\n            }\n            const c = cellToAbsCoordinate(0, sely2, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n            return { x: c.x + knobSize * 0.5, y: c.y + cellHeight(sely2) };\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1 && selection.y1 === -1 && selection.y2 === -1) {\n            let selx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                selx2 = selection.x1;\n            }\n\n            const c = cellToAbsCoordinate(selx2, 0, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n            return { x: c.x + cellWidth(selx2), y: c.y + knobSize * 0.5 };\n        }\n        if (selection.x2 !== -1 && selection.y2 !== -1) {\n            let selx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                selx2 = selection.x1;\n            }\n\n            let sely2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sely2 = selection.y1;\n            }\n            const c = cellToAbsCoordinate(selx2, sely2, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight);\n            return { x: c.x + cellWidth(selx2), y: c.y + cellHeight(sely2) };\n        }\n        return { x: -1, y: -1 };\n    }, [selection, rowSizes, columnSizes, dataOffset, cellWidth, cellHeight]);\n\n    const hitMap = useMemo(() => {\n        const hitM = {};\n        const canvas = canvasRef.current;\n        if (!canvas) {\n            return hitM;\n        }\n        resizeCanvas(canvas);\n        let yCoord = columnHeaderHeight;\n        let xCoord = rowHeaderWidth;\n\n        for (const x of columnSizes.index) {\n            const ch = columnHeaders(x);\n            const cellW = cellWidth(x);\n            if (ch && typeof ch === 'object' && ch.items) {\n                let finalStyle;\n                for (const obj of ch.items) {\n                    if (obj.onClick) {\n                        if (!finalStyle) {\n                            finalStyle = createStyleObject(columnHeaderStyle(x), defaultCellStyle);\n                        }\n                        const w = obj.content instanceof HTMLImageElement ? obj.width || cellW : 0;\n                        const absX1 = applyAlignment(xCoord, cellW, finalStyle, w, obj.horiozntalAlign) + obj.x;\n                        const absY1 = columnHeaderHeight * 0.5 + obj.y;\n                        const absX2 = absX1 + (obj.width || 0);\n                        const absY2 = absY1 + (obj.height || 0);\n\n                        const hitTarget = {\n                            x: absX1,\n                            y: absY1,\n                            w: obj.width,\n                            h: obj.height,\n                            onClick: obj.onClick,\n                        };\n\n                        // add to hit map\n                        const x1key = Math.floor(absX1 / xBinSize);\n                        const x2key = Math.floor(absX2 / xBinSize);\n\n                        const y1key = Math.floor(absY1 / yBinSize);\n                        const y2key = Math.floor(absY2 / yBinSize);\n\n                        for (let xkey = x1key; xkey <= x2key; xkey++) {\n                            if (!hitM[xkey]) {\n                                hitM[xkey] = {};\n                            }\n                            const xbin = hitM[xkey];\n                            for (let ykey = y1key; ykey <= y2key; ykey++) {\n                                if (!xbin[ykey]) {\n                                    xbin[ykey] = [];\n                                }\n                                xbin[ykey].push(hitTarget);\n                            }\n                        }\n                    }\n                }\n            }\n            xCoord += cellW;\n        }\n\n        for (const y of rowSizes.index) {\n            xCoord = rowHeaderWidth;\n            for (const x of columnSizes.index) {\n                const cellContent = displayData(x, y);\n                const cellW = cellWidth(x);\n                if (cellContent === null || cellContent === undefined) {\n                    xCoord += cellW;\n                    continue;\n                }\n\n                const xx = xCoord;\n                const yy = yCoord + cellHeight(y) * 0.5;\n\n                if (typeof cellContent === 'object' && cellContent.items) {\n                    let finalStyle;\n                    for (const obj of cellContent.items) {\n                        if (obj.onClick) {\n                            if (!finalStyle) {\n                                finalStyle = createStyleObject(cellStyle(x, y), defaultCellStyle);\n                            }\n                            const w = obj.content instanceof HTMLImageElement ? obj.width || cellW : 0;\n                            const absX1 = applyAlignment(xx, cellW, finalStyle, w, obj.horiozntalAlign) + obj.x;\n                            const absY1 = yy + obj.y;\n                            const absX2 = absX1 + (obj.width || 0);\n                            const absY2 = absY1 + (obj.height || 0);\n\n                            const hitTarget = {\n                                x: absX1,\n                                y: absY1,\n                                w: obj.width,\n                                h: obj.height,\n                                onClick: obj.onClick,\n                            };\n\n                            // add to hit map\n                            const x1key = Math.floor(absX1 / xBinSize);\n                            const x2key = Math.floor(absX2 / xBinSize);\n\n                            const y1key = Math.floor(absY1 / yBinSize);\n                            const y2key = Math.floor(absY2 / yBinSize);\n\n                            for (let xkey = x1key; xkey <= x2key; xkey++) {\n                                if (!hitM[xkey]) {\n                                    hitM[xkey] = {};\n                                }\n                                const xbin = hitM[xkey];\n                                for (let ykey = y1key; ykey <= y2key; ykey++) {\n                                    if (!xbin[ykey]) {\n                                        xbin[ykey] = [];\n                                    }\n                                    xbin[ykey].push(hitTarget);\n                                }\n                            }\n                        }\n                    }\n                }\n                xCoord += cellW;\n            }\n            yCoord += cellHeight(y);\n        }\n        return hitM;\n    }, [displayData, props.cellWidth, props.cellHeight, canvasRef, columnSizes, rowSizes, dataOffset.x, dataOffset.y]);\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        if (!canvas) {\n            return;\n        }\n        const context = canvas.getContext('2d');\n        if (!context) {\n            return;\n        }\n        let animationFrameId = window.requestAnimationFrame(() => {\n            renderOnCanvas(\n                context,\n                rowSizes,\n                columnSizes,\n                cellStyle,\n                cellWidth,\n                cellHeight,\n                selection,\n                knobDragInProgress,\n                columnHeaders,\n                columnHeaderStyle,\n                knobArea,\n                displayData,\n                dataOffset,\n                knobCoordinates\n            );\n        });\n\n        return () => {\n            window.cancelAnimationFrame(animationFrameId);\n        };\n    }, [\n        canvasRef,\n        rowSizes,\n        columnSizes,\n        cellStyle,\n        cellWidth,\n        cellHeight,\n        selection,\n        knobDragInProgress,\n        columnHeaders,\n        columnHeaderStyle,\n        knobArea,\n        displayData,\n        dataOffset,\n        knobCoordinates,\n    ]);\n\n    const setFocusToTextArea = () => {\n        if (copyPasteTextAreaRef.current) {\n            copyPasteTextAreaRef.current.focus({ preventScroll: true });\n            copyPasteTextAreaRef.current.select();\n        }\n    };\n\n    useEffect(() => {\n        if (!editMode) {\n            setCopyPasteText();\n        }\n    }, [selection, editData]);\n\n    useEffect(() => {\n        if (!editMode) {\n            if (document.activeElement === copyPasteTextAreaRef.current) {\n                setFocusToTextArea();\n            } else {\n                const activeTagName = (document as any).activeElement.tagName.toLowerCase();\n                if (\n                    !(\n                        (activeTagName === 'div' && (document as any).activeElement.contentEditable === 'true') ||\n                        activeTagName === 'input' ||\n                        activeTagName === 'textarea' ||\n                        activeTagName === 'select'\n                    )\n                ) {\n                    setFocusToTextArea();\n                }\n            }\n        }\n    });\n\n    const onPaste = (e: any) => {\n        if (!copyPasteTextAreaRef) {\n            return;\n        }\n        if (e.target !== copyPasteTextAreaRef.current) {\n            return;\n        }\n        e.preventDefault();\n\n        const clipboardData = e.clipboardData || (window as any).clipboardData;\n        const types = clipboardData.types;\n        if (\n            (types.includes('text/rtf') && types.includes('text/plain')) ||\n            (types.includes('text/plain') && !types.includes('text/html'))\n        ) {\n            const text = clipboardData.getData('text/plain');\n            parsePastedText(text);\n        } else if (types.includes('text/html')) {\n            const pastedHtml = clipboardData.getData('text/html');\n            parsePastedHtml(pastedHtml);\n        }\n    };\n\n    useEffect(() => {\n        window.document.addEventListener('paste', onPaste);\n        return () => {\n            window.document.removeEventListener('paste', onPaste);\n        };\n    });\n\n    const findTable = (element: any): any => {\n        for (const child of element.children) {\n            if (child.nodeName === 'TABLE') {\n                return child;\n            }\n            const maybeTable = findTable(child);\n            if (maybeTable) {\n                return maybeTable;\n            }\n        }\n    };\n\n    const parsePastedHtml = (html: string) => {\n        const div = document.createElement('div');\n        div.innerHTML = html.trim();\n        let pasteLocX = -1;\n        let pasteLocY = -1;\n        if (selection.x1 !== -1 && selection.x2 === -1) {\n            pasteLocX = selection.x1;\n        }\n        if (selection.y1 !== -1 && selection.y2 === -1) {\n            pasteLocY = selection.y1;\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1) {\n            pasteLocX = Math.min(selection.x1, selection.x2);\n        }\n        if (selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocY = Math.min(selection.y1, selection.y2);\n        }\n        if (pasteLocX === -1 || pasteLocY === -1) {\n            return;\n        }\n\n        let x = pasteLocX;\n        let y = pasteLocY;\n        const changes = [];\n\n        const tableNode = findTable(div);\n        if (!tableNode) {\n            return;\n        }\n\n        for (const tableChild of tableNode.children) {\n            if (tableChild.nodeName === 'TBODY') {\n                for (const tr of tableChild.children) {\n                    x = pasteLocX;\n                    if (tr.nodeName === 'TR') {\n                        for (const td of tr.children) {\n                            if (td.nodeName === 'TD') {\n                                let str: string = '';\n                                if (td.children.length !== 0 && td.children[0].nodeName === 'P') {\n                                    const p = td.children[0];\n                                    if (p.children.length !== 0 && p.children[0].nodeName === 'FONT') {\n                                        str = p.children[0].innerHTML;\n                                    } else {\n                                        str = p.innerHTML;\n                                    }\n                                } else {\n                                    str = td.innerHTML;\n                                }\n                                str = str.replaceAll('\\n', '');\n                                str = str.replaceAll(/\\s\\s+/g, ' ');\n                                changes.push({ y: y, x: x, value: str });\n                                x++;\n                            }\n                        }\n                        y++;\n                    }\n                }\n            }\n        }\n\n        if (props.onChange) {\n            props.onChange(changes);\n        }\n        let pasteX2 = x - 1;\n        let pasteY2 = y - 1;\n        changeSelection(pasteLocX, pasteLocY, pasteX2, pasteY2, false);\n    };\n\n    const parsePastedText = (text: string) => {\n        let pasteLocX = -1;\n        let pasteLocY = -1;\n        if (selection.x1 !== -1 && selection.x2 === -1) {\n            pasteLocX = selection.x1;\n        }\n        if (selection.x1 !== -1 && selection.x2 !== -1) {\n            pasteLocX = Math.min(selection.x1, selection.x2);\n        }\n        if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocX = 0;\n        }\n\n        if (selection.y1 !== -1 && selection.y2 === -1) {\n            pasteLocY = selection.y1;\n        }\n        if (selection.y1 !== -1 && selection.y2 !== -1) {\n            pasteLocY = Math.min(selection.y1, selection.y2);\n        }\n        if (selection.y1 === -1 && selection.y2 === -1 && selection.x2 !== -1 && selection.x2 !== -1) {\n            pasteLocY = 0;\n        }\n\n        if (pasteLocX === -1 || pasteLocY === -1) {\n            return;\n        }\n\n        const rows = text.split(/\\r?\\n/);\n        let pasteX2 = pasteLocX;\n        let pasteY2 = pasteLocY + rows.length - 1;\n        const changes = [];\n        for (let y = 0; y < rows.length; y++) {\n            const cols = rows[y].split('\\t');\n\n            if (pasteLocX + cols.length - 1 > pasteX2) {\n                pasteX2 = pasteLocX + cols.length - 1;\n            }\n            for (let x = 0; x < cols.length; x++) {\n                changes.push({ y: pasteLocY + y, x: pasteLocX + x, value: cols[x] });\n            }\n        }\n\n        if (props.onChange) {\n            props.onChange(changes);\n        }\n        changeSelection(pasteLocX, pasteLocY, pasteX2, pasteY2, false);\n    };\n\n    const setCopyPasteText = () => {\n        if (selection.x1 === -1 && selection.y1 === -1 && selection.x2 === -1 && selection.y2 === -1) {\n            return;\n        }\n\n        let dy1 = selection.y1;\n        let dy2 = selection.y2;\n        if (dy1 > dy2) {\n            dy1 = selection.y2;\n            dy2 = selection.y1;\n        }\n\n        let dx1 = selection.x1;\n        let dx2 = selection.x2;\n        if (dx1 > dx2) {\n            dx1 = selection.x2;\n            dx2 = selection.x1;\n        }\n\n        const max = findApproxMaxEditDataIndex(editData);\n\n        if (dx1 === -1 && dx2 === -1) {\n            dx1 = 0;\n            dx2 = max.x;\n        }\n        if (dy1 === -1 && dy2 === -1) {\n            dy1 = 0;\n            dy2 = max.y;\n        }\n\n        let cptext = '';\n        let cptextTemp = '';\n        for (let y = dy1; y <= dy2; y++) {\n            let nonEmpty = false;\n            for (let x = dx1; x <= dx2; x++) {\n                const value = editData(x, y);\n                if (value !== null && value !== undefined) {\n                    cptextTemp += value;\n                    nonEmpty = true;\n                }\n                if (x !== dx2) {\n                    cptextTemp += '\\t';\n                }\n            }\n            if (y !== dy2) {\n                cptextTemp += '\\n';\n            }\n            if (nonEmpty) {\n                cptext += cptextTemp;\n                cptextTemp = '';\n            }\n        }\n        if (copyPasteTextAreaRef.current) {\n            copyPasteTextAreaRef.current.value = cptext;\n        }\n    };\n\n    const commitEditingCell = (value?: string) => {\n        if (props.onChange) {\n            props.onChange([{ x: editCell.x, y: editCell.y, value: value !== undefined ? value : editValue }]);\n        }\n\n        setEditCell({ x: -1, y: -1 });\n        setEditKey('');\n    };\n\n    const startEditingCell = (editCell: CellCoordinate) => {\n        if (cellReadOnly(editCell.x, editCell.y)) {\n            return;\n        }\n\n        const editDataValue = editData(editCell.x, editCell.y);\n        let val = '';\n        if (editDataValue !== null && editDataValue !== undefined) {\n            val = editDataValue;\n        }\n        const editDataKey = editKeys ? editKeys(editCell.x, editCell.y) : '';\n        setEditCell(editCell);\n        setEditKey(editDataKey);\n        setEditValue(val);\n        setShiftKeyDown(false);\n    };\n\n    const onScroll = (e: UIEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const absX = e.target.scrollLeft;\n        const absY = e.target.scrollTop;\n\n        const cellX = Math.floor(absX / scrollSpeed);\n        const cellY = Math.floor(absY / scrollSpeed);\n        if (cellX !== dataOffset.x || cellY !== dataOffset.y) {\n            setDataOffset({ x: cellX, y: cellY });\n            if (props.onScrollChange) {\n                props.onScrollChange(cellX, cellY);\n            }\n        }\n\n        let newMaxScroll = { ...maxScroll };\n        if (maxScroll.x / (absX + 0.5) < 1) {\n            newMaxScroll.x *= 1.5;\n        }\n        if (maxScroll.y / (absY + 0.5) < 1) {\n            newMaxScroll.y *= 1.5;\n        }\n        if (newMaxScroll.x !== maxScroll.x || maxScroll.y !== newMaxScroll.y) {\n            setMaxScroll({ ...newMaxScroll });\n        }\n    };\n\n    const onMouseLeave = () => {\n        window.document.body.style.cursor = 'auto';\n    };\n\n    const onMouseDown = (e: MouseEvent) => {\n        if (e.button !== 0) {\n            return;\n        }\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n\n        // cancel selection\n        setSelectionInProgress(false);\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        if (x > canvasWidth || y > canvasHeight) {\n            return;\n        }\n\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    setButtonClickMouseDownCoordinates({ x, y, hitTarget });\n                    return;\n                }\n            }\n        }\n\n        if (y < columnHeaderHeight) {\n            for (let colIdx = 0; colIdx < columnSizes.index.length; colIdx++) {\n                const start = columnSizes.start[colIdx];\n                const end = columnSizes.end[colIdx];\n                const index = columnSizes.index[colIdx];\n                if (\n                    Math.abs(start - x) < resizeColumnRowMouseThreshold ||\n                    Math.abs(end - x) < resizeColumnRowMouseThreshold\n                ) {\n                    window.document.body.style.cursor = 'col-resize';\n                    const indices: number[] = [];\n                    if (selection.x1 !== -1 && selection.x2 !== -1 && selection.y1 === -1 && selection.y2 === -1) {\n                        const min = Math.min(selection.x1, selection.x2);\n                        const max = Math.max(selection.x1, selection.x2);\n                        for (let i = min; i <= max; i++) {\n                            indices.push(i);\n                        }\n                    }\n                    if (indices.length === 0) {\n                        indices.push(index);\n                    }\n                    setColumnResize({\n                        startX: end,\n                        oldWidth: cellWidth(index),\n                        colIndices: indices,\n                    });\n                    return;\n                }\n            }\n        }\n        if (x < rowHeaderWidth) {\n            for (let rowIdx = 0; rowIdx < rowSizes.index.length; rowIdx++) {\n                const start = rowSizes.start[rowIdx];\n                const end = rowSizes.end[rowIdx];\n                const index = rowSizes.index[rowIdx];\n                if (\n                    Math.abs(start - y) < resizeColumnRowMouseThreshold ||\n                    Math.abs(end - y) < resizeColumnRowMouseThreshold\n                ) {\n                    window.document.body.style.cursor = 'row-resize';\n                    const indices: number[] = [];\n                    if (selection.x1 === -1 && selection.x2 === -1 && selection.y1 !== -1 && selection.y2 !== -1) {\n                        const min = Math.min(selection.y1, selection.y2);\n                        const max = Math.max(selection.y1, selection.y2);\n                        for (let i = min; i <= max; i++) {\n                            indices.push(i);\n                        }\n                    }\n                    if (indices.length === 0) {\n                        indices.push(index);\n                    }\n                    setRowResize({\n                        startY: end,\n                        oldHeight: cellHeight(index),\n                        rowIndices: indices,\n                    });\n                    return;\n                }\n            }\n        }\n\n        // knob drag mode\n        if (Math.abs(x - knobCoordinates.x) < knobSize && Math.abs(y - knobCoordinates.y) < knobSize) {\n            setKnobDragInProgress(true);\n            setKnobArea({ x1: selection.x1, y1: selection.y1, x2: selection.x2, y2: selection.y2 });\n            return;\n        }\n\n        const sel2 = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        const sel1 = shiftKeyDown ? { x: selection.x1, y: selection.y1 } : { ...sel2 };\n\n        if (editMode) {\n            commitEditingCell();\n        }\n\n        let scrollToP2 = true;\n\n        if (x < rowHeaderWidth) {\n            //            sel2.x = dataOffset.x + 100;\n            scrollToP2 = false;\n            setRowSelectionInProgress(true);\n            sel1.x = -1;\n            sel2.x = -1;\n        } else {\n            setRowSelectionInProgress(false);\n        }\n\n        if (y < columnHeaderHeight) {\n            //            sel2.y = dataOffset.y + 100;\n            scrollToP2 = false;\n            setColumnSelectionInProgress(true);\n            sel1.y = -1;\n            sel2.y = -1;\n        } else {\n            setColumnSelectionInProgress(false);\n        }\n\n        setSelectionInProgress(true);\n        changeSelection(sel1.x, sel1.y, sel2.x, sel2.y, scrollToP2);\n        setEditCell({ x: -1, y: -1 });\n        setEditKey('');\n    };\n\n    const onMouseUp = (e: MouseEvent) => {\n        if (knobDragInProgress) {\n            let sx1 = selection.x1;\n            let sx2 = selection.x2;\n            if (selection.x1 > selection.x2) {\n                sx1 = selection.x2;\n                sx2 = selection.x1;\n            }\n            let sy1 = selection.y1;\n            let sy2 = selection.y2;\n            if (selection.y1 > selection.y2) {\n                sy1 = selection.y2;\n                sy2 = selection.y1;\n            }\n            let kx1 = knobArea.x1;\n            let kx2 = knobArea.x2;\n            if (knobArea.x1 > knobArea.x2) {\n                kx1 = knobArea.x2;\n                kx2 = knobArea.x1;\n            }\n            let ky1 = knobArea.y1;\n            let ky2 = knobArea.y2;\n            if (knobArea.y1 > knobArea.y2) {\n                ky1 = knobArea.y2;\n                ky2 = knobArea.y1;\n            }\n\n            let fx1 = kx1;\n            let fy1 = ky1;\n            let fx2 = kx2;\n            let fy2 = ky2;\n\n            const changes: Array<Change> = [];\n\n            if (fx2 - fx1 === sx2 - sx1) {\n                // vertical\n                if (fy1 === sy1) {\n                    fy1 = sy2 + 1;\n                } else {\n                    fy2 = sy1 - 1;\n                }\n                if (fx1 === -1 && fx2 === -1) {\n                    fx1 = 0;\n                    fx2 = maxSearchableRowOrCol;\n                }\n                let srcY = sy1;\n                for (let y = fy1; y <= fy2; y++) {\n                    for (let x = fx1; x <= fx2; x++) {\n                        const value = sourceData(x, srcY);\n                        changes.push({ x: x, y: y, value: value });\n                    }\n                    srcY = srcY + 1;\n                    if (srcY > sy2) {\n                        srcY = sy1;\n                    }\n                }\n            } else {\n                // horizontal\n                if (fx1 === sx1) {\n                    fx1 = sx2 + 1;\n                } else {\n                    fx2 = sx1 - 1;\n                }\n                if (fy1 === -1 && fy2 === -1) {\n                    fy1 = 0;\n                    fy2 = maxSearchableRowOrCol;\n                }\n                let srcX = sx1;\n                for (let x = fx1; x <= fx2; x++) {\n                    for (let y = fy1; y <= fy2; y++) {\n                        const value = sourceData(srcX, y);\n                        changes.push({ x: x, y: y, value: value });\n                    }\n                    srcX = srcX + 1;\n                    if (srcX > sx2) {\n                        srcX = sx1;\n                    }\n                }\n            }\n\n            if (props.onChange) {\n                props.onChange(changes);\n            }\n\n            changeSelection(knobArea.x1, knobArea.y1, knobArea.x2, knobArea.y2);\n        }\n        setSelectionInProgress(false);\n        setRowSelectionInProgress(false);\n        setColumnSelectionInProgress(false);\n        setKnobDragInProgress(false);\n        setColumnResize(null);\n        setRowResize(null);\n\n        if (\n            buttonClickMouseDownCoordinates.x !== -1 &&\n            buttonClickMouseDownCoordinates.y !== -1 &&\n            buttonClickMouseDownCoordinates.hitTarget !== null\n        ) {\n            if (!e.target || !(e.target instanceof Element)) {\n                return;\n            }\n            const rect = e.target.getBoundingClientRect();\n            const x = e.clientX - rect.left;\n            const y = e.clientY - rect.top;\n            const hitTarget = buttonClickMouseDownCoordinates.hitTarget;\n            if (\n                hitTarget.x <= x &&\n                x <= hitTarget.x + hitTarget.w &&\n                hitTarget.y <= y &&\n                y <= hitTarget.y + hitTarget.h\n            ) {\n                hitTarget.onClick(e);\n            }\n            setButtonClickMouseDownCoordinates({ x: -1, y: -1, hitTarget: null });\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('mouseup', onMouseUp as any);\n        return () => {\n            window.removeEventListener('mouseup', onMouseUp as any);\n        };\n    });\n\n    const onMouseMove = (e: MouseEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        window.document.body.style.cursor = 'auto';\n\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    window.document.body.style.cursor = 'pointer';\n                }\n            }\n        }\n\n        if (props.onCellWidthChange && y < columnHeaderHeight) {\n            let xx = rowHeaderWidth;\n            for (const col of columnSizes.index) {\n                if (Math.abs(xx - x) < resizeColumnRowMouseThreshold) {\n                    window.document.body.style.cursor = 'col-resize';\n                    break;\n                }\n                xx += cellWidth(col);\n            }\n        }\n\n        if (props.onCellHeightChange && x < rowHeaderWidth) {\n            let yy = columnHeaderHeight;\n            for (const row of rowSizes.index) {\n                if (Math.abs(yy - y) < resizeColumnRowMouseThreshold) {\n                    window.document.body.style.cursor = 'row-resize';\n                    break;\n                }\n                yy += cellHeight(row);\n            }\n        }\n\n        if (Math.abs(x - knobCoordinates.x) < knobSize && Math.abs(y - knobCoordinates.y) < knobSize) {\n            window.document.body.style.cursor = 'crosshair';\n        }\n\n        if (columnResize) {\n            if (props.onCellWidthChange) {\n                const newWidth = Math.max(columnResize.oldWidth + x - columnResize.startX, minimumColumnWidth);\n                props.onCellWidthChange(columnResize.colIndices, newWidth);\n            }\n            return;\n        }\n\n        if (rowResize) {\n            if (props.onCellHeightChange) {\n                const newHeight = Math.max(rowResize.oldHeight + y - rowResize.startY, minimumRowHeight);\n                props.onCellHeightChange(rowResize.rowIndices, newHeight);\n            }\n            return;\n        }\n\n        if (selectionInProgress) {\n            const sel2 = absCoordianteToCell(x, y, rowSizes, columnSizes);\n            if (rowSelectionInProgress) {\n                changeSelection(-1, selection.y1, -1, sel2.y, false);\n            } else if (columnSelectionInProgress) {\n                changeSelection(selection.x1, -1, sel2.x, -1, false);\n            } else {\n                changeSelection(selection.x1, selection.y1, sel2.x, sel2.y);\n            }\n        }\n\n        if (knobDragInProgress) {\n            window.document.body.style.cursor = 'crosshair';\n            const cell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x2;\n            let y2 = selection.y2;\n            if (x1 > x2) {\n                x1 = selection.x2;\n                x2 = selection.x1;\n            }\n            if (y1 > y2) {\n                y1 = selection.y2;\n                y2 = selection.y1;\n            }\n\n            // check if vertical or horizontal\n            let xCellDiff = 0; // zero or less\n            if (cell.x < x1) xCellDiff = cell.x - x1;\n            if (cell.x > x2) xCellDiff = x2 - cell.x;\n            let yCellDiff = 0; // zero or less\n            if (cell.y < y1) yCellDiff = cell.y - y1;\n            if (cell.y > y2) yCellDiff = y2 - cell.y;\n\n            if ((x1 === -1 && x2 === -1) || xCellDiff > yCellDiff) {\n                if (cell.y < y1) {\n                    y1 = cell.y;\n                } else {\n                    y2 = cell.y;\n                }\n            } else {\n                if (cell.x < x1) {\n                    x1 = cell.x;\n                } else {\n                    x2 = cell.x;\n                }\n            }\n            setKnobArea({ x1: x1, y1: y1, x2: x2, y2: y2 });\n        }\n    };\n\n    const onDoubleClick = (e: MouseEvent) => {\n        e.preventDefault();\n        if (!e.target || !(e.target instanceof Element) || shiftKeyDown) {\n            return;\n        }\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n\n        // check if we clicked on a button and don't start editing if we did\n        const hitTargetKeyX = Math.floor(x / xBinSize);\n        const hitTargetKeyY = Math.floor(y / yBinSize);\n\n        if (hitMap[hitTargetKeyX] && hitMap[hitTargetKeyX][hitTargetKeyY]) {\n            for (const hitTarget of hitMap[hitTargetKeyX][hitTargetKeyY]) {\n                if (\n                    hitTarget.x <= x &&\n                    x <= hitTarget.x + hitTarget.w &&\n                    hitTarget.y <= y &&\n                    y <= hitTarget.y + hitTarget.h\n                ) {\n                    return;\n                }\n            }\n        }\n        const editCell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        setArrowKeyCommitMode(false);\n        startEditingCell(editCell);\n    };\n\n    const onKeyDown = (e: KeyboardEvent) => {\n        if (e.key === 'Escape') {\n            setEditCell({ x: -1, y: -1 });\n            setEditKey('');\n            return;\n        }\n        if (e.key === 'Enter') {\n            commitEditingCell();\n            changeSelection(selection.x1, selection.y1 + 1, selection.x1, selection.y1 + 1);\n        }\n        if (e.key === 'Tab') {\n            e.preventDefault();\n            commitEditingCell();\n            changeSelection(selection.x1 + 1, selection.y1, selection.x1 + 1, selection.y1);\n        }\n        if (arrowKeyCommitMode && ['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            e.preventDefault();\n            commitEditingCell();\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x1;\n            let y2 = selection.y1;\n            if (e.key === 'ArrowRight') {\n                x1 = selection.x1 + 1;\n                x2 = selection.x1 + 1;\n            } else if (e.key === 'ArrowLeft') {\n                x1 = selection.x1 - 1;\n                x2 = selection.x1 - 1;\n            } else if (e.key === 'ArrowUp') {\n                y1 = selection.y1 - 1;\n                y2 = selection.y1 - 1;\n            } else if (e.key === 'ArrowDown') {\n                y1 = selection.y1 + 1;\n                y2 = selection.y1 + 1;\n            }\n            changeSelection(x1, y1, x2, y2);\n        }\n    };\n\n    const onGridKeyDown = (e: KeyboardEvent) => {\n        if (editMode && arrowKeyCommitMode && ['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            commitEditingCell();\n            return;\n        }\n\n        if (e.key === 'Shift') {\n            setShiftKeyDown(true);\n            return;\n        }\n\n        if ((e.metaKey || e.ctrlKey) && String.fromCharCode(e.which).toLowerCase() === 'v') {\n            return;\n        }\n\n        // copy\n        if ((e.metaKey || e.ctrlKey) && String.fromCharCode(e.which).toLowerCase() === 'c') {\n            return;\n        }\n\n        if (e.key === 'Backspace' || e.key === 'Delete') {\n            let x1 = selection.x1;\n            let y1 = selection.y1;\n            let x2 = selection.x2;\n            let y2 = selection.y2;\n            if (x1 > x2) {\n                x1 = selection.x2;\n                x2 = selection.x1;\n            }\n            if (y1 > y2) {\n                y1 = selection.y2;\n                y2 = selection.y1;\n            }\n            if (x1 === -1 && x2 === -1 && y1 !== -1 && y2 !== -1) {\n                x1 = 0;\n                x2 = maxSearchableRowOrCol;\n            }\n            if (x1 !== -1 && x2 !== -1 && y1 === -1 && y2 === -1) {\n                y1 = 0;\n                y2 = maxSearchableRowOrCol;\n            }\n            const changes: Change[] = [];\n            for (let y = y1; y <= y2; y++) {\n                for (let x = x1; x <= x2; x++) {\n                    changes.push({ x: x, y: y, value: null });\n                }\n            }\n            if (props.onChange) {\n                props.onChange(changes);\n            }\n            return;\n        }\n\n        // nothing selected\n        if (selection.x1 === -1 || selection.x2 === -1 || selection.y1 === -1 || selection.y2 === -1) {\n            return;\n        }\n\n        if (\n            (e.keyCode >= 48 && e.keyCode <= 57) ||\n            (e.keyCode >= 96 && e.keyCode <= 105) ||\n            (e.keyCode >= 65 && e.keyCode <= 90) ||\n            e.key === 'Enter' ||\n            e.key === '-' ||\n            e.key === '.' ||\n            e.key === ','\n        ) {\n            if (cellReadOnly(selection.x1, selection.y1)) {\n                e.preventDefault(); // so we dont get keystrokes inside the text area\n                return;\n            }\n\n            startEditingCell({ x: selection.x1, y: selection.y1 });\n            setArrowKeyCommitMode(e.key !== 'Enter');\n            return;\n        }\n\n        if (['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n            let sel1 = { x: selection.x1, y: selection.y1 };\n            let sel2 = { x: selection.x2, y: selection.y2 };\n\n            let incr = { x: 0, y: 0 };\n            let direction: 'up' | 'down' | 'left' | 'right' = 'right';\n            if (e.key === 'ArrowRight' || e.key === 'Tab') {\n                incr.x = 1;\n                direction = 'right';\n            } else if (e.key === 'ArrowLeft') {\n                incr.x = -1;\n                direction = 'left';\n            } else if (e.key === 'ArrowUp') {\n                incr.y = -1;\n                direction = 'up';\n            } else if (e.key === 'ArrowDown') {\n                incr.y = 1;\n                direction = 'down';\n            }\n\n            if (e.metaKey || e.ctrlKey) {\n                const val = findInDisplayData(displayData, sel2, direction);\n                incr.x = val.x - sel2.x;\n                incr.y = val.y - sel2.y;\n            }\n\n            sel2.x += incr.x;\n            sel2.y += incr.y;\n\n            if (sel2.x < 0) {\n                sel2.x = 0;\n            }\n            if (sel2.y < 0) {\n                sel2.y = 0;\n            }\n            if (!e.shiftKey) {\n                sel1 = { ...sel2 };\n            }\n            changeSelection(sel1.x, sel1.y, sel2.x, sel2.y);\n            return;\n        }\n        e.preventDefault();\n    };\n\n    const onGridKeyUp = (e: KeyboardEvent) => {\n        setShiftKeyDown(e.shiftKey);\n    };\n\n    const onContextMenu = (e: MouseEvent) => {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n\n        const rect = e.target.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n        const cell = absCoordianteToCell(x, y, rowSizes, columnSizes);\n        const cellX = cell.x;\n        const cellY = cell.y;\n        let { x1, x2, y1, y2 } = selection;\n        if (x1 > x2) [x1, x2] = [x2, x1];\n        if (y1 > y2) [y1, y2] = [y2, y1];\n\n        if (!(y > columnHeaderHeight && x > rowHeaderWidth)) {\n            return;\n        }\n        //if click is not inside of selection, select the right clicked cell\n        if (!(cellX >= x1 && cellX <= x2) || !(cellY >= y1 && cellY <= y2)) {\n            changeSelection(cellX, cellY, cellX, cellY);\n        }\n\n        onMouseMove(e);\n        const ev: SheetMouseEvent = {\n            ...e,\n            cellX,\n            cellY,\n        };\n        props.onRightClick?.(ev);\n    };\n\n    const editMode = editCell.x !== -1 && editCell.y !== -1;\n    let editTextPosition = { x: 0, y: 0 };\n    let editTextWidth = 0;\n    let editTextHeight = 0;\n    let editTextTextAlign: 'right' | 'left' | 'center' = 'right';\n    if (editMode) {\n        editTextPosition = cellToAbsCoordinate(\n            editCell.x,\n            editCell.y,\n            rowSizes,\n            columnSizes,\n            dataOffset,\n            cellWidth,\n            cellHeight\n        );\n        const style = cellStyle(editCell.x, editCell.y);\n        // add 1 so it doesnt cover the selection border\n        editTextPosition.x += 1;\n        editTextPosition.y += 1;\n        editTextWidth = cellWidth(editCell.x) - 2;\n        editTextHeight = cellHeight(editCell.y) - 2;\n        editTextTextAlign = style.textAlign || defaultCellStyle.textAlign || 'left';\n    }\n\n    const inputProps = {\n        value: editValue,\n        autoFocus: true,\n        onKeyDown: onKeyDown,\n        style: {\n            position: 'absolute',\n            top: editTextPosition.y,\n            left: editTextPosition.x,\n            width: editTextWidth,\n            height: editTextHeight,\n            outline: 'none',\n            border: 'none',\n            textAlign: editTextTextAlign,\n            color: 'black',\n            fontSize: defaultCellStyle.fontSize,\n            fontFamily: 'sans-serif',\n        } as InputStyle,\n    };\n\n    const input = props.inputComponent?.(\n        editCell.x,\n        editCell.y,\n        { ...inputProps, onChange: setEditValue } as SheetInputProps,\n        commitEditingCell\n    );\n\n    return (\n        <div style={{ position: 'relative', height: '100%' }}>\n            <canvas\n                style={{\n                    width: 'calc(100% - 14px)',\n                    height: 'calc(100% - 15px)',\n                    outline: '1px solid #ddd', // find another better solution ?\n                }}\n                ref={canvasRef}\n            />\n            <div\n                ref={overlayRef}\n                onDoubleClick={onDoubleClick}\n                onMouseDown={onMouseDown}\n                onMouseMove={onMouseMove}\n                onMouseLeave={onMouseLeave}\n                onContextMenu={onContextMenu}\n                onScroll={onScroll}\n                className={styles.sheetscroll}\n                style={{\n                    position: 'absolute',\n                    width: '100%',\n                    height: '100%',\n                    top: 0,\n                    left: 0,\n                    overflow: 'scroll',\n                    borderBottom: '1px solid #ddd',\n                }}\n            >\n                <div\n                    style={{\n                        position: 'absolute',\n                        left: 0,\n                        top: 0,\n                        width: 1,\n                        height: maxScroll.y + 2000,\n                        backgroundColor: 'rgba(0,0,0,0.0)',\n                    }}\n                ></div>\n                <div\n                    style={{\n                        position: 'absolute',\n                        left: 0,\n                        top: 0,\n                        width: maxScroll.x + 5000,\n                        height: 1,\n                        backgroundColor: 'rgba(0,0,0,0.0)',\n                    }}\n                ></div>\n            </div>\n            <textarea\n                style={{ position: 'absolute', top: 0, left: 0, width: 1, height: 1, opacity: 0.01 }}\n                ref={copyPasteTextAreaRef}\n                autoComplete=\"off\"\n                autoCorrect=\"off\"\n                autoCapitalize=\"off\"\n                spellCheck=\"false\"\n                onFocus={(e) => e.target.select()}\n                tabIndex={0}\n                onKeyDown={onGridKeyDown}\n                onKeyUp={onGridKeyUp}\n            ></textarea>\n            {editMode &&\n                (input !== undefined ? (\n                    input\n                ) : (\n                    <input\n                        {...inputProps}\n                        type=\"text\"\n                        onFocus={(e) => e.target.select()}\n                        onChange={(e) => setEditValue(e.target.value)}\n                    />\n                ))}\n        </div>\n    );\n}\n\nexport default Sheet;\n","import React, { useState } from 'react';\nimport Sheet from 'sheet-happens';\nimport 'sheet-happens/dist/index.css';\n\nconst initialDataBig = [];\nfor (let row = 0; row < 1000; row++) {\n    const r = [];\n    for (let col = 0; col < 100; col++) {\n        r.push(`Row: ${row}, Col: ${col}`);\n    }\n    initialDataBig.push(r);\n}\n\nconst initialDataBasic = [\n    ['First', 'Second', 'Third', 'Fourth', 'Fifth', 'Sixth'],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n    [1, 2, 3, 4, 5, 6],\n];\n\nconst initialDataFormatting = [];\nfor (let row = 0; row < 1000; row++) {\n    const r = [];\n    for (let col = 0; col < 100; col++) {\n        r.push(Math.random() * 1000000);\n    }\n    initialDataFormatting.push(r);\n}\n\nconst triangleDown = new Image();\ntriangleDown.src =\n    'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=';\ntriangleDown.width = 10;\ntriangleDown.height = 10;\n\nexport const DEFAULT_CELL_WIDTH = 100;\nexport const DEFAULT_CELL_HEIGHT = 22;\n\nexport default function useWidthHeigthControl(initialWidths = [], initialHeights = []) {\n    const [cellWidth, setCellWidth] = useState(initialWidths);\n    const [cellHeight, setCellHeight] = useState(initialHeights);\n\n    const onCellWidthChange = (indices, newWidth) => {\n        const cw = [...cellWidth];\n        for (const idx of indices) {\n            if (idx > cw.length) {\n                for (let i = cw.length; i <= idx; i++) {\n                    cw.push(DEFAULT_CELL_WIDTH);\n                }\n            }\n            cw[idx] = newWidth;\n        }\n        setCellWidth(cw);\n    };\n\n    const onCellHeightChange = (indices, newHeight) => {\n        const ch = [...cellHeight];\n        for (const idx of indices) {\n            if (idx > ch.length) {\n                for (let i = ch.length; i <= idx; i++) {\n                    ch.push(DEFAULT_CELL_HEIGHT);\n                }\n            }\n            ch[idx] = newHeight;\n        }\n        setCellHeight(ch);\n    };\n\n    return { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight };\n}\n\nexport function SheetBoxHeader() {\n    const [data, setData] = useState(initialDataBig);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxBasic() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(initialDataBasic)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}\n\nconst faCheck = new Image();\nfaCheck.src =\n    'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==';\nfaCheck.width = 16;\nfaCheck.height = 16;\n\nexport function SheetBoxStyle() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(initialDataBasic)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = (index) => {\n        if (index === 0) {\n            return {\n                items: [\n                    {\n                        content: 'A',\n                        x: 0,\n                        y: 0,\n                        horiozntalAlign: 'center',\n                    },\n                    {\n                        content: triangleDown,\n                        x: 0,\n                        y: -6,\n                        width: 12,\n                        height: 12,\n                        horiozntalAlign: 'right',\n                        onClick: () => {\n                            console.log('click');\n                        },\n                    },\n                ],\n            };\n        } else {\n            return null;\n        }\n    };\n    const colors = ['#f00', '#0f0', '#00f', '#000'];\n    const alignment = ['left', 'right', 'center'];\n    const weight = ['normal', 'bold', 'lighter'];\n    const marginRight = [0, 0, 0, 0, 20];\n    const cellStyle = (x, y) => {\n        if (x === 0 || y === 0) {\n            return {\n                fillColor: '#6DA2FB22',\n                marginRight: 10,\n            };\n        }\n        return {\n            color: colors[y % 4],\n            textAlign: alignment[x % 3],\n            marginRight: marginRight[x % 5],\n            weight: weight[y % 3],\n        };\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const incrementCell = (x, y) => {\n        const newData = [...data];\n        if (newData[y] && newData[y][x] !== undefined) {\n            newData[y][x] += 1;\n        }\n        setData(newData);\n    };\n    const displayData = (x, y) => {\n        if (x === 0 && y > 0 && y < 9) {\n            return {\n                items: [\n                    {\n                        content: faCheck,\n                        x: 0,\n                        y: -8,\n                        width: 16,\n                        height: 16,\n                        horiozntalAlign: 'right',\n                        onClick: () => {\n                            incrementCell(x, y);\n                        },\n                    },\n                    {\n                        content: data?.[y]?.[x],\n                        x: 0,\n                        y: 0,\n                        horiozntalAlign: 'left',\n                    },\n                ],\n            };\n        }\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={1}\n                freezeRows={1}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxFormatting() {\n    const [data, setData] = useState(initialDataFormatting);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x]?.toFixed?.(2);\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = Number(change.value);\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}\n\nexport function SheetBoxVeryBigData() {\n    const [loadingStatus, setLoadingStatus] = useState('initial');\n    const [data, setData] = useState([]);\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const loadClick = (e) => {\n        e.preventDefault();\n        setLoadingStatus('loading');\n        fetch('./out.json')\n            .then((response) => {\n                return response.json();\n            })\n            .then((dataset) => {\n                setData(dataset);\n                setLoadingStatus('done');\n            });\n    };\n\n    const cellStyle = (x, y) => {\n        if (y === 0) {\n            return {\n                weight: 'bold',\n                fontSize: 14,\n            };\n        }\n        if (x === 4) {\n            return {\n                textAlign: 'right',\n            };\n        } else if (x === 1) {\n            return {\n                weight: 'bold',\n                color: '#3b85ff',\n            };\n        } else if (x === 2) {\n            return {\n                color: '#fc3bff',\n            };\n        }\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        if (x === 4 && y > 0) {\n            if (data && data[y] && data[y][x]) {\n                return Number(data[y][x]).toFixed(2);\n            } else {\n                return '';\n            }\n        }\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    const headerStyle = (index) => {\n        const r = ((index * 2421) % 255).toString(16).padStart(2, '0');\n        const g = ((index * 3215) % 255).toString(16).padStart(2, '0');\n        const b = ((index * 1243) % 255).toString(16).padStart(2, '0');\n        const color = `#${r}${g}${b}55`;\n        return {\n            backgroundColor: color,\n        };\n    };\n\n    const columnHeaders = (index) => {\n        return '' + index;\n    };\n\n    return (\n        <>\n            {loadingStatus === 'initial' ? (\n                <a href=\"#\" onClick={loadClick}>\n                    Load global database of power plants\n                </a>\n            ) : loadingStatus === 'loading' ? (\n                'Loading...'\n            ) : null}\n            <div className=\"sheet-box\">\n                <Sheet\n                    cellStyle={cellStyle}\n                    editData={editData}\n                    displayData={displayData}\n                    sourceData={sourceData}\n                    cellWidth={cellWidth}\n                    cellHeight={cellHeight}\n                    onChange={onChange}\n                    readOnly={isReadOnly}\n                    onCellWidthChange={onCellWidthChange}\n                    onCellHeightChange={onCellHeightChange}\n                    columnHeaderStyle={headerStyle}\n                    columnHeaders={columnHeaders}\n                    freezeColumns={0}\n                    freezeRows={1}\n                />\n            </div>\n        </>\n    );\n}\n\nconst customInputOptions = ['First', 'Second', 'Third', 'Fourth', 'Fifth'];\nconst customInputOptions2 = ['Sixth', 'Seventh', 'Eighth', 'Ninth', 'Tenth'];\nconst customInputData = [\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n    customInputOptions2,\n    customInputOptions,\n];\n\nexport function SheetBoxCustomInput() {\n    const [data, setData] = useState(JSON.parse(JSON.stringify(customInputData)));\n    const { onCellWidthChange, onCellHeightChange, cellWidth, cellHeight } = useWidthHeigthControl();\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n                inputComponent={CustomInput}\n            />\n        </div>\n    );\n}\n\nfunction CustomInput(x, y, inputProps, commitEditingCell) {\n    const clickHandler = (value) => {\n        commitEditingCell(value);\n    };\n\n    return (\n        <div style={{ ...inputProps.style, backgroundColor: '#fff' }}>\n            <div style={{ border: '1px solid #ddd', boxShadow: '3px 5px 5px #ddd' }}>\n                {(y % 2 ? customInputOptions2 : customInputOptions).map((opt) => {\n                    return (\n                        <CustomOption\n                            key={opt}\n                            opt={opt}\n                            value={inputProps.value}\n                            clickHandler={() => clickHandler(opt)}\n                        />\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n\nfunction CustomOption({ opt, value, clickHandler }) {\n    const [hover, setHover] = useState(false);\n\n    return (\n        <div\n            onMouseEnter={() => {\n                setHover(true);\n            }}\n            onMouseLeave={() => {\n                setHover(false);\n            }}\n            style={{\n                backgroundColor: value === opt || hover ? '#f6f6f6' : '#fff',\n                padding: '5px 10px',\n                cursor: 'pointer',\n            }}\n            value={opt}\n            onClick={() => clickHandler(opt)}\n        >\n            {opt}\n        </div>\n    );\n}\n\nexport function SheetBoxSourceDisplayData() {\n    const [data] = useState([\n        [1, 2, 3],\n        [10, 20, 30],\n    ]);\n\n    const displayData = (x, y) => {\n        return data?.[y]?.[x]?.toFixed?.(2);\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                sourceData={data} // array of arrays of data\n                displayData={displayData}\n            />\n        </div>\n    );\n}\n","import React from 'react';\nimport { useRef, useState } from 'react';\nimport { SheetBoxHeader } from './SheetBox';\nimport GitIcon from '../assets/git.svg';\n\nfunction Header() {\n    const textAreaRef = useRef(null);\n    const [copySuccess, setCopySuccess] = useState('');\n\n    const copyToClipboard = (e) => {\n        textAreaRef.current.select();\n        document.execCommand('copy');\n        e.target.focus();\n        setCopySuccess('Copied!');\n        setTimeout(() => {\n            setCopySuccess('');\n        }, 1000);\n    };\n\n    return (\n        <div className=\"container blue-bg\" id=\"home\">\n            <div className=\"content flex-row header\">\n                <div className=\"box text-box\">\n                    <div>\n                        <h1>Beautiful and fast spreadsheet component for React</h1>\n                        <p className=\"lightblue-p\">\n                            Sheet Happens is easy to implement and extend.\n                            <br></br>\n                            And it's super fast.\n                        </p>\n                    </div>\n                    <div className=\"lib-box\">\n                        <div className=\"install-box\" onClick={copyToClipboard}>\n                            <input readOnly ref={textAreaRef} value=\"npm install --save sheet-happens\" />\n                            {copySuccess !== '' && <div className=\"copy-success\">{copySuccess}</div>}\n                        </div>\n                        <a\n                            href=\"https://github.com/farseerdev/sheet-happens\"\n                            rel=\"noopener noreferrer\"\n                            className=\"git-box\"\n                            target=\"_blank\"\n                        >\n                            <img src={GitIcon} alt=\"Git\" />\n                            view on github\n                        </a>\n                    </div>\n                </div>\n                <div className=\"box\">\n                    <SheetBoxHeader />\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Header;\n","import React from 'react';\n\nfunction TitleSeparator({ title, id }) {\n    return (\n        <div className=\"title-separator\" id={id ? id : ''}>\n            <p>{title ? title : 'No title'}</p>\n            <div className=\"separator\"></div>\n        </div>\n    );\n}\n\nexport default TitleSeparator;\n","import React from 'react';\n\nfunction Wrap({ children }) {\n    return (\n        <div className=\"container\">\n            <div className=\"content flex-row\">{children}</div>\n        </div>\n    );\n}\n\nexport default Wrap;\n","import React from 'react';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\nimport { xcode } from 'react-syntax-highlighter/dist/esm/styles/hljs';\nxcode.hljs.padding = '10px 20px';\nxcode.hljs.background = '#f8f9fa';\nxcode.hljs.width = '100%';\nxcode.hljs.maxWidth = '100%';\nxcode.hljs.overflow = 'auto';\nxcode.hljs.borderRadius = '3px';\nxcode.hljs.fontSize = '14px';\n\nfunction Code() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`function SheetBox() {\n    const [data, setData] = useState(initialData);\n    const [cellWidth, setCellWidth] = useState([]);\n    const [cellHeight, setCellHeight] = useState([]);\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    const onCellWidthChange = (columnIdx, newWidth) => {\n        const cw = [...cellWidth];\n        if (columnIdx > cw.length) {\n            for (let i = cw.length; i <= columnIdx; i++) {\n                cw.push(100);\n            }\n        }\n        cw[columnIdx] = newWidth;\n        setCellWidth(cw);\n    };\n    const onCellHeightChange = (rowIdx, newHeight) => {\n        const ch = [...cellHeight];\n        if (rowIdx > ch.length) {\n            for (let i = ch.length; i <= rowIdx; i++) {\n                ch.push(22);\n            }\n        }\n        ch[rowIdx] = newHeight;\n        setCellHeight(ch);\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport default Code;\n\nexport function SourceDisplayDataCode() {\n    let xcode2 = { ...xcode };\n    xcode2.hljs.height = '100%';\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode2}>\n            {`const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function InitSheetCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function InitSheetWithDataCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function EditDataCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n\nexport function CellStyleSizeCode() {\n    return (\n        <SyntaxHighlighter language=\"javascript\" style={xcode}>\n            {`...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);`}\n        </SyntaxHighlighter>\n    );\n}\n","import React from 'react';\n\nfunction Footer() {\n    return (\n        <div className=\"footer\">\n            <p className=\"copy\">made by <a href=\"https://www.farseer.io\">farseer</a></p>\n        </div>\n    );\n}\n\nexport default Footer;\n","import React from 'react';\nimport './index.css';\n\nimport Menu from './components/Menu';\nimport Header from './components/Header';\nimport TitleSeparator from './components/TitleSeparator';\nimport Wrap from './components/Wrap';\nimport {\n    InitSheetCode,\n    InitSheetWithDataCode,\n    SourceDisplayDataCode,\n    EditDataCode,\n    CellStyleSizeCode,\n} from './components/Code';\nimport {\n    SheetBoxStyle,\n    SheetBoxBasic,\n    SheetBoxFormatting,\n    SheetBoxVeryBigData,\n    SheetBoxCustomInput,\n    SheetBoxSourceDisplayData,\n} from './components/SheetBox';\nimport Footer from './components/Footer';\n\nconst App = () => {\n    return (\n        <>\n            <Menu />\n            <Header />\n\n            <TitleSeparator title=\"Get started\" id=\"usage\" />\n            <Wrap>\n                <div className=\"box full-width colored-pre\" style={{ overflowX: 'auto' }}>\n                    <p>Import the component and its style, and render it</p>\n                    <InitSheetCode />\n\n                    <div className=\"spacer\" />\n\n                    <p>Display some data</p>\n                    <InitSheetWithDataCode />\n                </div>\n            </Wrap>\n\n            <TitleSeparator title=\"Learn more about features\" id=\"features\" />\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxBasic />\n                </div>\n                <div className=\"box\">\n                    <h3>Basic spreadsheet</h3>\n                    <p>\n                        It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by\n                        dragging the small square, copy/paste from and to Excel and Google Sheets, resize columns and\n                        rows.\n                    </p>\n                </div>\n            </Wrap>\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxStyle />\n                </div>\n                <div className=\"box\">\n                    <h3>Styling</h3>\n                    <p>\n                        You can change the cell color, alignment, font weight, margins and more. It's also possible to\n                        freeze first rows or columns, and add clickable images.\n                    </p>\n                </div>\n            </Wrap>\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxFormatting />\n                </div>\n                <div className=\"box\">\n                    <h3>Formatting</h3>\n                    <p>\n                        Sheet Happens uses different datasets for display and edit so you can apply different formatting\n                        when displaying the cell and editing the cell.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Big dataset example\" id=\"big dataset example\" />\n            <Wrap>\n                <div className=\"box full-width\">\n                    <p>\n                        Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it\n                        will be handled blazingly fast and super responsive because component is canvas-based and it\n                        draws only the small chunk of data user sees at the moment.\n                    </p>\n                    <br />\n                    <SheetBoxVeryBigData />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Custom input fields\" id=\"custom input example\" />\n            <Wrap>\n                <div className=\"box\">\n                    <SheetBoxCustomInput />\n                </div>\n                <div className=\"box\">\n                    <h3>Custom input component</h3>\n                    <p>\n                        If basic text input isn't enough, you can send your own React component to be displayed instead.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <TitleSeparator title=\"Documentation\" id=\"documentation\" />\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* sourceData displayData */}\n                    <h3>Displaying data</h3>\n                    <p>\n                        If you have some data you want to display, you send it via <Emphased text=\"sourceData\" /> and{' '}\n                        <Emphased text=\"displayData\" /> props.\n                    </p>\n                    <p>\n                        The first one receives unformatted data which is used for data manipulation, and the second one\n                        formatted which is used for displaying in cells.\n                    </p>\n                    <br />\n                    <p>\n                        Each of this can be either array of arrays of values (where each array is representing data for\n                        one row) or function (which returns value based on x and y coordinates that are sent as\n                        arguments to your function).\n                    </p>\n                </div>\n            </Wrap>\n\n            <Wrap>\n                <div className=\"box colored-pre unmargin-pre\" style={{ maxWidth: '100%', overflow: 'auto' }}>\n                    <SourceDisplayDataCode />\n                </div>\n                <div className=\"box\">\n                    <SheetBoxSourceDisplayData />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box\">\n                    {/*editData onChange readOnly */}\n                    <h3>Editing data</h3>\n                    <p>\n                        Same as the previous two, prop <Emphased text=\"editData\" /> can recieve either array of arrays\n                        of values or function for data which will be displayed in edit mode. Edit mode is activated by\n                        double click on the cell.\n                    </p>\n                    <br />\n                    <p>\n                        Once edit is done, function sent in <Emphased text=\"onChange\" /> prop will be called with array\n                        of changes as an argument. Each element of this array has value, x and y coordinates. Use this\n                        information to change values in your data array.\n                    </p>\n                    <br />\n                    <p>\n                        Sheet also accepts <Emphased text=\"readOnly\" /> prop which you can use if some cells should not\n                        be editable. Same as the most of sheet's props, you can send function, array of arrays, or a\n                        single value which then is applied to the whole table.\n                    </p>\n                </div>\n\n                <div className=\"box unmargin-pre\">\n                    <EditDataCode />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* columnHeaders */}\n                    <h3>Column headers</h3>\n                    <p>\n                        By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via{' '}\n                        <Emphased text=\"columnHeaders\" /> prop as an array or function.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box\">\n                    {/* cellStyle cellWidth cellHeight onCellWidthChange onCellHeightChange */}\n                    <h3>Cell style and width/height</h3>\n                    <p>\n                        Use prop <Emphased text=\"cellStyle\" /> and <Emphased text=\"columnHeaderStyle\" /> for customizing\n                        cells visually.\n                    </p>\n                    <br />\n                    <p>\n                        You can also use <Emphased text=\"cellWidth\" /> and <Emphased text=\"cellHeight\" /> props to\n                        customize cell size. If you send single value {`cellWidth={200}`}, it will be applayed to all\n                        cells. If you send array of values {`cellWidth={[200, 80, 80]}`}, they will be applied in\n                        respect to the index number.\n                    </p>\n                    <br />\n                    <p>\n                        There are also <Emphased text=\"onCellWidthChange\" /> and <Emphased text=\"onCellHeightChange\" />{' '}\n                        props for functions which are called when user drags cell for resize. You can use these for\n                        updating your cellWidth/cellHeight arrays.\n                    </p>\n                </div>\n                <div className=\"box unmargin-pre\">\n                    <CellStyleSizeCode />\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* onSelectionChanged */}\n                    <h3>Selection</h3>\n                    <p>\n                        You can send function to <Emphased text=\"onSelectionChanged\" /> prop. It will be called on\n                        selection change with x1, y1, x2 and y2 arguments.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* onRightClick */}\n                    <h3>Right click handler</h3>\n                    <p>\n                        If you send a function to <Emphased text=\"onRightClick\" /> prop, it will be called on right\n                        click with whole mouse event (extended with cellX and cellY values) as an argument.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* freezeColumns freezeRows */}\n                    <h3>Sticky columns/rows</h3>\n                    <p>\n                        Send a number to <Emphased text=\"freezeColumns\" /> and/or <Emphased text=\"freezeRows\" /> to make\n                        first n of columns/rows sticky.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Wrap>\n                <div className=\"box full-width\">\n                    {/* inputComponent */}\n                    <h3>Custom input</h3>\n                    <p>\n                        By default edit mode turns cell into text edit component. But you can send your custom input\n                        component via <Emphased text=\"inputComponent\" /> props. It will be called with{' '}\n                        <Emphased text=\"x\" />, <Emphased text=\"y\" />, <Emphased text=\"inputProps\" /> and{' '}\n                        <Emphased text=\"commitEditingCell\" /> arguments.\n                    </p>\n                </div>\n            </Wrap>\n\n            <div className=\"spacer\" />\n\n            <Footer />\n        </>\n    );\n};\n\nfunction Emphased({ text }) {\n    return <span className=\"emphased\">{text}</span>;\n}\n\nexport default App;\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}