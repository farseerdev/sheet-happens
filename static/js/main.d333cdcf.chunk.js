(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{10:function(e,t,n){e.exports=n.p+"static/media/logo.aef13910.svg"},12:function(e,t,n){e.exports=n.p+"static/media/git.f818b886.svg"},17:function(e,t,n){e.exports=n(230)},22:function(e,t,n){},230:function(e,t,n){"use strict";n.r(t);n(5);var a=n(0),l=n.n(a),r=n(9),o=n.n(r),i=n(10),c=n.n(i);var s=function(){const e=e=>{var t=document.getElementById(e),n="home"===e?0:86,a=window.pageYOffset+t.getBoundingClientRect().top-n;window.scrollTo({top:a,behavior:"smooth"})};return l.a.createElement("div",{className:"container blue-bg menu"},l.a.createElement("div",{className:"content flex-row"},l.a.createElement("div",{className:"logo-box"},l.a.createElement("img",{src:c.a,alt:"Logo"}),l.a.createElement("h2",{className:"page-title"},"sheet - happens")),l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"nav-item",onClick:()=>e("home")},"home"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("usage")},"usage"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("features")},"features"),l.a.createElement("div",{className:"nav-item",onClick:()=>e("documentation")},"documentation"))))},u=n(1),d=n(3),f=n(11);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function v(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var x="_PxIi8";function g(e){var t=e.getBoundingClientRect(),n=t.width,a=t.height,l=window.devicePixelRatio,r=void 0===l?1:l;r<1&&(r=1);var o=Math.round(n*r),i=Math.round(a*r);if(e.width!==o||e.height!==i){var c=e.getContext("2d");return e.width=o,e.height=i,c.scale(r,r),!0}return!1}function m(e,t){return function(n){return Array.isArray(e)?n>=0&&n<e.length?e[n]:t:"function"===typeof e?e(n):"number"===typeof e?e:t}}function p(e,t){return function(n,a){return Array.isArray(e)?a>=0&&a<e.length&&n>=0&&n<e[a].length?e[a][n]:t:"function"===typeof e?e(n,a):null!==e&&void 0!==e?e:t}}function b(e,t,n,a,l,r,o,i){n.color=n.color||a.color,n.fontSize=n.fontSize||a.fontSize,n.fontFamily=n.fontFamily||a.fontFamily,n.textAlign=n.textAlign||a.textAlign,n.marginRight=n.marginRight||a.marginRight,n.marginLeft=n.marginLeft||a.marginLeft,n.weight=n.weight||a.weight,e.fillStyle=n.color,e.font=n.weight+n.fontSize+"px "+n.fontFamily,e.textAlign=n.textAlign;var c=l+("right"===n.textAlign?o-n.marginRight:n.marginLeft),s=r+.5*i;if(e.save(),e.beginPath(),e.rect(l,r,o,i),e.clip(),n.backgroundColor&&(e.fillStyle=n.backgroundColor,e.fillRect(l,r,o,i),e.fillStyle=n.color),Array.isArray(t))for(var u,d=v(t);!(u=d()).done;){var f=u.value;f.content instanceof HTMLImageElement?e.drawImage(f.content,l+f.x,s+f.y,f.width,f.height):"string"===typeof f.content&&e.fillText(f.content,l+f.x,s+f.y)}else e.fillText(t,c,s);e.restore()}function w(e,t,n,a,l){var r=[],o=[],i=[],c=0;o.push(n),r.push(e>0?0:a),c=n+t(e>0?0:a),i.push(c);var s=e>0?1:a+1;if(e>0){for(;s<e;s++)r.push(s),o.push(c),c+=t(s),i.push(c);s=Math.max(a,e)}for(;r.push(s),o.push(c),c+=t(s),i.push(c),!(i[i.length-1]>=l);)s++;return{visible:r,start:o,end:i}}var C=function(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null),r=Object(a.useRef)(null),o=Object(a.useState)({x:5e3,y:5e3}),i=o[0],c=o[1],s=Object(a.useState)({x:0,y:0}),u=s[0],d=s[1],y=Object(a.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),C=y[0],E=y[1],S=Object(a.useState)({x1:-1,y1:-1,x2:-1,y2:-1}),O=S[0],j=S[1],k=Object(a.useState)({x:-1,y:-1}),D=k[0],A=k[1],R=Object(a.useState)(""),N=R[0],M=R[1],H=Object(a.useState)(!1),z=H[0],W=H[1],L=Object(a.useState)(!1),T=L[0],I=L[1],F=Object(a.useState)(!1),B=F[0],Y=F[1],X=Object(a.useState)(!1),K=X[0],P=X[1],U=Object(a.useState)(null),q=U[0],G=U[1],J=Object(a.useState)(null),_=J[0],$=J[1],Q=Object(a.useState)(!1),V=Q[0],Z=Q[1],ee=Object(a.useState)(!1),te=ee[0],ne=ee[1],ae=Object(a.useState)({x:-1,y:-1,hitTarget:null}),le=ae[0],re=ae[1],oe=Object(f.a)({ref:t}),ie=oe.width,ce=void 0===ie?3e3:ie,se=oe.height,ue=void 0===se?3e3:se,de=e.freezeColumns||0,fe=e.freezeRows||0,he={textAlign:"left",fontSize:13,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:""},ye=m(e.cellWidth,100),ve=m(e.cellHeight,22),xe=m(e.columnHeaders,null),ge=p(e.readOnly,!1),me=p(e.sourceData,null),pe=p(e.displayData,null),be=p(e.editData,null),we=p(e.cellStyle,he),Ce=w(de,ye,50,u.x,ce),Ee=Ce.visible,Se=Ce.start,Oe=Ce.end,je=w(fe,ve,22,u.y,ue),ke=je.visible,De=je.start,Ae=je.end,Re=function(t,a,l,r,o){if(void 0===o&&(o=!0),E({x1:t,y1:a,x2:l,y2:r}),o){var i={x:u.x,y:u.y},c=-1,s=-1;if(!Ee.includes(l)||Ee[Ee.length-1]===l){var f=Ee[Ee.length-1]<=l?1:-1,h=Math.max(u.x,de)+f;i.x=h,c=30*h}if(!ke.includes(r)||ke[ke.length-1]===r){var y=ke[ke.length-1]<=r?1:-1,v=Math.max(u.y,fe)+y;i.y=v,s=30*v}i.x===u.x&&u.y===i.y||(d({x:i.x,y:i.y}),setTimeout((function(){n.current&&(-1!==c&&(n.current.scrollLeft=c),-1!==s&&(n.current.scrollTop=s))}),0))}if(e.onSelectionChanged){var x=t,g=a,m=l,p=r;x>m&&(x=l,m=t),g>p&&(g=r,p=a),e.onSelectionChanged(x,g,m,p)}},Ne=function(e,t){for(var n=0,a=0,l=0;l<Ee.length;l++)if(e>=Se[l]&&e<=Oe[l]){n=Ee[l];break}for(var r=0;r<ke.length;r++)if(t>=De[r]&&t<=Ae[r]){a=ke[r];break}return{x:n,y:a}},Me=function(e,t){var n=50,a=Ee.findIndex((function(t){return t===e}));if(-1!==a)n=Se[a];else{for(var l=0;l<u.x;l++)n-=ye(l);for(var r=0;r<e;r++)n+=ye(r)}var o=22,i=ke.findIndex((function(e){return e===t}));if(-1!==i)o=De[i];else{for(var c=0;c<u.y;c++)o-=ve(c);for(var s=0;s<t;s++)o+=ve(s)}return{x:n,y:o}},He=Object(a.useMemo)((function(){if(-1!==C.x2&&-1!==C.y2){var e=C.x2;C.x1>C.x2&&(e=C.x1);var t=C.y2;C.y1>C.y2&&(t=C.y1);var n=Me(e,t);return{x:n.x+ye(e),y:n.y+ve(t)}}return{x:-1,y:-1}}),[C,ke,Ee]),ze=Object(a.useMemo)((function(){var e={},n=t.current;if(!n)return e;g(n);for(var a,l=22,r=v(ke);!(a=r()).done;){for(var o,i=a.value,c=50,s=v(Ee);!(o=s()).done;){var u=o.value,d=pe(u,i);if(null!==d&&void 0!==d){var f=c,h=l+.5*ve(i);if(Array.isArray(d))for(var y,x=v(d);!(y=x()).done;){var m=y.value;if(m.onClick)for(var p=f+m.x,b=h+m.y,w=p+m.width,C=b+m.height,E={cellX:u,cellY:i,x:p,y:b,w:m.width,h:m.height,onClick:m.onClick},S=Math.floor(p/10),O=Math.floor(w/10),j=Math.floor(b/10),k=Math.floor(C/10),D=S;D<=O;D++){e[D]||(e[D]={});for(var A=e[D],R=j;R<=k;R++)A[R]||(A[R]=[]),A[R].push(E)}}c+=ye(u)}else c+=ye(u)}l+=ve(i)}return e}),[pe,e.cellWidth,e.cellHeight,u.x,u.y]);Object(a.useEffect)((function(){var e=t.current,n=e.getContext("2d"),a=window.requestAnimationFrame((function(){g(e),n.clearRect(0,0,n.canvas.width,n.canvas.height),n.fillStyle="white",n.fillRect(0,0,n.canvas.width,n.canvas.height);for(var t,a=22,l=v(ke);!(t=l()).done;){for(var r,o=t.value,i=50,c=v(Ee);!(r=c()).done;){var s=r.value,u=we(s,o);u.fillColor&&(n.fillStyle=u.fillColor,n.fillRect(i,a,ye(s),ve(o))),i+=ye(s)}a+=ve(o)}var d=!1,f=C.x1,h=C.x2;C.x1>C.x2&&(f=C.x2,h=C.x1);var y=C.y1,x=C.y2;C.y1>C.y2&&(y=C.y2,x=C.y1);var m=-1!==f&&-1!==h&&-1!==y&&-1!==x,p=Me(f,y),w=Me(h,x);if(w.x+=ye(h),w.y+=ve(x),p.x>=w.x){w.x=p.x;for(var E=f;Ee.includes(E);)w.x+=ye(E),E++;d=!0}if(p.y>=w.y){w.y=p.y;for(var S=y;ke.includes(S);)w.y+=ve(S),S++;d=!0}m&&(n.fillStyle="#e9f0fd",n.fillRect(p.x,p.y,w.x-p.x,w.y-p.y)),n.fillStyle="#f8f9fa",n.fillRect(0,0,50,n.canvas.height),m&&(n.fillStyle="#e8eaed",n.fillRect(0,p.y,50,w.y-p.y)),n.fillStyle="#f8f9fa",n.fillRect(0,0,n.canvas.width,22),m&&(n.fillStyle="#e8eaed",n.fillRect(p.x,0,w.x-p.x,22)),n.strokeStyle="#e2e3e3",n.lineWidth=1;for(var j,k=50,D=v(Ee);!(j=D()).done;){var A=j.value;n.beginPath(),n.moveTo(k,0),n.lineTo(k,n.canvas.height),n.stroke(),k+=ye(A)}for(var R,N=22,M=v(ke);!(R=M()).done;){var H=R.value;n.beginPath(),n.moveTo(0,N),n.lineTo(n.canvas.width,N),n.stroke(),N+=ve(H)}N=22,n.textBaseline="middle",n.textAlign="center",n.font=he.fontSize+"px "+he.fontFamily,n.fillStyle="#666666";for(var z,W=v(ke);!(z=W()).done;){var L=z.value,T=N+.5*ve(L),I=L+1;n.fillText(I,25,T),N+=ve(L)}k=50,n.textBaseline="middle",n.textAlign="center";for(var F,Y=v(Ee);!(F=Y()).done;){var X=F.value,K=k+.5*ye(X),P=xe(X),U={},q=null;"object"===typeof P&&null!==P&&P.headerCellStyle&&(U=P.headerCellStyle),q="object"===typeof P&&null!==P?P.cellContent:P,U.color=U.color||"#666666",U.fontSize=U.fontSize||he.fontSize,U.fontFamily=U.fontFamily||he.fontFamily,U.weight=U.weight||he.weight,n.font=U.weight+U.fontSize+"px "+U.fontFamily,n.fillStyle=U.color,null!==q&&void 0!==q||(q=X+1),n.fillText(q,K,11),k+=ye(X)}if(m&&(n.strokeStyle="#1b73e7",n.lineWidth=1,n.beginPath(),n.rect(p.x,p.y,w.x-p.x,w.y-p.y),n.stroke()),B){var G=O.x1,J=O.x2;O.x1>O.x2&&(G=O.x2,J=O.x1);var _=O.y1,$=O.y2;O.y1>O.y2&&(_=O.y2,$=O.y1);var Q=Me(G,_),V=Me(J+1,$+1);n.strokeStyle="#707070",n.setLineDash([3,3]),n.lineWidth=1,n.beginPath(),n.rect(Q.x,Q.y-1,V.x-Q.x,V.y-Q.y),n.stroke(),n.setLineDash([])}m&&!d&&(n.fillStyle="#1b73e7",n.fillRect(w.x-3,w.y-3,6,6)),n.textBaseline="middle";for(var Z,ee=22,te=v(ke);!(Z=te()).done;){for(var ne,ae=Z.value,le=50,re=ve(ae),oe=v(Ee);!(ne=oe()).done;){var ie=ne.value,ce=pe(ie,ae),se=ye(ie);if(null!==ce&&void 0!==ce){var ue=we(ie,ae);b(n,ce,ue,he,le,ee,se,re)}le+=se}ee+=re}}));return function(){window.cancelAnimationFrame(a)}}),[e.displayData,u.x,u.y,C,B,O,ce,ue,q,ye,ve]);var We=function(){r.current&&(r.current.focus({preventScroll:!0}),r.current.select())};Object(a.useEffect)((function(){if(!Pe)if(Fe(),document.activeElement===r.current)We();else{var e=document.activeElement.tagName.toLowerCase();"div"===e&&"true"===document.activeElement.contentEditable||"input"===e||"textarea"===e||"select"===e||We()}}));var Le=function(e){if(r&&e.target===r.current){e.preventDefault();var t=e.clipboardData||window.clipboardData,n=t.types;if(n.includes("text/html")){var a=t.getData("text/html");Te(a)}else if(n.includes("text/plain")){var l=t.getData("text/plain");Ie(l)}}};Object(a.useEffect)((function(){return window.document.addEventListener("paste",Le),function(){window.document.removeEventListener("paste",Le)}}));var Te=function(t){var n=document.createElement("div");n.innerHTML=t.trim();var a=-1,l=-1;if(-1!==C.x1&&-1===C.x2&&(a=C.x1),-1!==C.y1&&-1===C.y2&&(l=C.y1),-1!==C.x1&&-1!==C.x2&&(a=Math.min(C.x1,C.x2)),-1!==C.y1&&-1!==C.y2&&(l=Math.min(C.y1,C.y2)),-1!==a&&-1!==l){var r=a,o=l,i=[],c=function e(t){for(var n,a=v(t.children);!(n=a()).done;){var l=n.value;if("TABLE"===l.nodeName)return l;var r=e(l);if(r)return r}}(n);if(c){for(var s,u=v(c.children);!(s=u()).done;){var d=s.value;if("TBODY"===d.nodeName)for(var f,h=v(d.children);!(f=h()).done;){var y=f.value;if(r=a,"TR"===y.nodeName){for(var x,g=v(y.children);!(x=g()).done;){var m=x.value;"TD"===m.nodeName&&(i.push({y:o,x:r,value:m.innerHTML}),r++)}o++}}}e.onChange&&e.onChange(i),Re(a,l,r-1,o-1,!1)}}},Ie=function(t){var n=-1,a=-1;if(-1!==C.x1&&-1===C.x2&&(n=C.x1),-1!==C.y1&&-1===C.y2&&(a=C.y1),-1!==C.x1&&-1!==C.x2&&(n=Math.min(C.x1,C.x2)),-1!==C.y1&&-1!==C.y2&&(a=Math.min(C.y1,C.y2)),-1!==n&&-1!==a){for(var l=t.split(/\r?\n/),r=n,o=a+l.length-1,i=[],c=0;c<l.length;c++){var s=l[c].split("\t");n+s.length-1>r&&(r=n+s.length-1);for(var u=0;u<s.length;u++)i.push({y:a+c,x:n+u,value:s[u]})}e.onChange&&e.onChange(i),Re(n,a,r,o,!1)}},Fe=function(){if(-1!==C.x1&&-1!==C.y1&&-1!==C.x2&&-1!==C.y2){var e=C.y1,t=C.y2;e>t&&(e=C.y2,t=C.y1);var n=C.x1,a=C.x2;n>a&&(n=C.x2,a=C.x1);for(var l=[],o=e;o<=t;o++){for(var i=[],c=n;c<=a;c++){var s=be(c,o);null!==s&&void 0!==s?i.push(s):i.push("")}l.push(i.join("\t"))}var u=l.join("\n");r.current&&(r.current.value=u)}},Be=function(){e.onChange&&e.onChange([{x:D.x,y:D.y,value:N}]),A({x:-1,y:-1})},Ye=function(e){if(!ge(e.x,e.y)){var t=be(e.x,e.y),n="";null!==t&&void 0!==t&&(n=t),A(e),M(n)}},Xe=function(t){if(B){var n=C.x1,a=C.x2;C.x1>C.x2&&(n=C.x2,a=C.x1);var l=C.y1,r=C.y2;C.y1>C.y2&&(l=C.y2,r=C.y1);var o=O.x1,i=O.x2;O.x1>O.x2&&(o=O.x2,i=O.x1);var c=O.y1,s=O.y2;O.y1>O.y2&&(c=O.y2,s=O.y1);var u=o,d=c,f=i,h=s,y=[];if(f-u===a-n){d===l?d=r+1:h=l-1;for(var v=l,x=d;x<=h;x++){for(var g=u;g<=f;g++){var m=me(g,v);y.push({x:g,y:x,value:m})}(v+=1)>r&&(v=l)}}else{u===n?u=a+1:f=n-1;for(var p=n,b=u;b<=f;b++){for(var w=d;w<=h;w++){var E=me(p,w);y.push({x:b,y:w,value:E})}(p+=1)>a&&(p=n)}}e.onChange&&e.onChange(y),Re(O.x1,O.y1,O.x2,O.y2)}if(P(!1),Z(!1),ne(!1),Y(!1),G(null),$(null),-1!==le.x&&-1!==le.y&&null!==le.hitTarget){var S=t.target.getBoundingClientRect(),j=t.clientX-S.left,k=t.clientY-S.top,D=le.hitTarget;D.x<=j&&j<=D.x+D.w&&D.y<=k&&k<=D.y+D.h&&D.onClick(),re({x:-1,y:-1,hitTarget:null})}};Object(a.useEffect)((function(){return window.addEventListener("mouseup",Xe),function(){window.removeEventListener("mouseup",Xe)}}));var Ke=function(t){var n=t.target.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;window.document.body.style.cursor="auto";var r=Math.floor(a/10),o=Math.floor(l/10);if(ze[r]&&ze[r][o])for(var i,c=v(ze[r][o]);!(i=c()).done;){var s=i.value;s.x<=a&&a<=s.x+s.w&&s.y<=l&&l<=s.y+s.h&&(window.document.body.style.cursor="pointer")}if(e.onCellWidthChange&&l<22)for(var u,d=50,f=v(Ee);!(u=f()).done;){var h=u.value;if(Math.abs(d-a)<4){window.document.body.style.cursor="col-resize";break}d+=ye(h)}if(e.onCellHeightChange&&a<50)for(var y,x=22,g=v(ke);!(y=g()).done;){var m=y.value;if(Math.abs(x-l)<4){window.document.body.style.cursor="row-resize";break}x+=ve(m)}if(Math.abs(a-He.x)<6&&Math.abs(l-He.y)<6&&(window.document.body.style.cursor="crosshair"),q){if(e.onCellWidthChange){var p=Math.max(q.oldWidth+a-q.startX,50);e.onCellWidthChange(q.colIdx,p)}}else if(_){if(e.onCellHeightChange){var b=Math.max(_.oldHeight+l-_.startY,22);e.onCellHeightChange(_.rowIdx,b)}}else{if(K){var w=Ne(a,l);V?Re(C.x1,C.y1,C.x2,w.y,!1):te?Re(C.x1,C.y1,w.x,C.y2,!1):Re(C.x1,C.y1,w.x,w.y)}if(B){window.document.body.style.cursor="crosshair";var E=Ne(a,l),S=C.x1,O=C.y1,k=C.x2,D=C.y2;S>k&&(S=C.x2,k=C.x1),O>D&&(O=C.y2,D=C.y1),Math.abs(E.x-.5*(S+k))<Math.abs(E.y-.5*(O+D))?E.y<O?O=E.y:D=E.y:E.x<S?S=E.x:k=E.x,j({x1:S,y1:O,x2:k,y2:D})}}},Pe=-1!==D.x&&-1!==D.y,Ue={x:0,y:0},qe=0,Ge=0,Je="right";if(Pe){Ue=Me(D.x,D.y);var _e=we(D.x,D.y);Ue.x+=1,Ue.y+=1,qe=ye(D.x)-2,Ge=ve(D.y)-2,Je=_e.textAlign||he.textAlign}return l.a.createElement("div",{style:{position:"relative",height:"100%"}},l.a.createElement("canvas",{style:{width:"calc(100% - 14px)",height:"calc(100% - 15px)",outline:"1px solid #ddd"},ref:t}),l.a.createElement("div",{ref:n,onDoubleClick:function(e){var t=e.target.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top,l=Ne(n,a);W(!1),Ye(l)},onMouseDown:function(e){if(0===e.button){var t=e.target.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top;if(!(n>ce||a>ue)){var l=Math.floor(n/10),r=Math.floor(a/10);if(ze[l]&&ze[l][r])for(var o,i=v(ze[l][r]);!(o=i()).done;){var c=o.value;if(c.x<=n&&n<=c.x+c.w&&c.y<=a&&a<=c.y+c.h)return void re({x:n,y:a,hitTarget:c})}if(a<22)for(var s,u=50,d=v(Ee);!(s=d()).done;){var f=s.value;if(Math.abs(u-n)<4)return window.document.body.style.cursor="col-resize",void G({startX:u,oldWidth:ye(f-1),colIdx:f-1});u+=ye(f)}if(n<50)for(var y,x=22,g=v(ke);!(y=g()).done;){var m=y.value;if(Math.abs(x-a)<4)return window.document.body.style.cursor="row-resize",void $({startY:x,oldHeight:ve(m-1),rowIdx:m-1});x+=ve(m)}if(Math.abs(n-He.x)<6&&Math.abs(a-He.y)<6)return Y(!0),void j({x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2});var p=Ne(n,a),b=T?{x:C.x1,y:C.y1}:h({},p);Pe&&Be();var w=!0;n<50?(p.x=100,w=!1,Z(!0)):Z(!1),a<22?(p.y=100,w=!1,ne(!0)):ne(!1),P(!0),Re(b.x,b.y,p.x,p.y,w),A({x:-1,y:-1})}}},onMouseMove:Ke,onMouseLeave:function(e){window.document.body.style.cursor="auto"},onContextMenu:function(t){if(e.onRightClick){var n=t.target.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top,r=Ne(a,l);t.cellX=r.x,t.cellY=r.y,l>22&&a>50&&(Ke(t),e.onRightClick(t))}},onScroll:function(e){var t=e.target.scrollLeft,n=e.target.scrollTop,a=Math.floor(t/30),l=Math.floor(n/30);a===u.x&&l===u.y||d({x:a,y:l});var r=h({},i);i.x/(t+.5)<1&&(r.x*=1.5),i.y/(n+.5)<1&&(r.y*=1.5),r.x===i.x&&i.y===r.y||c(h({},r))},className:x,style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",borderBottom:"1px solid #ddd"}},l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:i.y+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:i.x+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}})),l.a.createElement("textarea",{style:{position:"absolute",top:0,left:0,width:1,height:1,opacity:.01},ref:r,onFocus:function(e){return e.target.select()},tabIndex:"0",onKeyDown:function(t){if(Pe&&z&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key))Be();else if("Shift"!==t.key){if((!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())&&(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase()))if("Backspace"!==t.key&&"Delete"!==t.key){if(-1!==C.x1&&-1!==C.x2&&-1!==C.y1&&-1!==C.y2){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key)return ge(C.x1,C.y1)?void t.preventDefault():(Ye({x:C.x1,y:C.y1}),void W("Enter"!==t.key));if(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(t.key)){var n={x:C.x1,y:C.y1},a={x:C.x2,y:C.y2};return"ArrowRight"===t.key||"Tab"===t.key?a.x+=1:"ArrowLeft"===t.key?a.x-=1:"ArrowUp"===t.key?a.y-=1:"ArrowDown"===t.key&&(a.y+=1),a.x<0&&(a.x=0),a.y<0&&(a.y=0),t.shiftKey||(n=h({},a)),void Re(n.x,n.y,a.x,a.y)}t.preventDefault()}}else{var l=C.x1,r=C.y1,o=C.x2,i=C.y2;l>o&&(l=C.x2,o=C.x1),r>i&&(r=C.y2,i=C.y1);for(var c=[],s=r;s<=i;s++)for(var u=l;u<=o;u++)c.push({x:u,y:s,value:null});e.onChange&&e.onChange(c)}}else I(!0)},onKeyUp:function(e){I(e.shiftKey)}}),Pe&&l.a.createElement("input",{type:"text",onFocus:function(e){return e.target.select()},autoFocus:!0,onKeyDown:function(e){if("Escape"!==e.key){if("Enter"===e.key&&(Be(),Re(C.x1,C.y1+1,C.x1,C.y1+1)),"Tab"===e.key&&(e.preventDefault(),Be(),Re(C.x1+1,C.y1,C.x1+1,C.y1)),z&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e.key)){e.preventDefault(),Be();var t=C.x1,n=C.y1,a=C.x1,l=C.y1;"ArrowRight"===e.key?(t=C.x1+1,a=C.x1+1):"ArrowLeft"===e.key?(t=C.x1-1,a=C.x1-1):"ArrowUp"===e.key?(n=C.y1-1,l=C.y1-1):"ArrowDown"===e.key&&(n=C.y1+1,l=C.y1+1),Re(t,n,a,l)}}else A({x:-1,y:-1})},value:N,onChange:function(e){return M(e.target.value)},style:{position:"absolute",top:Ue.y,left:Ue.x,width:qe,height:Ge,outline:"none",border:"none",textAlign:Je,color:"black",fontSize:he.fontSize,fontFamily:"sans-serif"}}))};n(22);const E=[];for(let Y=0;Y<1e3;Y++){const e=[];for(let t=0;t<100;t++)e.push("Row: ".concat(Y,", Col: ").concat(t));E.push(e)}const S=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],O=[];for(let Y=0;Y<1e3;Y++){const e=[];for(let t=0;t<100;t++)e.push(1e6*Math.random());O.push(e)}function j(){const e=Object(a.useState)(E),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(Array(100).fill(150)),i=Object(u.a)(o,2),c=i[0],s=i[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),y=h[0],v=h[1];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(C,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:y,onChange:e=>{const t=[...n];var a,l=Object(d.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:(e,t)=>{const n=[...c];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(150);n[e]=t,s(n)},onCellHeightChange:(e,t)=>{const n=[...y];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(22);n[e]=t,v(n)},freezeColumns:0,freezeRows:0}))}function k(){const e=Object(a.useState)(S),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(u.a)(o,2),c=i[0],s=i[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),y=h[0],v=h[1];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(C,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:["A","B","C"],cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:y,onChange:e=>{const t=[...n];var a,l=Object(d.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:(e,t)=>{const n=[...c];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(100);n[e]=t,s(n)},onCellHeightChange:(e,t)=>{const n=[...y];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(22);n[e]=t,v(n)},freezeColumns:0,freezeRows:0}))}function D(){const e=Object(a.useState)(S),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(u.a)(o,2),c=i[0],s=i[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),y=h[0],v=h[1],x=["#f00","#0f0","#00f","#000"],g=["left","right","center"],m=["normal ","bold ","lighter "],p=[0,0,0,0,20];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(C,{onSelectionChanged:(e,t,n,a)=>{},onRightClick:()=>{},columnHeaders:[],cellStyle:(e,t)=>0===e||0===t?{fillColor:"#6DA2FB22"}:{color:x[t%4],textAlign:g[e%3],marginRight:p[e%5],weight:m[t%3]},editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:y,onChange:e=>{const t=[...n];var a,l=Object(d.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:(e,t)=>{const n=[...c];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(100);n[e]=t,s(n)},onCellHeightChange:(e,t)=>{const n=[...y];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(22);n[e]=t,v(n)},freezeColumns:1,freezeRows:1}))}function A(){const e=Object(a.useState)(O),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(u.a)(o,2),c=i[0],s=i[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),y=h[0],v=h[1];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(C,{cellStyle:(e,t)=>({}),editData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:(e,t)=>{var a,l,r;return null===n||void 0===n||null===(a=n[t])||void 0===a||null===(l=a[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)},sourceData:(e,t)=>{var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:y,onChange:e=>{const t=[...n];var a,l=Object(d.a)(e);try{for(l.s();!(a=l.n()).done;){const e=a.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=Number(e.value)}}catch(o){l.e(o)}finally{l.f()}r(t)},readOnly:(e,t)=>!1,onCellWidthChange:(e,t)=>{const n=[...c];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(100);n[e]=t,s(n)},onCellHeightChange:(e,t)=>{const n=[...y];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(22);n[e]=t,v(n)},freezeColumns:0,freezeRows:0}))}function R(){const e=Object(a.useState)("initial"),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(u.a)(o,2),c=i[0],s=i[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),y=h[0],v=h[1],x=Object(a.useState)([]),g=Object(u.a)(x,2),m=g[0],p=g[1];return l.a.createElement(l.a.Fragment,null,"initial"===n?l.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r("loading"),fetch("./out.json").then(e=>e.json()).then(e=>{s(e),r("done")})}},"Load global database of power plants"):"loading"===n?"Loading...":null,l.a.createElement("div",{className:"sheet-box"},l.a.createElement(C,{cellStyle:(e,t)=>({}),editData:(e,t)=>{var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},displayData:(e,t)=>{var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},sourceData:(e,t)=>{var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},cellWidth:y,cellHeight:m,onChange:e=>{const t=[...c];var n,a=Object(d.a)(e);try{for(a.s();!(n=a.n()).done;){const e=n.value;t[e.y]||(t[e.y]=[]),t[e.y][e.x]=e.value}}catch(l){a.e(l)}finally{a.f()}s(t)},readOnly:(e,t)=>!1,onCellWidthChange:(e,t)=>{const n=[...y];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(100);n[e]=t,v(n)},onCellHeightChange:(e,t)=>{const n=[...m];if(e>n.length)for(let a=n.length;a<=e;a++)n.push(22);n[e]=t,p(n)},freezeColumns:0,freezeRows:1})))}var N=n(12),M=n.n(N);var H=function(){const e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1];return l.a.createElement("div",{className:"container blue-bg",id:"home"},l.a.createElement("div",{className:"content flex-row header"},l.a.createElement("div",{className:"box text-box"},l.a.createElement("div",null,l.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),l.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",l.a.createElement("br",null),"And it's super fast.")),l.a.createElement("div",{className:"lib-box"},l.a.createElement("div",{className:"install-box",onClick:t=>{e.current.select(),document.execCommand("copy"),t.target.focus(),o("Copied!"),setTimeout(()=>{o("")},1e3)}},l.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==r&&l.a.createElement("div",{className:"copy-success"},r)),l.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",className:"git-box",target:"_blank"},l.a.createElement("img",{src:M.a,alt:"Git"}),"view on github"))),l.a.createElement("div",{className:"box"},l.a.createElement(j,null))))};var z=function({title:e,id:t}){return l.a.createElement("div",{className:"title-separator",id:t||""},l.a.createElement("p",null,e||"No title"),l.a.createElement("div",{className:"separator"}))};var W=function({children:e}){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"content flex-row"},e))},L=n(234),T=n(233);var I=function(){return l.a.createElement(L.a,{language:"javascript",style:T.a},"function SheetBox() {\n    const [data, setData] = useState(initialData);\n    const [cellWidth, setCellWidth] = useState([]);\n    const [cellHeight, setCellHeight] = useState([]);\n\n    const onSelectionChanged = (x1, y1, x2, y2) => {};\n    const onRightClick = () => {};\n    const columnHeaders = ['A', 'B', 'C'];\n    const cellStyle = (x, y) => {\n        return {};\n    };\n    const editData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const displayData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n    const sourceData = (x, y) => {\n        return data?.[y]?.[x];\n    };\n\n    const onChange = (changes) => {\n        const newData = [...data];\n        for (const change of changes) {\n            if (!newData[change.y]) {\n                newData[change.y] = [];\n            }\n            newData[change.y][change.x] = change.value;\n        }\n        setData(newData);\n    };\n\n    const isReadOnly = (x, y) => {\n        return false;\n    };\n\n    const onCellWidthChange = (columnIdx, newWidth) => {\n        const cw = [...cellWidth];\n        if (columnIdx > cw.length) {\n            for (let i = cw.length; i <= columnIdx; i++) {\n                cw.push(100);\n            }\n        }\n        cw[columnIdx] = newWidth;\n        setCellWidth(cw);\n    };\n    const onCellHeightChange = (rowIdx, newHeight) => {\n        const ch = [...cellHeight];\n        if (rowIdx > ch.length) {\n            for (let i = ch.length; i <= rowIdx; i++) {\n                ch.push(22);\n            }\n        }\n        ch[rowIdx] = newHeight;\n        setCellHeight(ch);\n    };\n\n    return (\n        <div className=\"sheet-box\">\n            <Sheet\n                onSelectionChanged={onSelectionChanged}\n                onRightClick={onRightClick}\n                columnHeaders={columnHeaders}\n                cellStyle={cellStyle}\n                editData={editData}\n                displayData={displayData}\n                sourceData={sourceData}\n                cellWidth={cellWidth}\n                cellHeight={cellHeight}\n                onChange={onChange}\n                readOnly={isReadOnly}\n                onCellWidthChange={onCellWidthChange}\n                onCellHeightChange={onCellHeightChange}\n                freezeColumns={0}\n                freezeRows={0}\n            />\n        </div>\n    );\n}")};var F=function(){return l.a.createElement("div",{className:"footer"},l.a.createElement("p",{className:"copy"},"made by ",l.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};var B=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s,null),l.a.createElement(H,null),l.a.createElement(z,{title:"usage",id:"usage"}),l.a.createElement(W,null,l.a.createElement("div",{className:"box full-width",style:{overflowX:"auto"}},l.a.createElement(I,null))),l.a.createElement(z,{title:"Let me show you its features",id:"features"}),l.a.createElement(W,null,l.a.createElement("div",{className:"box"},l.a.createElement(k,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Basic spreadsheet"),l.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize columns and rows."))),l.a.createElement(W,null,l.a.createElement("div",{className:"box"},l.a.createElement(D,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Styling"),l.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns."))),l.a.createElement(W,null,l.a.createElement("div",{className:"box"},l.a.createElement(A,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Formatting"),l.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),l.a.createElement(z,{title:"big dataset example",id:"big dataset example"}),l.a.createElement(W,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement(R,null))),l.a.createElement(z,{title:"documentation",id:"documentation"}),l.a.createElement(W,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("p",null,"Comming soon"))),l.a.createElement(F,null));o.a.render(l.a.createElement(B,null),document.getElementById("root"))},5:function(e,t,n){}},[[17,1,2]]]);
//# sourceMappingURL=main.d333cdcf.chunk.js.map