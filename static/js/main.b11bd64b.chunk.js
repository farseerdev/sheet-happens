(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{10:function(e,t,n){},15:function(e,t,n){e.exports=n.p+"static/media/logo.aef13910.svg"},17:function(e,t,n){e.exports=n.p+"static/media/git.f818b886.svg"},22:function(e,t,n){e.exports=n(247)},247:function(e,t,n){"use strict";n.r(t);n(10);var a=n(0),l=n.n(a),r=n(14),o=n.n(r),i=n(15),c=n.n(i);var u=function(){var e=function(e){var t=document.getElementById(e),n="home"===e?0:86,a=window.pageYOffset+t.getBoundingClientRect().top-n;window.scrollTo({top:a,behavior:"smooth"})};return l.a.createElement("div",{className:"container blue-bg menu"},l.a.createElement("div",{className:"content flex-row"},l.a.createElement("div",{className:"logo-box"},l.a.createElement("img",{src:c.a,alt:"Logo"}),l.a.createElement("h2",{className:"page-title"},"sheet - happens")),l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"nav-item",onClick:function(){return e("home")}},"home"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("usage")}},"usage"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("features")}},"features"),l.a.createElement("div",{className:"nav-item",onClick:function(){return e("documentation")}},"documentation"))))},s=n(1),d=n(7),f=n(3),v=n(2),h=n(16);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}for(var p="_PxIi8",b=[2e3,1e3],C=[0,0],w=[1,1],x=[-1,-1],E=[x,x],O=[],S=[],j={},M=[65536,65536],N="#1a66ff",D="#d8e6ff80",k="#0000001f",T="#1a66ff30",I="#1a66ff",A="#707070",R="#f6f9fc",H="#666666",z="#e8f0ff",L="#000000",W=6,P=50,B=22,Y=50,G=22,F=4,K=12,Z=.05,J={textAlign:"left",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},X={textAlign:"center",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},Q={color:"#1a66ff"},V={backgroundColor:"#1a66ff",color:"#ffffff"},U={backgroundColor:"#1a66ff70",color:"#ffffff"},q={ArrowRight:"right",ArrowLeft:"left",ArrowUp:"up",ArrowDown:"down"},$=function(e,t,n){return Math.max(Math.min(n,e),t)},_=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),Array.from({length:e}).map((function(e,a){return t+n*a}))},ee=function(e,t,n){return t<=e&&e<=n},te=function(e,t,n){return t<=e&&e<n},ne=function(e,t,n){return t<e&&e<n},ae=function(e,t){return[e[0]+t[0],e[1]+t[1]]},le=function(e,t){return[e[0]-t[0],e[1]-t[1]]},re=function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]},oe=function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]},ie=function(e){return"left"===e?[-1,0]:"right"===e?[1,0]:"up"===e?[0,-1]:"down"===e?[0,1]:[0,0]},ce=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ue=function(e,t,n){for(var a=e;a<=t;++a)n(a)},se=function(e){return function(t){var n=[];return e((function(){return n.push(t.apply(void 0,arguments))})),n}},de=function(e){return se(function(e){return function(t){var n=be(e),a=n[0][0],l=n[1][0];ue(a,l,t)}}(e))},fe=function(e){return se(function(e){return function(t){var n=be(e),a=n[0][1],l=n[1][1];ue(a,l,t)}}(e))},ve=function(e){var t=e[0][0],n=e[1][0];return-1===t&&-1===n},he=function(e){var t=e[0][1],n=e[1][1];return-1===t&&-1===n},me=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===n&&-1===r&&-1!==a&&-1!==o},ge=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===a&&-1===o&&-1!==n&&-1!==r},ye=function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1===n&&-1===r&&-1===a&&-1===o},pe=function(e,t){var n=be(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1],u=t[0],s=t[1];return u>=l&&u<=i&&s>=r&&s<=c},be=function(e){var t=e[0],n=e[1];return[oe(t,n),re(t,n)]},Ce=function(e,t,n,a){for(var l=1,r=n>0?1e3:Math.min(1e3,t+1);l<r;l++){var o=e(t+l*n);if(null==o||!a.has(o))break}return t+(l-1)*n},we=function(e,t,n,a){if(!n)return e;var l=be(e),r=l[0],o=l[1],i=r[a],c=o[a],u=Ce(t,i,-1,n),s=Ce(t,c,1,n),d=[r.slice(),o.slice()];return d[0][a]=u,d[1][a]=s,function(e,t){var n=e[0],a=n[0],l=n[1],r=e[1],o=r[0],i=r[1],c=t[0],u=t[1],s=c[0],d=c[1],f=(s-u[0]||1)*(o-a||1)<0,v=(d-u[1]||1)*(i-l||1)<0;return[[f?o:a,v?i:l],[f?a:o,v?l:i]]}(d,e)},xe=function(e,t){var n=t(e-1),a=t(e);return null!=n&&null!=a&&n===a},Ee=function(e,t){return Array.isArray(e)?function(n){return n>=0&&n<e.length?e[n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},Oe=function(e,t){return Array.isArray(e)?function(n,a){return a>=0&&a<e.length&&n>=0&&n<e[a].length?e[a][n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},Se=function(e){for(var t=0,n=0,a=0,l=10,r=1.5;a<4;){for(var o=!0,i=0;i<10;i++){var c=e(t,i);if(null!==c&&void 0!==c&&""!==c){o=!1;break}}if(o&&(a+=1),(t+=l)>65536)break;l=Math.floor(l*r)}for(a=0,l=10,r=1.5;a<4;){for(var u=!0,s=0;s<10;s++){var d=e(s,n);if(null!==d&&void 0!==d&&""!==d){u=!1;break}}if(u&&(a+=1),(n+=l)>65536)break;l=Math.floor(l*r)}return[t,n]},je=function(e,t,n){var a,l,r,o=ie(n),i=(l=C,void 0===(r=M)&&(r=[1/0,1/0]),[$((a=t)[0],l[0],r[0]),$(a[1],l[1],r[1])]),c=e.apply(void 0,ae(i,o)),u=""!==c&&null!==c&&void 0!==c;u||(i=ae(i,o));for(var s=i,d=s[0],f=s[1];d<=65536&&f<=65536&&d>=0&&f>=0;){var v=e(d,f);if(u&&(""===v||null===v||void 0===v))return le(i,o);if(!u&&""!==v&&null!==v&&void 0!==v)return i;var h=i=ae(i,o);d=h[0],f=h[1]}return re(i,[0,0])},Me=function(e,t,n,a,l){var r=be(e),o=r[0],i=o[0],c=o[1],u=r[1],s=u[0],d=u[1],f=be(t),v=f[0],h=v[0],m=v[1],g=f[1],y=g[0],p=g[1],b=i,C=c,w=s,x=d,E=[];if(w-b===y-h){if(C===m?C=p+1:x=m-1,-1===b&&-1===w)b=0,w=Se(a)[0];for(var O=m,S=C;S<=x;S++){for(var j=b;j<=w;j++){var M=n(j,O);l(j,S)||E.push({x:j,y:S,value:M,source:{x:j,y:O}})}(O+=1)>p&&(O=m)}}else{if(b===h?b=y+1:w=h-1,-1===C&&-1===x)C=0,x=Se(a)[1];for(var N=h,D=b;D<=w;D++){for(var k=C;k<=x;k++){var T=n(N,k);l(D,k)||E.push({x:D,y:k,value:T,source:{x:N,y:k}})}(N+=1)>y&&(N=h)}}return E},Ne=function(e,t){if(ye(e))return"";var n=be(e),a=n[0],l=a[0],r=a[1],o=n[1],i=o[0],c=o[1];ve(e)&&(l=0,i=Se(t)[0]);he(e)&&(r=0,c=Se(t)[1]);for(var u=[],s=r;s<=c;s++){for(var d=[],f=l;f<=i;f++){var v=t(f,s);null!==v&&void 0!==v&&d.push(null!=v?v:"")}u.push(d)}return function(e){return e.map((function(e){return e.join("\t")})).join("\n")}(u)},De=function(e,t,n){var a=document.createElement("div");a.innerHTML=t.trim();var l=be(e)[0],r=l[0],o=l[1],i=ve(e)?0:r,c=he(e)?0:o,u=[],s=function e(t){for(var n,a=y(t.children);!(n=a()).done;){var l=n.value;if("TABLE"===l.nodeName)return l;var r=e(l);if(r)return r}}(a);if(!s)return null;for(var d,f=i,v=c,h=y(s.children);!(d=h()).done;){var m=d.value;if("TBODY"===m.nodeName)for(var g,p=y(m.children);!(g=p()).done;){var b=g.value,C=i;if("TR"===b.nodeName){for(var w,x=y(b.children);!(w=x()).done;){var E=w.value;if("TD"===E.nodeName){var O="";if(0!==E.children.length&&"P"===E.children[0].nodeName){var S=E.children[0];O=0!==S.children.length&&"FONT"===S.children[0].nodeName?S.children[0].textContent.trim():S.textContent.trim()}else O=E.textContent.trim();O=(O=O.replaceAll("\n","")).replaceAll(/\s\s+/g," "),null!==n&&void 0!==n&&n(C,v)||u.push({x:C,y:v,value:O}),C++}}v++}f=Math.max(f,C-1)}}return{selection:[[i,c],[f,Math.max(c,v-1)]],changes:u}},ke=function(e,t,n){for(var a=be(e)[0],l=a[0],r=a[1],o=ve(e)?0:l,i=he(e)?0:r,c=t.split(/\r?\n/),u=o,s=i+c.length-1,d=[],f=0;f<c.length;f++){var v=c[f].split("\t");u=Math.max(u,o+v.length-1);for(var h=0;h<v.length;h++){var m=o+h,g=i+f;null!==n&&void 0!==n&&n(m,g)||d.push({x:m,y:g,value:v[h]})}}return{selection:[[o,i],[u,s]],changes:d}},Te=function(e){var t=Ie(256),n=Ie(256),a=0;t.set(0,0);var l=function(t){if(t<0)return 0;if(n.has(t))return n.get(t);var a=e(t)||0;return n.set(t,a),a},r=function(e){if(e<0)return 0;if(t.has(e))return t.get(e);for(var n=t.tail()||0;n<e;){var a=l(n),r=(t.get(n)||0)+a;t.set(++n,r)}return t.get(e)};return{getSize:l,getStart:function(e){return r(e)},getEnd:function(e){return r(e+1)},getVersion:function(){return a},lookupIndex:function(e,n){void 0===n&&(n=0);for(var a=t.tail()||0;r(a)<e&&l(a);)a+=64;for(var o=0,i=a;o<i;){var c=o+Math.floor((i-o)/2)+1;r(c)-(n?n*l(c-1):0)<=e?o=c:i=c-1}return o},setSizer:function(t){e=t},clearAfter:function(e){e=Math.max(0,e),t.truncate(e),n.truncate(e),a++}}},Ie=function(e){var t,n;void 0===e&&(e=128);var a=0,l=function(e){var a=new Uint8Array(e),l=new Uint32Array(e);t&&r(t,a),n&&r(n,l),t=a,n=l};l(e);var r=function(e,t){for(var n=Math.min(e.length,t.length),a=0;a<n;++a)t[a]=e[a]};return{truncate:function(e){var r=n.length;if(!(r<e)){if(r>Math.round(1.2*e))l(e);else for(var o=e;o<r;++o)t[o]=0;for(a=Math.min(a,e);a>0&&!t[a];)a--}},set:function(e,r){!function(e){var t=n.length,a=Math.round(1.2*t);t<e&&l(Math.max(a,e))}(e+1),n[e]=r,t[e]=1,a=Math.max(a,e)},get:function(e){return t[e]?n[e]:null},has:function(e){return!!t[e]},tail:function(){return t[a]?a:null}}},Ae=function(e,t,n,a,l){return void 0===l&&(l=n.textAlign),"left"===l?e+n.marginLeft:"center"===l?e+.5*t-a/2:"right"===l?e+(t-n.marginRight-a):e},Re=function(e,t,n,a,l,r,o,i){var c=[];if(null===t)return c;var u=m({},a,n);e.fillStyle=u.color,e.font=u.weight+" "+u.fontSize+"px "+u.fontFamily,e.textAlign=u.textAlign;var s=Math.floor(r+.5*i);if(e.save(),e.beginPath(),e.rect(l,r,o,i),e.clip(),""!==u.backgroundColor&&(e.fillStyle=u.backgroundColor,e.fillRect(l,r,o,i),e.fillStyle=u.color),"string"===typeof t||"number"===typeof t){var d=Ae(l,o,u,0),f=""+t;e.fillText(f,d,s)}else if("object"===typeof t)for(var v,h=y(t.items);!(v=h()).done;){var g=v.value,p=0,b=0,C=0,w=0;if(g.content instanceof HTMLImageElement)C=g.width||o,w=g.height||i,p=Ae(l,o,u,C,g.horizontalAlign)+g.x,b=s+g.y,e.drawImage(g.content,p,b,C,w);else if("string"===typeof g.content||"number"===typeof g.content){g.horizontalAlign&&(e.textAlign=g.horizontalAlign);var x=Ae(l,o,u,0,g.horizontalAlign),E=""+g.content,O=x+g.x,S=s+g.y;e.fillText(E,O,S);var j=e.measureText(E);p=O-j.actualBoundingBoxLeft,b=S-j.actualBoundingBoxAscent,C=O+j.actualBoundingBoxRight-p,w=S+j.actualBoundingBoxDescent-b}g.onClick&&c.push({rect:[[p,b],[p+C,b+w]],obj:g})}return e.restore(),c},He=function(e,t){var n=t.cellToPixel,a=me(e),l=ge(e),r=be(e),o=r[0],i=r[1],c=n(o),u=c[0],s=c[1],d=n(i,w),f=d[0],v=d[1];return a&&(f=1e5),l&&(v=1e5),[[u,s],[f,v]]},ze=function(e,t,n,a,l){var r=t.cellToPixel,o=t.columnToAbsolute,i=t.rowToAbsolute,c=me(e),u=ge(e),s=n[0],d=n[1],f=a[0],v=a[1],h=l[0],m=l[1],g=be(e),y=g[0],p=g[1],b=y[0],C=y[1],x=p[0],E=p[1],O=r(y),S=O[0],j=O[1],M=r(p,w),N=M[0],D=M[1],k=o(s),T=i(d),I=!1;if(ne(s,b,x+1)){var A=f+k;N<=A&&(N=A,I=!0)}if(ne(d,C,E+1)){var R=v+T;D<=R&&(D=R,I=!0)}if(te(b,s,h+s)){S=-1e5;var H=h+s-1;x<=H&&(N=x===H?f:-1e5,I=!0)}if(te(C,d,m+d)){j=-1e5;var z=m+d-1;E<=z&&(D=E===z?v:-1e5,I=!0)}return c&&h>0&&(I=!0),u&&m>0&&(I=!0),c&&(N=1e5),u&&(D=1e5),[[[S,j],[N,D]],I]},Le=function(e){var t=e.getBoundingClientRect(),n=t.width,a=t.height,l=window.devicePixelRatio,r=void 0===l?1:l;r<1&&(r=1);var o=Math.round(n*r),i=Math.round(a*r);if(e.width!==o||e.height!==i){var c=e.getContext("2d");return c&&(e.width=o,e.height=i,c.scale(r,r)),!0}return!1},We=function(e){for(var t="",n=0;e>0;)n=(e-1)%26,t=String.fromCharCode(65+n)+t,e=(e-n)/26|0;return t||""},Pe=function(e,t,n){for(var a,l=function(e){return("0"+Math.round(e).toString(16)).slice(-2)},r=function(e){return 1-Math.pow(1-e,2.2)},o=0;o<=16;++o){var i=o/16;e.addColorStop(i,t+l(255*r(n*(a=i,1-Math.sin(a*Math.PI/2))*.5)))}},Be=Object(a.forwardRef)((function(e,t){var n,r,o,i,c=Object(a.useRef)(null),u=Object(a.useRef)(null),s=Object(a.useState)(b),d=s[0],f=s[1],v=Object(a.useState)(C),g=v[0],M=v[1],$=null!=(n=e.selection)?n:E,te=Object(a.useState)($),ne=te[0],ue=te[1],se=Object(a.useState)(null),he=se[0],Ce=se[1],Se=Object(a.useState)(null),Ie=Se[0],Ae=Se[1],Be=Object(a.useState)([null,null]),Ye=Be[0],Ge=Be[1],Fe=Object(a.useState)(null),Ke=Fe[0],Ze=Fe[1],Je=Object(a.useState)(x),Xe=Je[0],Qe=Je[1],Ve=Object(a.useState)($),Ue=Ve[0],qe=Ve[1];Ue!==$&&(qe($),ue($));var $e=Object(a.useState)(""),_e=$e[0],et=$e[1],tt=Object(a.useState)(!1),nt=tt[0],at=tt[1],lt=Object(h.a)({ref:u}),rt=lt.width,ot=void 0===rt?3e3:rt,it=lt.height,ct=void 0===it?3e3:it,ut=Object(a.useMemo)((function(){return Ee(e.cellWidth,100)}),[e.cellWidth]),st=Object(a.useMemo)((function(){return Ee(e.cellHeight,22)}),[e.cellHeight]),dt=Object(a.useMemo)((function(){return Ee(e.columnHeaders,null)}),[e.columnHeaders]),ft=Object(a.useMemo)((function(){return Ee(e.columnHeaderStyle,{})}),[e.columnHeaderStyle]),vt=Object(a.useMemo)((function(){return Ee(e.canSizeColumn,!0)}),[e.canSizeColumn]),ht=Object(a.useMemo)((function(){return Ee(e.canSizeRow,!0)}),[e.canSizeRow]),mt=Object(a.useMemo)((function(){return Ee(e.canOrderColumn,!0)}),[e.canOrderColumn]),gt=Object(a.useMemo)((function(){return Ee(e.canOrderRow,!0)}),[e.canOrderRow]),yt=Object(a.useMemo)((function(){return Ee(e.rowGroupKeys,null)}),[e.rowGroupKeys]),pt=Object(a.useMemo)((function(){return Ee(e.columnGroupKeys,null)}),[e.columnGroupKeys]),bt=Object(a.useMemo)((function(){return Oe(e.readOnly,!1)}),[e.readOnly]),Ct=Object(a.useMemo)((function(){return Oe(e.sourceData,null)}),[e.sourceData]),wt=Object(a.useMemo)((function(){return Oe(e.displayData,"")}),[e.displayData]),xt=Object(a.useMemo)((function(){return Oe(e.editData,"")}),[e.editData]),Et=Object(a.useMemo)((function(){return Oe(e.editKeys,"")}),[e.editKeys]),Ot=Object(a.useMemo)((function(){return Oe(e.cellStyle,J)}),[e.cellStyle]),St=Object(a.useMemo)((function(){return function(e){var t,n,a;return{freezeColumns:(null===e||void 0===e?void 0:e.freezeColumns)||0,freezeRows:(null===e||void 0===e?void 0:e.freezeRows)||0,hideColumnHeaders:(null===e||void 0===e?void 0:e.hideColumnHeaders)||!1,hideRowHeaders:(null===e||void 0===e?void 0:e.hideRowHeaders)||!1,hideGridlines:(null===e||void 0===e?void 0:e.hideGridlines)||!1,hideScrollBars:(null===e||void 0===e?void 0:e.hideScrollBars)||!1,columnHeaderHeight:null!==e&&void 0!==e&&e.hideColumnHeaders?1:B,rowHeaderWidth:null!==e&&void 0!==e&&e.hideRowHeaders?1:P,shadowBlur:null!=(t=null===e||void 0===e?void 0:e.shadowBlur)?t:K,shadowOpacity:null!=(n=null===e||void 0===e?void 0:e.shadowOpacity)?n:Z,shadowColor:null!=(a=null===e||void 0===e?void 0:e.shadowColor)?a:L}}(e.sheetStyle)}),[e.sheetStyle]),jt=null!=(r=e.secondarySelections)?r:O,Mt=Object(a.useMemo)((function(){return e.columnGroupKeys?new Set(de(ne)((function(e){return pt(e)})).filter((function(e){return null!=e}))):null}),[e.columnGroupKeys,pt,ne]),Nt=Object(a.useMemo)((function(){return e.rowGroupKeys?new Set(fe(ne)((function(e){return yt(e)})).filter((function(e){return null!=e}))):null}),[e.rowGroupKeys,yt,ne]),Dt=d[0],kt=d[1],Tt=Xe[0],It=Xe[1],At=-1!==Tt&&-1!==It,Rt=!1!==(null!=(o=e.cacheLayout)&&o),Ht="number"===typeof e.cacheLayout?e.cacheLayout:0,zt=Object(a.useMemo)((function(){return Te(ut)}),[Rt?Ht:ut]),Lt=Object(a.useMemo)((function(){return Te(st)}),[Rt?Ht:st]);Object(a.useMemo)((function(){Rt&&(zt.setSizer(ut),Lt.setSizer(st))}),[Rt,Ht,ut,st]);var Wt=St.freezeColumns,Pt=St.freezeRows,Bt=St.rowHeaderWidth,Yt=St.columnHeaderHeight,Gt=Object(a.useMemo)((function(){return function(e,t,n,a,l){var r=e[0],o=e[1],i=t[0],c=t[1],u=n[0],s=n[1],d=function(e,t,n){return e<t?0:n+t},f=function(e,t){void 0===t&&(t=0);var n=d(e,r,u),l=a.getStart(e)-a.getStart(n),o=e<r?0:a.getStart(r)-a.getStart(0),c=e<0?i:a.getSize(e);return e<0?0:i+l+o+t*c},v=function(e,t){void 0===t&&(t=0);var n=d(e,o,s),a=l.getStart(e)-l.getStart(n),r=e<o?0:l.getStart(o)-l.getStart(0),i=e<0?c:l.getSize(e);return e<0?0:c+a+r+t*i},h=function(e,t){return void 0===t&&(t=0),a.getStart(e)+t*(e<0?0:a.getSize(e))},m=function(e,t){return void 0===t&&(t=0),l.getStart(e)+t*(e<0?0:l.getSize(e))},g=function(e,t,n,a,l,r){var o=e-n;if(o<0)return-1;var i=r.getStart,c=r.lookupIndex;return c(o<i(a)?o:i(l+a)+o-(i(a)-i(0)),t)},y=function(e,t){return void 0===t&&(t=0),g(e,t,i,r,u,a)},p=function(e,t){return void 0===t&&(t=0),g(e,t,c,o,s,l)},b=function(e,t,n){return e<0?-1:(0,n.lookupIndex)(e,t)},w=function(e,t){return void 0===t&&(t=0),b(e,t,a)},x=function(e,t){return void 0===t&&(t=0),b(e,t,l)},E=function(e,t,n,a,l){for(var r=[].concat(_(n)),o=l.getStart,i=e-t+o(a),c=a+n;o(c)<=i;++c)r.push(c);return r};return{columnToPixel:f,rowToPixel:v,cellToPixel:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[f(n,r),v(a,o)]},columnToAbsolute:h,rowToAbsolute:m,cellToAbsolute:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[h(n,r),m(a,o)]},pixelToColumn:y,pixelToRow:p,pixelToCell:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[y(n,r),p(a,o)]},absoluteToColumn:w,absoluteToRow:x,absoluteToCell:function(e,t){void 0===t&&(t=C);var n=e[0],a=e[1],l=t,r=l[0],o=l[1];return[w(n,r),x(a,o)]},getVisibleCells:function(e){var t=e[0],n=e[1];return{columns:E(t,i,r,u,a),rows:E(n,c,o,s,l)}},getIndentX:function(){return i},getIndentY:function(){return c},getVersion:function(){return a.getVersion()+l.getVersion()}}}([Wt,Pt],[Bt,Yt],g,zt,Lt)}),[Wt,Pt,Bt,Yt,g,zt,Lt]),Ft=Gt.getVisibleCells,Kt=Gt.cellToPixel,Zt=Gt.getVersion,Jt=Object(a.useMemo)((function(){return Ft([ot,ct])}),[Ft,ot,ct,Zt()]);Object(a.useLayoutEffect)((function(){e.onScrollChange&&e.onScrollChange([].concat(Jt.rows),[].concat(Jt.columns))}),[Jt,e.onScrollChange]);var Xt=function(t,n,a){void 0===n&&(n=!0),void 0===a&&(a=!1),function(e,t){var n=e[0],a=e[1],l=t[0],r=t[1];return ce(n,l)&&ce(a,r)}(ne,t)||ue(function(e){var t=e[0],n=e[1];t=t.slice(),n=n.slice();var a=oe(t,n);return-1===a[0]&&(t[0]=n[0]=-1),-1===a[1]&&(t[1]=n[1]=-1),[t,n]}(t));var l=u.current;if(l){if(n){var r=t[0],o=t[1];!function(e,t,n,a,l,r,o,i){var c=t[0],u=t[1],s=n[0],d=n[1],f=l[0],v=l[1],h=o.cellToAbsolute,m=o.cellToPixel,g=o.columnToPixel,y=o.rowToPixel,p=h(a),b=p[0],C=p[1],x=m(t),E=x[0],O=x[1],S=m(t,w),j=S[0],M=S[1],N=l[0],D=l[1];if(E<=b&&(N=c-a[0]),O<=C&&(D=u-a[1]),j>s)for(var k=j-s+g(N);g(++N)<k;);if(M>d)for(var T=M-d+y(D);y(++D)<T;);var I=[N>=0?N:f,D>=0?D:v];if(!ce(I,l)){var A=h(I),R=h([0,0],[.5,.5]),H=R[0],z=R[1];i(I,re(r,A)),setTimeout((function(){var t=A[0],n=A[1];e.scrollLeft=t-H,e.scrollTop=n-z}))}}(l,a?o:r,[ot,ct],[Wt,Pt],g,d,Gt,(function(e,t){M(e),f(t)}))}if(e.onSelectionChanged){var i=be(t),c=i[0],s=c[0],v=c[1],h=i[1],m=h[0],y=h[1];e.onSelectionChanged(s,v,m,y)}}},Qt=function(t){if(e.onChange){var n=Xe[0],a=Xe[1];e.onChange([{x:n,y:a,value:void 0!==t?t:_e}])}Qe(x)},Vt=function(e,t){void 0===t&&(t=!1);var n=e[0],a=e[1];if(!bt(n,a)){var l=xt(n,a),r="";null!==l&&void 0!==l&&(r=l),Qe(e),et(r),at(t),ln(Et.apply(void 0,e))}},Ut=Object(a.useRef)(S),qt=Object(a.useRef)(null);!function(e,t,n,l){Object(a.useLayoutEffect)((function(){var a=e.current;if(a&&!n&&!ye(t)){var r=Ne(t,l);r.match(/^[\t\n]*$/)&&(r=" "+r),a.value=r}}),[t,n,l,e]),Object(a.useLayoutEffect)((function(){var t=e.current;if(t){if(!n&&document.activeElement!==t){var a=document.activeElement.tagName.toLowerCase();"div"===a&&"true"===document.activeElement.contentEditable||"input"===a||"textarea"===a||"select"===a||(t.focus({preventScroll:!0}),t.select())}}}))}(qt,ne,At,xt),function(e,t,n,l,r){Object(a.useEffect)((function(){var a=function(a){var o=e.current;if(o&&a.target===o){a.preventDefault();var i,c=a.clipboardData||window.clipboardData,u=c.types;if(u.includes("text/html")){var s=c.getData("text/html");i=De(t,s,r)}else if(u.includes("text/plain")){var d=c.getData("text/plain");i=ke(t,d,r)}if(i){var f=i,v=f.selection,h=f.changes;null===l||void 0===l||l(h),null===n||void 0===n||n(v)}}};return window.document.addEventListener("paste",a),function(){window.document.removeEventListener("paste",a)}}),[e,t])}(qt,ne,Xt,e.onChange,bt);var $t=function(e,t,n,l,r){return Object(a.useCallback)((function(a){if(a.target&&a.target instanceof Element){var o=n.absoluteToCell,i=(0,n.cellToAbsolute)([0,0],[.5,.5]),c=i[0],u=i[1],s=[a.target.scrollLeft+c,a.target.scrollTop+u],d=o(s);ce(d,e)||null===l||void 0===l||l(d);var f,v,h=s[0],m=s[1],g=t[0]<h+1?1.5:1,y=t[1]<m+1?1.5:1;(g>1||y>1)&&(null===r||void 0===r||r((v=[g,y],[(f=t)[0]*v[0],f[1]*v[1]])))}}),[n,l,r])}(g,d,Gt,M,f),_t=function(e,t,n,l,r,o,i,c,u,s,d,f,v,h,g,p,b,x,E,O,S,j,M,N,D,k,T,I,A,R,H,z,L,P,B){var K=Object(a.useState)(null),Z=K[0],J=K[1],X=Object(a.useState)(null),Q=X[0],V=X[1],U=Object(a.useState)(null),q=U[0],$=U[1],te=Object(a.useState)(null),ne=te[0],oe=te[1],ie=Object(a.useState)(null),ce=ie[0],ue=ie[1],se=Object(a.useState)(!1),he=se[0],ye=se[1],Ce=Object(a.useState)(!1),Ee=Ce[0],Oe=Ce[1],Se=Object(a.useState)(!1),je=Se[0],Ne=Se[1],De=Object(a.useState)(!1),ke=De[0],Te=De[1],Ie=h.hideRowHeaders,Ae=h.hideColumnHeaders,Re=f.cellToPixel,He=(0,f.getVersion)(),ze=Object(a.useMemo)((function(){var e=be(t)[1],n=e[0],a=e[1];return me(t)?le(ae(Re([0,a],[0,1]),[.5*W,0]),w):ge(t)?le(ae(Re([n,0],[1,0]),[0,.5*W]),w):function(e){var t=e[0],n=t[0],a=t[1],l=e[1],r=l[0],o=l[1];return-1!==n&&-1!==r&&-1!==a&&-1!==o}(t)?le(Re([n,a],w),w):null}),[t,Re,He]),Le={selection:t,knobArea:n,editMode:l,editData:r,sourceData:o,cellLayout:f,visibleCells:v,hitTarget:Z,knobPosition:ze,columnResize:Q,rowResize:q,columnDrag:ne,rowDrag:ce,draggingKnob:he,draggingSelection:Ee,draggingRowSelection:je,draggingColumnSelection:ke},We=Object(a.useRef)(Le);We.current=Le;var Pe=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return null;var t=e.target.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}),[]),Be=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return[0,0];var t=e.target;return[t.scrollLeft,t.scrollTop]}),[]),Ye=Object(a.useCallback)((function(t){var n=e.current;if(!n)return null;for(var a,l=y(n);!(a=l()).done;){var r=a.value,o=r.rect;if(pe(o,t))return r}return null}),[e]),Ge=Object(a.useCallback)((function(){window.document.body.style.cursor="auto"}),[]),Fe=Object(a.useCallback)((function(e){var t,n,a=We.current,r=a.selection,o=a.cellLayout,i=o.columnToPixel,f=o.rowToPixel,v=o.pixelToCell,h=o.getIndentX,m=o.getIndentY,C=a.visibleCells,w=C.columns,E=C.rows,N=a.knobPosition;if(0===e.button){null===(t=e.target)||void 0===t||null===(n=t.setPointerCapture)||void 0===n||n.call(t,e.pointerId);var k=Pe(e);if(k){var T=k[0],I=k[1],L=Ye(k);if(L)return J(L),void(We.current.hitTarget=L);var B=be(r),Y=B[0],G=Y[0],K=Y[1],Z=B[1],X=Z[0],Q=Z[1],U=de(r)((function(e){return e})),q=fe(r)((function(e){return e}));if(!Ae&&I<m()){if(A){var te=i(G)+F,ne=i(X,1)-F;if(ee(T,te,ne)||b)for(var ae,le=y(w);!(ae=le()).done;){var re=ae.value,ie=i(re,0),ce=i(re,1);if(ge(r)&&ee(T,ie,ce)&&(ee(re,G,X)||null!==b&&void 0!==b&&b.has(g(re)))&&s(re)){window.document.body.style.cursor="grabbing";var se=[].concat(new Set([].concat(U,b?w.filter((function(e){return b.has(g(e))})):[])).values());se.sort((function(e,t){return e-t}));var ve=se;if(b){var he=we([[re,-1],[re,-1]],g,b,0),pe=he[0][0],Ce=he[1][0],xe=!(G>Ce||X<pe),Ee=xe?Math.min(G,pe):pe,Se=xe?Math.max(X,Ce):Ce;ve=_(Se-Ee+1,Ee)}var je=i(X,1)-i(G),Me=Be(e)[0];return oe({anchor:T,scroll:Me,size:je,indices:se}),null===M||void 0===M||M([0,0]),void(null===j||void 0===j||j([ve,null]))}}}if(H)for(var De,ke=y(w);!(De=ke()).done;){var Re=De.value,He=i(Re,1);if(Math.abs(He-T)<F&&c(Re)){window.document.body.style.cursor="col-resize";var ze=ge(r)&&X===Re,Le=ze?U:[Re],Ge=ze?i(X,1)-i(G):i(Re,1)-i(Re),Fe=Be(e)[0];return void V({anchor:T,scroll:Fe,size:Ge,indices:Le})}}}if(!Ie&&T<h()){if(R){var Ke=f(K)+F,Ze=f(Q,1)-F;if(ee(I,Ke,Ze)||x)for(var Je,Xe=y(E);!(Je=Xe()).done;){var Qe=Je.value,Ve=f(Qe,0),Ue=f(Qe,1);if(me(r)&&ee(I,Ve,Ue)&&(ee(Qe,K,Q)||null!==x&&void 0!==x&&x.has(p(Qe)))&&d(Qe)){window.document.body.style.cursor="grabbing";var qe=[].concat(new Set([].concat(q,x?E.map((function(e,t){return t})).filter((function(e){return x.has(p(e))})):[])).values());qe.sort((function(e,t){return e-t}));var $e=qe;if(x){var _e=we([[-1,Qe],[-1,Qe]],p,x,1),et=_e[0][1],tt=_e[1][1],nt=!(K>tt||Q<et),at=nt?Math.min(K,et):et,lt=nt?Math.max(Q,tt):tt;$e=_(lt-at+1,at)}var rt=f(Q,1)-f(K),ot=Be(e)[1];return ue({anchor:I,scroll:ot,size:rt,indices:qe}),null===M||void 0===M||M([0,0]),void(null===j||void 0===j||j([null,$e]))}}}if(z)for(var it,ct=y(E);!(it=ct()).done;){var ut=it.value,st=f(ut,1);if(Math.abs(st-I)<F&&u(ut)){window.document.body.style.cursor="row-resize";var dt=me(r)&&Q===ut,ft=dt?q:[ut],vt=dt?f(Q,1)-f(K):f(ut,1)-f(ut),ht=Be(e)[1];return void $({anchor:I,scroll:ht,size:vt,indices:ft})}}}if(N){var mt=N[0],gt=N[1];if(Math.abs(T-mt)<W&&Math.abs(I-gt)<W)return ye(!0),void(null===S||void 0===S||S(r))}var yt=v(k),pt=e.shiftKey?[].concat(r[0]):yt;l&&(P||null===O||void 0===O||O());var bt=!0;!Ie&&T<h()&&(bt=!1,Ne(!0),pt[0]=-1,yt[0]=-1),!Ae&&I<m()&&(bt=!1,Te(!0),pt[1]=-1,yt[1]=-1),Oe(!0),null===D||void 0===D||D([pt,yt],bt,!0)}}}),[Pe,Be,Ye,A,R,H,z,S,D,O,c,u,s,d,P,g,p,b,x]),Ke=Object(a.useCallback)((function(e){var t,n=We.current,a=n.knobArea,l=n.selection,r=n.sourceData,o=n.editData,c=n.columnDrag,u=n.rowDrag,s=n.draggingKnob,d=n.hitTarget,f=n.cellLayout,v=f.pixelToColumn,h=f.pixelToRow,m=f.getIndentX,y=f.getIndentY;if(a&&s){var C=Me(a,l,r,o,i);null===I||void 0===I||I(C),null===D||void 0===D||D(a,!0,!0),null===S||void 0===S||S(null)}var w=Pe(e);if(w&&(c||u)){window.document.body.style.cursor="auto",null===j||void 0===j||j([null,null]),null===M||void 0===M||M(null),null===N||void 0===N||N(null);var E=w[0],O=w[1],H=be(l),z=H[0],L=z[0],W=z[1],P=H[1],Y=P[0],G=P[1],F=v(Math.max(E,m()),.5),K=h(Math.max(O,y()),.5);if(c){var Z=c.indices,X=F>=L&&F<=Y+1,Q=null===b||void 0===b?void 0:b.has(g(E));if(!X&&!Q){var U=Z.filter((function(e){return e<F})),q=F-U.length;B||null===D||void 0===D||D([[q,W],[q+Z.length-1,G]]),null===A||void 0===A||A(Z,q),null===k||void 0===k||k(Math.min(L,q))}}if(u){var _=u.indices,ee=K>=W&&K<=G+1,te=null===x||void 0===x?void 0:x.has(p(O));if(!ee&&!te){var ne=_.filter((function(e){return e<K})),ae=K-ne.length;B||null===D||void 0===D||D([[L,ae],[Y,ae+_.length-1]]),null===R||void 0===R||R(_,ae),null===T||void 0===T||T(Math.min(W,ae))}}}if((Oe(!1),Ne(!1),Te(!1),ye(!1),V(null),oe(null),$(null),ue(null),w&&d)&&(J(null),JSON.stringify(d.rect)===JSON.stringify(null===(t=Ye(w))||void 0===t?void 0:t.rect))){var le,re=d.obj;null===(le=re.onClick)||void 0===le||le.call(re,e)}}),[Pe,Ye,I,D,S,N,A,R,B]),Ze=Object(a.useCallback)((function(e){var t=We.current,n=t.selection,a=t.visibleCells,l=t.knobPosition,r=t.columnResize,o=t.columnDrag,i=t.rowResize,f=t.rowDrag,v=t.draggingKnob,h=t.draggingSelection,m=t.draggingColumnSelection,w=t.draggingRowSelection,E=t.cellLayout,O=E.columnToPixel,j=E.rowToPixel,I=E.pixelToCell,L=E.pixelToColumn,P=E.pixelToRow,B=E.getIndentX,K=E.getIndentY,Z=Pe(e);if(Z){window.document.body.style.cursor="auto",Ye(Z)?window.document.body.style.cursor="pointer":o||f?window.document.body.style.cursor="grabbing":r?(window.document.body.style.cursor="col-resize",e.preventDefault()):i?(window.document.body.style.cursor="row-resize",e.preventDefault()):(w||m)&&e.preventDefault();var J=a.columns,X=a.rows,Q=Z[0],V=Z[1],U=be(n),q=U[0],$=q[0],_=q[1],te=U[1],ne=te[0],ae=te[1];if(!(r||o||i||f||w||m)){if(!Ae&&V<K()){if(A){var le=O($)+F,oe=O(ne,1)-F;if(ee(Q,le,oe)||b)for(var ie,ce=y(J);!(ie=ce()).done;){var ue=ie.value,se=O(ue),de=O(ue,1);if(!m&&ge(n)&&ee(Q,se,de)&&(ee(ue,$,ne)||null!==b&&void 0!==b&&b.has(g(ue)))&&s(ue))return void(window.document.body.style.cursor="grab")}}if(H)for(var fe,he=y(J);!(fe=he()).done;){var ye=fe.value,pe=O(ye,1);if(Math.abs(pe-Q)<F&&c(ye))return void(window.document.body.style.cursor="col-resize")}}if(!Ie&&Q<B()){if(R){var Ce=j(_)+F,we=j(ae,1)-F;if(ee(V,Ce,we)||x)for(var Ee,Oe=y(X);!(Ee=Oe()).done;){var Se=Ee.value,je=j(Se),Me=j(Se,1);if(!w&&me(n)&&ee(V,je,Me)&&(ee(Se,_,ae)||null!==x&&void 0!==x&&x.has(p(Se)))&&d(Se))return void(window.document.body.style.cursor="grab")}}if(z)for(var Ne,De=y(X);!(Ne=De()).done;){var ke=Ne.value,Te=j(ke,1);if(Math.abs(Te-V)<F&&u(ke))return void(window.document.body.style.cursor="row-resize")}}if(l){var Re=l[0],He=l[1];if(Math.abs(Q-Re)<W&&Math.abs(V-He)<W)return void(window.document.body.style.cursor="crosshair")}}if(r){if(H){var ze=r.size,Le=r.anchor,Ge=r.scroll,Fe=r.indices,Ke=Be(e)[0],Ze=Math.max(ze+Q-Le+Ge-Ke,Y*Fe.length);null===k||void 0===k||k(Fe[0]-1),H(Fe,Ze/Fe.length)}}else if(i){if(z){var Je=i.size,Xe=i.anchor,Qe=i.scroll,Ve=i.indices,Ue=Be(e)[1],qe=Math.max(Je+V-Xe+Qe-Ue,G*Ve.length);null===T||void 0===T||T(Ve[0]-1),z(Ve,qe/Ve.length)}}else{if(h){var $e=n[0],_e=I(Z),et=$e[0],tt=$e[1],nt=_e[0],at=_e[1];w?null===D||void 0===D||D([[-1,tt],[-1,Math.max(0,at)]],!1):m?null===D||void 0===D||D([[et,-1],[Math.max(0,nt),-1]],!1):null===D||void 0===D||D([re($e,C),re(_e,C)],!1)}if(v){window.document.body.style.cursor="crosshair";var lt=I(Z),rt=lt[0],ot=lt[1],it=be(n),ct=it[0],ut=ct[0],st=ct[1],dt=it[1],ft=dt[0],vt=dt[1],ht=Math.min(rt-ut,ft-rt,0),mt=Math.min(ot-st,vt-ot,0);ve(n)||ht>mt?ot<st?st=ot:ot>vt&&(vt=ot):rt<ut?ut=rt:rt>ft&&(ft=rt),null===S||void 0===S||S([[ut,st],[ft,vt]])}if(o||f){var gt=Z[0],yt=Z[1];if(o){var pt=L(Math.max(gt,B()),.5),bt=pt>=$&&pt<=ne+1,Ct=xe(pt,g),wt=o.anchor,xt=o.scroll,Et=gt-wt,Ot=Be(e)[0];null===M||void 0===M||M([Et+Ot-xt,0]),null===N||void 0===N||N(bt||Ct?null:[[pt,-1],[pt,-1]])}if(f){var St=P(Math.max(yt,K()),.5),jt=St>=_&&St<=ae+1,Mt=xe(St,p),Nt=f.anchor,Dt=f.scroll,kt=yt-Nt,Tt=Be(e)[1];null===M||void 0===M||M([0,kt+Tt-Dt]),null===N||void 0===N||N(jt||Mt?null:[[-1,St],[-1,St]])}}}}}),[Pe,Be,Ye,H,z,j,M,N,D,S,T,k,g,p]),Je=Object(a.useCallback)((function(e){var t=We.current.cellLayout.pixelToCell;if(e.preventDefault(),!e.shiftKey){var n=Pe(e);if(n)if(Ye(n))window.document.body.style.cursor="pointer";else{var a=t(n);l&&(null===O||void 0===O||O()),null===E||void 0===E||E(a)}}}),[Pe,Ye,O,E]),Xe=Object(a.useCallback)((function(e){var n=We.current.cellLayout,a=n.pixelToCell,l=n.getIndentX,r=n.getIndentY,o=Pe(e);if(o){var i=o[0],c=o[1];if(!(i<=l()||c<=r())){var u=a(o);pe(t,u)||null===D||void 0===D||D([u,u]),Ze(e);var s=m({},e,{cellX:u[0],cellY:u[1]});null===L||void 0===L||L(s)}}}),[Pe,D,Ze,L]);return{knobPosition:ze,mouseHandlers:{onPointerLeave:Ge,onPointerDown:Fe,onPointerMove:Ze,onPointerUp:Ke,onDoubleClick:Je,onContextMenu:Xe}}}(Ut,ne,he,At,xt,Ct,bt,vt,ht,mt,gt,Gt,Jt,St,pt,yt,Mt,Nt,Vt,Qt,Ce,Ge,Ae,Ze,Xt,e.cacheLayout?zt.clearAfter:void 0,e.cacheLayout?Lt.clearAfter:void 0,e.onChange,e.onColumnOrderChange,e.onRowOrderChange,e.onCellWidthChange,e.onCellHeightChange,e.onRightClick,e.dontCommitEditOnSelectionChange,e.dontChangeSelectionOnOrderChange),en=_t.mouseHandlers,tn=_t.knobPosition;Object(a.useLayoutEffect)((function(){var e=c.current;if(e){var t=e.getContext("2d");if(t){var n=window.requestAnimationFrame((function(){Ut.current=function(e,t,n,a,l,r,o,i,c,u,s,d,f,v,h,g,p,b,C,w){var x=e.canvas,E=x.width,O=x.height,S=a.hideGridlines,M=a.hideRowHeaders,L=a.hideColumnHeaders,P=a.rowHeaderWidth,B=a.columnHeaderHeight,Y=a.freezeColumns,G=a.freezeRows,F=a.shadowBlur,K=a.shadowColor,Z=a.shadowOpacity,q=n.columns,$=n.rows,_=t.columnToPixel,te=t.rowToPixel,ne=t.columnToAbsolute,ae=t.rowToAbsolute,le=[],re=[Y,G],oe=[P,B];Le(x),e.clearRect(0,0,E,O),e.fillStyle="white",e.fillRect(0,0,E,O),e.shadowColor="#00000080";for(var ie,ce=y($);!(ie=ce()).done;)for(var ue,se=ie.value,de=y(q);!(ue=de()).done;){var fe=ue.value,ve=_(fe),he=_(fe,1),pe=te(se),Ce=te(se,1),we=l(fe,se).fillColor;we&&(e.fillStyle=we,e.fillRect(ve,pe,he-ve,Ce-pe))}var xe=!ye(r),Ee=me(r),Oe=ge(r),Se=ze(r,t,re,oe,w),je=Se[0],Me=Se[1];if(xe){var Ne=je[0],De=Ne[0],ke=Ne[1],Te=je[1],Ie=Te[0],Ae=Te[1];e.fillStyle=D,e.fillRect(De,ke,Ie-De,Ae-ke)}if(!M&&(e.fillStyle=R,e.fillRect(0,0,P,e.canvas.height),xe&&!Oe)){var Be=je[0][1],Ye=je[1][1];e.fillStyle=z,e.fillRect(0,Be,P,Ye-Be)}if(!L&&(e.fillStyle=R,e.fillRect(0,0,e.canvas.width,B),xe&&!Ee)){var Ge=je[0][0],Fe=je[1][0];e.fillStyle=z,e.fillRect(Ge,0,Fe-Ge,B)}e.strokeStyle=k,e.lineWidth=1;var Ke=S?P:e.canvas.width,Ze=S?B:e.canvas.height,Je=function(t,n){e.beginPath(),e.moveTo(t-.5,0),e.lineTo(t-.5,n),e.stroke()},Xe=function(t,n){e.beginPath(),e.moveTo(0,t-.5),e.lineTo(n,t-.5),e.stroke()};Je(P,e.canvas.height),Xe(B,e.canvas.width);for(var Qe,Ve=y(q);!(Qe=Ve()).done;){Je(_(Qe.value,1),Ze)}for(var Ue,qe=y($);!(Ue=qe()).done;){Xe(te(Ue.value,1),Ke)}var $e=be(r),_e=$e[0],et=_e[0],tt=_e[1],nt=$e[1],at=nt[0],lt=nt[1];if(!M){e.textBaseline="middle",e.textAlign="center",e.font=J.fontSize+"px "+J.fontFamily,e.fillStyle=H;for(var rt,ot=y($);!(rt=ot()).done;){var it=rt.value,ct=""+(it+1),ut=ee(it,tt,lt),st=p(it),dt=null!=st&&(null===C||void 0===C?void 0:C.has(st)),ft=Ee&&ut?V:Ee&&dt?U:ut?Q:j,vt=te(it),ht=te(it,1);le.push.apply(le,Re(e,ct,ft,X,0,vt,P,ht-vt))}}if(!L){e.textBaseline="middle",e.textAlign="center";for(var mt,gt=y(q);!(mt=gt()).done;){var yt,pt=mt.value,bt=null!=(yt=f(pt))?yt:We(pt+1),Ct=ee(pt,et,at),wt=g(pt),xt=null!=wt&&(null===b||void 0===b?void 0:b.has(wt)),Et=Oe&&!Ee&&(Ct||xt)?V:j,Ot=Ct?Q:j,St=m({},v(pt),Ot,Et),jt=_(pt),Mt=_(pt,1);le.push.apply(le,Re(e,bt,St,X,jt,0,Mt-jt,B))}}if(xe){e.strokeStyle=N,e.lineWidth=2;var Nt=je[0],Dt=Nt[0],kt=Nt[1],Tt=je[1],It=Tt[0],At=Tt[1];e.strokeRect(Dt,kt,It-Dt-1,At-kt-1)}for(var Rt,Ht=y(o);!(Rt=Ht()).done;){var zt=Rt.value,Lt=zt.span;if(!ye(Lt)){var Wt=ze(Lt,t,re,oe,w)[0],Pt=Wt[0],Bt=Pt[0],Yt=Pt[1],Gt=Wt[1],Ft=Gt[0],Kt=Gt[1];e.strokeStyle=zt.color,e.lineWidth=1,e.beginPath(),e.strokeRect(Bt-1,Yt-1,Ft-Bt+1,Kt-Yt+1)}}if(c){var Zt=be(c),Jt=Zt[0],Xt=Jt[0],Qt=Jt[1],Vt=Zt[1],Ut=Vt[0],qt=Vt[1],$t=_(Xt),_t=te(Qt),en=_(Ut,1),tn=te(qt,1);e.strokeStyle=A,e.setLineDash([3,3]),e.lineWidth=1,e.strokeRect($t-1,_t-1,en-$t+1,tn-_t+1),e.setLineDash([])}if(i&&!Me){var nn=i[0],an=i[1];e.fillStyle=N,e.fillRect(nn-.5*W,an-.5*W,W,W)}if(s){var ln=s[0],rn=s[1],on=u[0],cn=u[1];if(e.fillStyle=T,on)for(var un,sn=y(on);!(un=sn()).done;){var dn=un.value,fn=_(dn),vn=_(dn,1);e.fillRect(fn+ln,0,vn-fn,O)}if(cn)for(var hn,mn=y(cn);!(hn=mn()).done;){var gn=hn.value,yn=te(gn),pn=te(gn,1);e.fillRect(0,yn+rn,E,pn-yn)}}if(d){var bn=He(d,t),Cn=bn[0],wn=Cn[0],xn=Cn[1],En=bn[1],On=En[0],Sn=En[1];e.strokeStyle=I,e.lineWidth=4,ge(d)&&(On=wn),me(d)&&(Sn=xn),e.strokeRect(wn-1,xn-1,On-wn,Sn-xn)}var jn=w[0],Mn=w[1],Nn=G>0&&Mn>0,Dn=Y>0&&jn>0;if(Nn||Dn){if(Nn){var kn=B+ae(G),Tn=e.createLinearGradient(0,kn,0,kn+F);Pe(Tn,K,Z),e.fillStyle=Tn,e.fillRect(0,kn,E,F)}if(Dn){var In=P+ne(Y),An=e.createLinearGradient(In,0,In+F,0);Pe(An,K,Z),e.fillStyle=An,e.fillRect(In,0,F,O)}}e.textBaseline="middle";for(var Rn,Hn=y($);!(Rn=Hn()).done;)for(var zn,Ln=Rn.value,Wn=y(q);!(zn=Wn()).done;){var Pn=zn.value,Bn=_(Pn),Yn=_(Pn,1),Gn=te(Ln),Fn=te(Ln,1),Kn=h(Pn,Ln);if(null!==Kn&&void 0!==Kn){var Zn=l(Pn,Ln);le.push.apply(le,Re(e,Kn,Zn,J,Bn,Gn,Yn-Bn,Fn-Gn))}}return le}(t,Gt,Jt,St,Ot,ne,jt,tn,he,Ye,Ie,Ke,dt,ft,wt,pt,yt,Mt,Nt,g)}));return function(){window.cancelAnimationFrame(n)}}}}),[Gt,Jt,St,Ot,ne,jt,tn,he,Ie,Ke,dt,ft,wt,pt,yt,Mt,Nt,g]);var nn=Object(a.useState)(""),an=nn[0],ln=nn[1],rn=C,on=0,cn=0,un="right";if(At){var sn=Ot.apply(void 0,Xe);rn=Kt(Xe),rn=ae(rn,w),on=ut(Tt)-3,cn=st(It)-3,un=sn.textAlign||J.textAlign||"left",Et.apply(void 0,Xe)!==an&&(ln(""),Qe(x))}var dn=rn,fn=dn[0],vn=dn[1],hn={value:_e,autoFocus:!0,onKeyDown:function(e){if("Escape"!==e.key){var t="Enter"===e.key?"down":"Tab"===e.key?"right":nt?q[e.key]:null;if(t){e.preventDefault();var n=ie(t),a=re(ae(Xe,n),C);Qt(),Xt([a,a])}}else Qe(x)},style:{position:"absolute",left:fn,top:vn,padding:"0px 4px",width:on,height:cn,outline:"none",border:"none",textAlign:un,color:"black",fontSize:J.fontSize,fontFamily:"sans-serif"}},mn=null===(i=e.inputComponent)||void 0===i?void 0:i.call(e,Tt,It,m({},hn,{onChange:et}),Qt),gn=p,yn={position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",borderBottom:"1px solid #ddd"},pn={width:ot,height:ct,outline:"1px solid #ddd"};St.hideScrollBars&&(delete pn.outline,delete yn.borderBottom,gn="");var bn=Object(a.useMemo)((function(){var t;return null===(t=e.renderInside)||void 0===t?void 0:t.call(e,{visibleCells:Jt,cellLayout:Gt,selection:ne,editMode:At})}),[e.renderInside,Jt,Gt,ne,At]),Cn=Object(a.useMemo)((function(){var t;return null===(t=e.renderOutside)||void 0===t?void 0:t.call(e,{visibleCells:Jt,cellLayout:Gt,selection:ne,editMode:At})}),[e.renderOutside,Jt,Gt,ne,At]);return Object(a.useImperativeHandle)(t,(function(){return m({},Gt,{startEditingCell:Vt})}),[Gt,Vt]),l.a.createElement("div",{style:{position:"relative",height:"100%",overflow:"hidden"}},l.a.createElement("canvas",{style:pn,ref:c}),l.a.createElement("div",Object.assign({ref:u},en,{onScroll:$t,className:gn,style:yn}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:kt+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:Dt+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}}),bn?l.a.createElement("div",{style:{position:"sticky",left:0,top:0}},bn):null),Cn?l.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}},Cn):null,l.a.createElement("textarea",{style:{position:"absolute",top:0,left:0,width:1,height:1,opacity:.01},ref:qt,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onFocus:function(e){return e.target.select()},tabIndex:0,onKeyDown:function(t){if(At&&nt&&t.key in q)Qt();else if(!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())if(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase())if("Backspace"!==t.key&&"Delete"!==t.key){if(!ye(ne)){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key){var n=ne[0],a=n[0],l=n[1];return bt(a,l)?void t.preventDefault():void Vt(n,"Enter"!==t.key)}if(t.key in q){var r=ne[0],o=ne[1],i=q[t.key],c=ie(i);return o=t.metaKey||t.ctrlKey?je(wt,o,i):re(ae(o,c),C),t.shiftKey||(r=o),void Xt([r,o],!0,!0)}t.preventDefault()}}else{var u=be(ne),s=u[0],d=s[0],f=s[1],v=u[1],h=v[0],m=v[1];me(ne)&&(d=0,h=65536),ge(ne)&&(f=0,m=65536);for(var g=[],y=f;y<=m;y++)for(var p=d;p<=h;p++)bt(p,y)||g.push({x:p,y:y,value:null});e.onChange&&e.onChange(g)}else{var b=qt.current;null===b||void 0===b||b.select()}}}),At&&(void 0!==mn?mn:l.a.createElement("input",Object.assign({},hn,{type:"text",onFocus:function(e){return e.target.select()},onChange:function(e){return et(e.target.value)}}))))})),Ye=(n(27),[]),Ge=0;Ge<1e3;Ge++){for(var Fe=[],Ke=0;Ke<100;Ke++)Fe.push("Row: ".concat(Ge,", Col: ").concat(Ke));Ye.push(Fe)}for(var Ze=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],Je=[],Xe=0;Xe<1e3;Xe++){for(var Qe=[],Ve=0;Ve<100;Ve++)Qe.push(1e6*Math.random());Je.push(Qe)}var Ue=new Image;Ue.src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=",Ue.width=10,Ue.height=10;function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},r=Object(a.useState)(e),o=Object(s.a)(r,2),i=o[0],c=o[1],u=Object(a.useState)(t),d=Object(s.a)(u,2),h=d[0],m=d[1],g=function(e,t){var a,l=Object(v.a)(i),r=Object(f.a)(e);try{for(r.s();!(a=r.n()).done;){var o=a.value,u=n(o);if(u>l.length)for(var s=l.length;s<=u;s++)l.push(100);l[u]=t}}catch(d){r.e(d)}finally{r.f()}c(l)},y=function(e,t){var n,a=Object(v.a)(h),r=Object(f.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=l(o);if(i>a.length)for(var c=a.length;c<=i;c++)a.push(22);a[i]=t}}catch(u){r.e(u)}finally{r.f()}m(a)},p=function(e){var t;return null!==(t=i[n(e)])&&void 0!==t?t:100},b=function(e){var t;return null!==(t=h[l(e)])&&void 0!==t?t:22};return{onCellWidthChange:g,onCellHeightChange:y,cellWidth:p,cellHeight:b}}function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(a.useState)(e),l=Object(s.a)(n,2),r=l[0],o=l[1],i=Object(a.useState)(t),c=Object(s.a)(i,2),u=c[0],d=c[1],f=function(e){var t;return null!==(t=r[e])&&void 0!==t?t:e},h=function(e){var t;return null!==(t=u[e])&&void 0!==t?t:e},m=function(e,t){for(var n=Object(v.a)(r),a=Math.max(t+e.length,t+e.reduce((function(e,t){return Math.max(e,t)}),0));n.length<a;)n.push(n.length);for(var l=0;l<e.length;++l)n.splice(e[l]-l,1);n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){var t;return null!==(t=r[e])&&void 0!==t?t:e}))))),o(n)},g=function(e,t){for(var n=Object(v.a)(u),a=Math.max(t+e.length,t+e.reduce((function(e,t){return Math.max(e,t)}),0));n.length<a;)n.push(n.length);for(var l=0;l<e.length;++l)n.splice(e[l]-l,1);n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){var t;return null!==(t=u[e])&&void 0!==t?t:e}))))),d(n)};return{getColumnOrder:f,getRowOrder:h,onColumnOrderChange:m,onRowOrderChange:g}}function _e(){var e=Object(a.useState)(Ye),t=Object(s.a)(e,2),n=t[0],r=t[1],o=$e(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=qe([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,editKeys:function(e,t){return"".concat(e,",").concat(t)},cacheLayout:!0}))}function et(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Ze))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=$e(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=qe([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,cacheLayout:!0}))}var tt=new Image;function nt(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Ze))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=qe(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight,h=["#f00","#0f0","#00f","#000"],m=["left","right","center"],g=["normal","bold","lighter"],y=[0,0,0,0,20];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:function(e){return 0===e?{items:[{content:"A",x:0,y:0,horizontalAlign:"center"},{content:Ue,x:0,y:-6,width:12,height:12,horizontalAlign:"right",onClick:function(){console.log("click")}}]}:null},cellStyle:function(e,t){return 0===e||0===t?{fillColor:"#6DA2FB22",marginRight:10}:{color:h[t%4],textAlign:m[e%3],marginRight:y[e%5],weight:g[t%3]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,l;return 0===e&&t>0&&t<9?{items:[{content:tt,x:0,y:-8,width:16,height:16,horizontalAlign:"right",onClick:function(){!function(e,t){var a=Object(v.a)(n);a[t]&&void 0!==a[t][e]&&(a[t][e]+=1),r(a)}(e,t)}},{content:null===n||void 0===n||null===(l=n[t])||void 0===l?void 0:l[e],x:0,y:0,horizontalAlign:"left"}]}:null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,sheetStyle:{freezeColumns:1,freezeRows:1},cacheLayout:!0}))}function at(){var e=Object(a.useState)(Je),t=Object(s.a)(e,2),n=t[0],r=t[1],o=qe(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,l,r;return null===n||void 0===n||null===(a=n[t])||void 0===a||null===(l=a[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=Number(o.value)}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,cacheLayout:!0}))}function lt(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Ze))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=qe(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{selection:[[1,2],[1,2]],onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=o.x,c=o.y,u=o.value;a[c]||(a[c]=[]),a[c][i]=u}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,renderInside:function(e){var t=e.visibleCells,n=e.cellLayout,a=e.selection;if(!e.editMode){var r=[1,2],o=Object(s.a)(a,1)[0],i=o[0]===r[0]&&o[1]===r[1];if(!(t.columns.includes(r[0])&&t.rows.includes(r[1])))return null;var c=n.cellToPixel(r,[0,0]),u=Object(s.a)(c,2)[1],d=n.cellToPixel(r,[1,1]),f=Object(s.a)(d,1)[0],v=l.a.createElement("div",{style:{position:"absolute",left:f,top:u,marginLeft:"-12px",borderTop:"12px solid blue",borderLeft:"12px solid transparent",pointerEvents:"none"}}),h=i?l.a.createElement("div",{style:{position:"absolute",left:f,top:u,padding:10,background:"#fff",border:"1px solid #ccc"}},"Hello world"):null;return l.a.createElement("div",{onPointerDown:function(e){return e.stopPropagation()}},h,v)}},cacheLayout:!0}))}function rt(){var e=Object(a.useState)(Ye),t=Object(s.a)(e,2),n=t[0],r=t[1],o=$e(),i=o.onColumnOrderChange,c=o.onRowOrderChange,u=o.getColumnOrder,d=o.getRowOrder,h=qe([],[],u,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight,b=[1,1,1,2,2,2,3,3,4,4,5,6,6,7,8,8],C=b.map((function(e,t){return b[d(t)]})),w=C.map((function(e,t){return e!==C[t-1]})).reduce((function(e,t){var n,a=null!==(n=e.at(-1))&&void 0!==n?n:1,l=t?1-a:a;return e.push(l),e}),[]);return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{fillColor:["#ffffff","#e0e0e0"][w[t]]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[u(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,i=u(o.x),c=d(o.y);a[c]||(a[c]=[]),a[c][i]=o.value}}catch(s){l.e(s)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:c,rowGroupKeys:function(e){return C[e]},editKeys:function(e,t){return"".concat(e,",").concat(t)},cacheLayout:!0}))}function ot(){var e=Object(a.useState)("initial"),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(s.a)(o,2),c=i[0],u=i[1],d=qe(),h=d.onCellWidthChange,m=d.onCellHeightChange,g=d.cellWidth,y=d.cellHeight;return l.a.createElement(l.a.Fragment,null,"initial"===n?l.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),r("loading"),fetch("./out.json").then((function(e){return e.json()})).then((function(e){u(e),r("done")}))}},"Load global database of power plants"):"loading"===n?"Loading...":null,l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{cellStyle:function(e,t){return 0===t?{weight:"bold",fontSize:14}:4===e?{textAlign:"right"}:1===e?{weight:"bold",color:"#3b85ff"}:2===e?{color:"#fc3bff"}:{}},editData:function(e,t){var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},displayData:function(e,t){var n;return 4===e&&t>0?c&&c[t]&&c[t][e]?Number(c[t][e]).toFixed(2):"":null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},sourceData:function(e,t){var n;return null===c||void 0===c||null===(n=c[t])||void 0===n?void 0:n[e]},cellWidth:g,cellHeight:y,onChange:function(e){var t,n=Object(v.a)(c),a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var l=t.value;n[l.y]||(n[l.y]=[]),n[l.y][l.x]=l.value}}catch(r){a.e(r)}finally{a.f()}u(n)},readOnly:function(e,t){return!1},onCellWidthChange:h,onCellHeightChange:m,columnHeaderStyle:function(e){var t=(2421*e%255).toString(16).padStart(2,"0"),n=(3215*e%255).toString(16).padStart(2,"0"),a=(1243*e%255).toString(16).padStart(2,"0");return{backgroundColor:"#".concat(t).concat(n).concat(a,"55")}},columnHeaders:function(e){return""+e},sheetStyle:{freezeColumns:0,freezeRows:1},cacheLayout:!0})))}tt.src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==",tt.width=16,tt.height=16;var it=["First","Second","Third","Fourth","Fifth"],ct=["Sixth","Seventh","Eighth","Ninth","Tenth"],ut=[it,ct,it,ct,it,ct,it];function st(){var e=Object(a.useState)(JSON.parse(JSON.stringify(ut))),t=Object(s.a)(e,2),n=t[0],r=t[1],o=qe(),i=o.onCellWidthChange,c=o.onCellHeightChange,u=o.cellWidth,d=o.cellHeight;return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:u,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),l=Object(f.a)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){l.e(i)}finally{l.f()}r(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:c,inputComponent:dt,cacheLayout:!0}))}function dt(e,t,n,a){return l.a.createElement("div",{style:Object(d.a)(Object(d.a)({},n.style),{},{backgroundColor:"#fff"})},l.a.createElement("div",{style:{border:"1px solid #ddd",boxShadow:"3px 5px 5px #ddd"}},(t%2?ct:it).map((function(e){return l.a.createElement(ft,{key:e,opt:e,value:n.value,clickHandler:function(){a(e)}})}))))}function ft(e){var t=e.opt,n=e.value,r=e.clickHandler,o=Object(a.useState)(!1),i=Object(s.a)(o,2),c=i[0],u=i[1];return l.a.createElement("div",{onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)},style:{backgroundColor:n===t||c?"#f6f6f6":"#fff",padding:"5px 10px",cursor:"pointer"},value:t,onClick:function(){return r(t)}},t)}function vt(){var e=Object(a.useState)([[1,2,3],[10,20,30]]),t=Object(s.a)(e,1)[0];return l.a.createElement("div",{className:"sheet-box"},l.a.createElement(Be,{sourceData:t,displayData:function(e,n){var a,l,r;return null===t||void 0===t||null===(a=t[n])||void 0===a||null===(l=a[e])||void 0===l||null===(r=l.toFixed)||void 0===r?void 0:r.call(l,2)}}))}var ht=n(17),mt=n.n(ht);var gt=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],o=n[1];return l.a.createElement("div",{className:"container blue-bg",id:"home"},l.a.createElement("div",{className:"content flex-row header"},l.a.createElement("div",{className:"box text-box"},l.a.createElement("div",null,l.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),l.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",l.a.createElement("br",null),"And it's super fast.")),l.a.createElement("div",{className:"lib-box"},l.a.createElement("div",{className:"install-box",onClick:function(t){e.current.select(),document.execCommand("copy"),t.target.focus(),o("Copied!"),setTimeout((function(){o("")}),1e3)}},l.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==r&&l.a.createElement("div",{className:"copy-success"},r)),l.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",rel:"noopener noreferrer",className:"git-box",target:"_blank"},l.a.createElement("img",{src:mt.a,alt:"Git"}),"view on github"))),l.a.createElement("div",{className:"box"},l.a.createElement(_e,null))))};var yt=function(e){var t=e.title,n=e.id;return l.a.createElement("div",{className:"title-separator",id:n||""},l.a.createElement("p",null,t||"No title"),l.a.createElement("div",{className:"separator"}))};var pt=function(e){var t=e.children;return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"content flex-row"},t))},bt=n(251),Ct=n(250);Ct.a.hljs.padding="10px 20px",Ct.a.hljs.background="#f8f9fa",Ct.a.hljs.width="100%",Ct.a.hljs.maxWidth="100%",Ct.a.hljs.overflow="auto",Ct.a.hljs.borderRadius="3px",Ct.a.hljs.fontSize="14px";function wt(){var e=Object(d.a)({},Ct.a);return e.hljs.height="100%",l.a.createElement(bt.a,{language:"javascript",style:e},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);')}function xt(){return l.a.createElement(bt.a,{language:"javascript",style:Ct.a},"import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}")}function Et(){return l.a.createElement(bt.a,{language:"javascript",style:Ct.a},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);')}function Ot(){return l.a.createElement(bt.a,{language:"javascript",style:Ct.a},'...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);')}function St(){return l.a.createElement(bt.a,{language:"javascript",style:Ct.a},"...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (columnIdx, newWidth) => {\n    const cw = [...cellWidth];\n    if (columnIdx > cw.length) {\n        for (let i = cw.length; i <= columnIdx; i++) {\n            cw.push(100);\n        }\n    }\n    cw[columnIdx] = newWidth;\n    setCellWidth(cw);\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);")}var jt=function(){return l.a.createElement("div",{className:"footer"},l.a.createElement("p",{className:"copy"},"made by ",l.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};function Mt(e){var t=e.text;return l.a.createElement("span",{className:"emphased"},t)}var Nt=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(u,null),l.a.createElement(gt,null),l.a.createElement(yt,{title:"Get started",id:"usage"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width colored-pre",style:{overflowX:"auto"}},l.a.createElement("p",null,"Import the component and its style, and render it"),l.a.createElement(xt,null),l.a.createElement("div",{className:"spacer"}),l.a.createElement("p",null,"Display some data"),l.a.createElement(Et,null))),l.a.createElement(yt,{title:"Learn more about features",id:"features"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(et,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Basic spreadsheet"),l.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize and reorder columns and rows."))),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(nt,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Styling"),l.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns, and add clickable images."))),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(at,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Formatting"),l.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(lt,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Overlays"),l.a.createElement("p",null,"You can attach HTML overlays to the sheet, for additional controls, notes, etc."))),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(rt,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Grouped rows and columns"),l.a.createElement("p",null,"You can make rows act as a group for drag-and-drop operation."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(yt,{title:"Big dataset example",id:"big dataset example"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("p",null,"Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it will be handled blazingly fast and super responsive because component is canvas-based and it draws only the small chunk of data user sees at the moment."),l.a.createElement("br",null),l.a.createElement(ot,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(yt,{title:"Custom input fields",id:"custom input example"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement(st,null)),l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Custom input component"),l.a.createElement("p",null,"If basic text input isn't enough, you can send your own React component to be displayed instead."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(yt,{title:"Documentation",id:"documentation"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Displaying data"),l.a.createElement("p",null,"If you have some data you want to display, you send it via ",l.a.createElement(Mt,{text:"sourceData"})," and"," ",l.a.createElement(Mt,{text:"displayData"})," props."),l.a.createElement("p",null,"The first one receives unformatted data which is used for data manipulation, and the second one formatted which is used for displaying in cells."),l.a.createElement("br",null),l.a.createElement("p",null,"Each of this can be either array of arrays of values (where each array is representing data for one row) or function (which returns value based on x and y coordinates that are sent as arguments to your function)."))),l.a.createElement(pt,null,l.a.createElement("div",{className:"box colored-pre unmargin-pre",style:{maxWidth:"100%",overflow:"auto"}},l.a.createElement(wt,null)),l.a.createElement("div",{className:"box"},l.a.createElement(vt,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Editing data"),l.a.createElement("p",null,"Same as the previous two, prop ",l.a.createElement(Mt,{text:"editData"})," can recieve either array of arrays of values or function for data which will be displayed in edit mode. Edit mode is activated by double click on the cell."),l.a.createElement("br",null),l.a.createElement("p",null,"Once edit is done, function sent in ",l.a.createElement(Mt,{text:"onChange"})," prop will be called with array of changes as an argument. Each element of this array has value, x and y coordinates. Use this information to change values in your data array."),l.a.createElement("br",null),l.a.createElement("p",null,"Sheet also accepts ",l.a.createElement(Mt,{text:"readOnly"})," prop which you can use if some cells should not be editable. Same as the most of sheet's props, you can send function, array of arrays, or a single value which then is applied to the whole table.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(Ot,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Column headers"),l.a.createElement("p",null,"By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via"," ",l.a.createElement(Mt,{text:"columnHeaders"})," prop as an array or function."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box"},l.a.createElement("h3",null,"Cell style and width/height"),l.a.createElement("p",null,"Use prop ",l.a.createElement(Mt,{text:"cellStyle"})," and ",l.a.createElement(Mt,{text:"columnHeaderStyle"})," for customizing cells visually."),l.a.createElement("br",null),l.a.createElement("p",null,"You can also use ",l.a.createElement(Mt,{text:"cellWidth"})," and ",l.a.createElement(Mt,{text:"cellHeight"})," props to customize cell size. If you send single value ","cellWidth={200}",", it will be applied to all cells. If you send array of values ","cellWidth={[200, 80, 80]}",", they will be applied in respect to the index number."),l.a.createElement("br",null),l.a.createElement("p",null,"There are also ",l.a.createElement(Mt,{text:"onCellWidthChange"})," and ",l.a.createElement(Mt,{text:"onCellHeightChange"})," ","props for functions which are called when user drags cell for resize. You can use these for updating your cellWidth/cellHeight arrays.")),l.a.createElement("div",{className:"box unmargin-pre"},l.a.createElement(St,null))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Selection"),l.a.createElement("p",null,"You can send a function to the ",l.a.createElement(Mt,{text:"onSelectionChanged"})," prop. It will be called on selection change with x1, y1, x2 and y2 arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Right click handler"),l.a.createElement("p",null,"If you send a function to ",l.a.createElement(Mt,{text:"onRightClick"})," prop, it will be called on right click with whole mouse event (extended with cellX and cellY values) as an argument."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Sticky columns/rows"),l.a.createElement("p",null,"Send a number to ",l.a.createElement(Mt,{text:"freezeColumns"})," and/or ",l.a.createElement(Mt,{text:"freezeRows"})," to make first n of columns/rows sticky."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(pt,null,l.a.createElement("div",{className:"box full-width"},l.a.createElement("h3",null,"Custom input"),l.a.createElement("p",null,"By default edit mode turns the cell into a text edit component. But you can send your custom input component via ",l.a.createElement(Mt,{text:"inputComponent"})," props. It will be called with"," ",l.a.createElement(Mt,{text:"x"}),", ",l.a.createElement(Mt,{text:"y"}),", ",l.a.createElement(Mt,{text:"inputProps"})," and"," ",l.a.createElement(Mt,{text:"commitEditingCell"})," arguments."))),l.a.createElement("div",{className:"spacer"}),l.a.createElement(jt,null))};o.a.render(l.a.createElement(Nt,null),document.getElementById("root"))},27:function(e,t,n){}},[[22,1,2]]]);
//# sourceMappingURL=main.b11bd64b.chunk.js.map