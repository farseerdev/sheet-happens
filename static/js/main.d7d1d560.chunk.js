(this["webpackJsonpsheet-happens-example"]=this["webpackJsonpsheet-happens-example"]||[]).push([[0],{10:function(e,t,n){},15:function(e,t,n){e.exports=n.p+"static/media/logo.aef13910.svg"},17:function(e,t,n){e.exports=n.p+"static/media/git.f818b886.svg"},22:function(e,t,n){e.exports=n(247)},247:function(e,t,n){"use strict";n.r(t);n(10);var a=n(0),r=n.n(a),l=n(14),o=n.n(l),i=n(15),u=n.n(i);var c=function(){var e=function(e){var t=document.getElementById(e),n="home"===e?0:86,a=window.pageYOffset+t.getBoundingClientRect().top-n;window.scrollTo({top:a,behavior:"smooth"})};return r.a.createElement("div",{className:"container blue-bg menu"},r.a.createElement("div",{className:"content flex-row"},r.a.createElement("div",{className:"logo-box"},r.a.createElement("img",{src:u.a,alt:"Logo"}),r.a.createElement("h2",{className:"page-title"},"sheet - happens")),r.a.createElement("div",{className:"nav"},r.a.createElement("div",{className:"nav-item",onClick:function(){return e("home")}},"home"),r.a.createElement("div",{className:"nav-item",onClick:function(){return e("usage")}},"usage"),r.a.createElement("div",{className:"nav-item",onClick:function(){return e("features")}},"features"),r.a.createElement("div",{className:"nav-item",onClick:function(){return e("documentation")}},"documentation"))))},s=n(1),d=n(7),f=n(3),v=n(2),h=n(16);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var p="_PxIi8",b=[2e3,1e3],w=[0,0],C=[1,1],x=[-1,-1],E=[-1,-1],S=[E,E],O=[],j=[],M={},N="#1a66ff",D="#d8e6ff80",T="#0000001f",k="#1a66ff30",A="#1a66ff",I="#707070",H="#f6f9fc",L="#666666",R="#e8f0ff",z="#000000",P=6,W=50,B=22,Y=50,G=22,F=4,K=12,J=.05,Z={textAlign:"left",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},X={textAlign:"center",fontSize:12,marginRight:5,marginLeft:5,color:"#000",fontFamily:"sans-serif",weight:"",fillColor:"",backgroundColor:""},Q={color:"#1a66ff"},V={backgroundColor:"#1a66ff",color:"#ffffff"},U={backgroundColor:"#1a66ff70",color:"#ffffff"},_={ArrowRight:"right",ArrowLeft:"left",ArrowUp:"up",ArrowDown:"down"},q=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),Array.from({length:e}).map((function(e,a){return t+n*a}))},$=function(e,t,n){return t<=e&&e<=n},ee=function(e,t,n){return t<=e&&e<n},te=function(e,t,n){return t<e&&e<n},ne=function(e,t){return[e[0]+t[0],e[1]+t[1]]},ae=function(e,t){return[e[0]-t[0],e[1]-t[1]]},re=function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]},le=function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]},oe=function(e){return"left"===e?[-1,0]:"right"===e?[1,0]:"up"===e?[0,-1]:"down"===e?[0,1]:[0,0]},ie=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ue=function(e,t,n){for(var a=e;a<=t;++a)n(a)},ce=function(e){return function(t){var n=we(e),a=n[0][0],r=n[1][0];ue(a,r,t)}},se=function(e){return function(t){var n=we(e),a=n[0][1],r=n[1][1];ue(a,r,t)}},de=function(e){return function(t){var n=[];return e((function(){return n.push(t.apply(void 0,arguments))})),n}},fe=function(e){return de(ce(e))},ve=function(e){return de(se(e))},he=function(e){var t=e[0][0],n=e[1][0];return-1===t&&-1===n},me=function(e){var t=e[0],n=t[0],a=t[1],r=e[1],l=r[0],o=r[1];return-1===n&&-1===l&&-1!==a&&-1!==o},ge=function(e){var t=e[0],n=t[0],a=t[1],r=e[1],l=r[0],o=r[1];return-1===a&&-1===o&&-1!==n&&-1!==l},ye=function(e){var t=e[0],n=t[0],a=t[1],r=e[1],l=r[0],o=r[1];return-1===n&&-1===l&&-1===a&&-1===o},pe=function(e,t){var n=we(e),a=n[0],r=a[0],l=a[1],o=n[1],i=o[0],u=o[1],c=t[0],s=t[1];return c>=r&&c<=i&&s>=l&&s<=u},be=function(e){var t=e[0],n=e[1];t=t.slice(),n=n.slice();var a=le(t,n);return-1===a[0]&&(t[0]=n[0]=-1),-1===a[1]&&(t[1]=n[1]=-1),[t,n]},we=function(e){var t=e[0],n=e[1];return[le(t,n),re(t,n)]},Ce=function(e,t,n,a){for(var r=1,l=n>0?1e3:Math.min(1e3,t+1);r<l;r++){var o=e(t+r*n);if(null==o||!a.has(o))break}return t+(r-1)*n},xe=function(e,t,n,a){if(!n)return e;var r=we(e),l=r[0],o=r[1],i=l[a],u=o[a],c=Ce(t,i,-1,n),s=Ce(t,u,1,n),d=[l.slice(),o.slice()];return d[0][a]=c,d[1][a]=s,function(e,t){var n=e[0],a=n[0],r=n[1],l=e[1],o=l[0],i=l[1],u=t[0],c=t[1],s=u[0],d=u[1],f=(s-c[0]||1)*(o-a||1)<0,v=(d-c[1]||1)*(i-r||1)<0;return[[f?o:a,v?i:r],[f?a:o,v?r:i]]}(d,e)},Ee=function(e,t){var n=t(e-1),a=t(e);return null!=n&&null!=a&&n===a},Se=function(e,t){return Array.isArray(e)?function(n){return n>=0&&n<e.length?e[n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},Oe=function(e,t){return Array.isArray(e)?function(n,a){return a>=0&&a<e.length&&n>=0&&n<e[a].length?e[a][n]:t}:"function"===typeof e?e:null!==e&&void 0!==e?function(){return e}:function(){return t}},je=function(e){for(var t=0,n=0,a=0,r=10,l=1.5;a<4;){for(var o=!0,i=0;i<10;i++){var u=e(t,i);if(null!==u&&void 0!==u&&""!==u){o=!1;break}}if(o&&(a+=1),(t+=r)>1e5)break;r=Math.floor(r*l)}for(a=0,r=10,l=1.5;a<4;){for(var c=!0,s=0;s<10;s++){var d=e(s,n);if(null!==d&&void 0!==d&&""!==d){c=!1;break}}if(c&&(a+=1),(n+=r)>1e5)break;r=Math.floor(r*l)}return[t,n]},Me=function(e,t,n,a,r){var l=we(e),o=l[0],i=o[0],u=o[1],c=l[1],s=c[0],d=c[1],f=we(t),v=f[0],h=v[0],m=v[1],g=f[1],y=g[0],p=g[1],b=i,w=u,C=s,x=d,E=[];if(C-b===y-h){if(w===m?w=p+1:x=m-1,-1===b&&-1===C)b=0,C=je(a)[0];for(var S=m,O=w;O<=x;O++){for(var j=b;j<=C;j++){var M=n(j,S);r(j,O)||E.push({x:j,y:O,value:M,source:{x:j,y:S}})}(S+=1)>p&&(S=m)}}else{if(b===h?b=y+1:C=h-1,-1===w&&-1===x)w=0,x=je(a)[1];for(var N=h,D=b;D<=C;D++){for(var T=w;T<=x;T++){var k=n(N,T);r(D,T)||E.push({x:D,y:T,value:k,source:{x:N,y:T}})}(N+=1)>y&&(N=h)}}return E},Ne=function(e,t,n,r,l,o,i,u,c,s,d,f,v,h,m,g){return Object(a.useLayoutEffect)((function(){var e=t.current;if(e&&!o&&i&&document.activeElement!==e){var n=document.activeElement.tagName.toLowerCase();"div"===n&&"true"===document.activeElement.contentEditable||"input"===n||"textarea"===n||"select"===n||e.focus({preventScroll:!0})}}),[o,i]),{onInputKeyDown:function(t){if("Escape"!==t.key){var n="Enter"===t.key?"down":"Tab"===t.key?"right":e?_[t.key]:null;if(n){t.preventDefault();var a=oe(n),r=re(ne(l,a),w);null===d||void 0===d||d(),null===v||void 0===v||v([r,r])}}else null===f||void 0===f||f()},onGridFocus:function(){null===h||void 0===h||h(!0)},onGridBlur:function(){null===h||void 0===h||h(!1)},onGridKeyDown:function(t){if(o&&e&&t.key in _)null===d||void 0===d||d();else if(!t.metaKey&&!t.ctrlKey||"v"!==String.fromCharCode(t.which).toLowerCase())if(!t.metaKey&&!t.ctrlKey||"c"!==String.fromCharCode(t.which).toLowerCase())if(!t.metaKey&&!t.ctrlKey||"x"!==String.fromCharCode(t.which).toLowerCase())if("Backspace"!==t.key&&"Delete"!==t.key){if(!ye(c))if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90||"Enter"===t.key||"-"===t.key||"."===t.key||","===t.key){var a=c[0],l=a[0],i=a[1];if(n(l,i))return;null===s||void 0===s||s(a,"Enter"!==t.key)}else if(t.preventDefault(),t.key in _){var f=u[0],h=u[1],y=_[t.key],p=oe(y),b=t.shiftKey;if(t.metaKey||t.ctrlKey)h=function(e,t,n){var a=oe(n),r=re(t,w),l=ne(r,a),o=e(l[0],l[1],Z),i=""!==o&&null!==o&&void 0!==o;i||(r=ne(r,a));for(var u=r,c=u[0],s=u[1],d=c+1e5-1,f=s+1e5-1;c<d&&s<f&&c>=0&&s>=0;){var v=e(c,s,Z);if(i&&(""===v||null===v||void 0===v))return ae(r,a);if(!i&&""!==v&&null!==v&&void 0!==v)return r;var h=r=ne(r,a);c=h[0],s=h[1]}return re(r,[0,0])}(r,h,y);else{var C=b?me(c)?[-1,0]:ge(c)?[0,-1]:x:w;h=re(ne(h,p),C)}return b||(f=h),void(null===v||void 0===v||v([f,h],!0,!0))}}else{var E=we(c),S=E[0],O=S[0],j=S[1],M=E[1],N=M[0],D=M[1];me(c)&&(O=0,N=1e5),ge(c)&&(j=0,D=1e5);for(var T=[],k=j;k<=D;k++)for(var A=O;A<=N;A++)n(A,k)||T.push({x:A,y:k,value:null});null===g||void 0===g||g(T)}else null===m||void 0===m||m(!0);else null===m||void 0===m||m(!1)}}},De=function(e,t,n,a){var r=a.cellToAbsolute,l=a.absoluteToColumn,o=a.columnToAbsolute,i=a.absoluteToRow,u=a.rowToAbsolute,c=a.getIndentX,s=a.getIndentY,d=t[0],f=t[1],v=e[0],h=e[1],m=r(n),g=m[0],y=m[1],p=v-g-c(),b=h-y-s(),w=d+n[0],C=f+n[1];return{edge:[l(o(w)+p),i(u(C)+b)],viewport:[p,b]}};"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function Te(e,t){try{var n=e()}catch(a){return t(a)}return n&&n.then?n.then(void 0,t):n}for(var ke={rows:[]},Ae=function(e,t,n,r,l,o,i,u){var c=function(){var e=Object(a.useState)(),t=e[0],n=e[1];Object(a.useLayoutEffect)((function(){var e=function(){return Promise.resolve(Te((function(){return Promise.resolve(navigator.permissions.query({name:"clipboard-read"})).then((function(e){"granted"===e.state&&t()}))}),(function(){})))},t=function(){try{var e=Te((function(){return Promise.resolve(navigator.clipboard.read()).then((function(e){var t=e[0],a=function(){if(t)return Promise.resolve(Le(t)).then((function(e){n(e)}));n(ke)}();if(a&&a.then)return a.then((function(){}))}))}),(function(){}));return Promise.resolve(e&&e.then?e.then((function(){})):void 0)}catch(t){return Promise.reject(t)}},a=function(){return setTimeout(t)};return window.document.addEventListener("cut",a),window.document.addEventListener("copy",a),window.document.addEventListener("focus",e),e(),function(){window.document.removeEventListener("cut",a),window.document.removeEventListener("copy",a),window.document.removeEventListener("focus",e)}}),[]);var r=Object(a.useCallback)((function(){var e;return!!(null==t||null!==(e=t.rows)&&void 0!==e&&e.length)}),[t]);return{peek:t,canPaste:r,copyTable:Ie,pasteTable:He}}(),s=c.canPaste,d=c.copyTable,f=c.pasteTable,v=Object(a.useCallback)((function(e,t){try{var a=t.rows,r=t.payload,i=we(e)[0],c=i[0],s=i[1],d=Math.max(0,c),f=Math.max(0,s),v=a.reduce((function(e,t){return Math.max(e,t.length)}),0),h=a.length,m=[i,ne(i,[v-1,h-1])];return Promise.resolve(null===u||void 0===u?void 0:u(m,a,r)).then((function(e){if(!1!==e){var t=a.flatMap((function(e,t){return e.map((function(e,a){var r=d+a,l=f+t;return null!==n&&void 0!==n&&n(r,l)?null:{x:r,y:l,value:e}}))})).filter((function(e){return!!e}));null===o||void 0===o||o(t),null===l||void 0===l||l(m)}}))}catch(g){return Promise.reject(g)}}),[o,l,n]),h=Object(a.useCallback)((function(e,a){void 0===a&&(a=!1);try{var r,l=We(e,t),u=null===i||void 0===i?void 0:i(e,l,a);if(d(l,u),null!=(r=null===u||void 0===u?void 0:u.cut)?r:a){var c=[];se(e)((function(t){ce(e)((function(e){if(null===n||void 0===n||!n(e,t)){var a={x:e,y:t,value:""};c.push(a)}}))})),null===o||void 0===o||o(c)}return Promise.resolve()}catch(s){return Promise.reject(s)}}),[i,o,n]),m=Object(a.useCallback)((function(e){try{return Promise.resolve(f()).then((function(t){t&&v(e,t)}))}catch(t){return Promise.reject(t)}}),[v]),g=function(t){try{t.preventDefault();var n=t.clipboardData||window.clipboardData;return Promise.resolve(Le(n)).then((function(t){t&&v(e,t)}))}catch(t){return Promise.reject(t)}};return Object(a.useLayoutEffect)((function(){if(r)return window.document.addEventListener("paste",g),function(){window.document.removeEventListener("paste",g)}})),{clipboardApi:Object(a.useMemo)((function(){return{copySelection:h,pasteSelection:m,canPasteSelection:s}}),[h,m,s]),onClipboardCopy:function(t){if(!ye(e))return h(e,t)},onClipboardPaste:g}},Ie=function(e,t){try{var n=Re(e),a=ze(e,null!=t?t:void 0);return Promise.resolve(navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([a],{type:"text/html"}),"text/plain":new Blob([n],{type:"text/plain"})})])).then((function(){var e=new Event("copy");document.dispatchEvent(e)}))}catch(r){return Promise.reject(r)}},He=function(){try{return Promise.resolve(navigator.clipboard.read()).then((function(e){var t=e[0];if(t)return Le(t)}))}catch(e){return Promise.reject(e)}},Le=function(e){try{var t,n,a=function(){return t?{rows:t,payload:n}:{rows:[]}},r=function(t){return e.types.includes(t)},l=function(t){return"getData"in e?e.getData(t):"getType"in e?e.getType(t).then((function(e){return e.text()})):""},o=function(){if(r("text/html"))return Promise.resolve(l("text/html")).then((function(e){var a=Ye(e);t=a.rows,n=a.payload}));var e=function(){if(r("text/plain"))return Promise.resolve(l("text/plain")).then((function(e){t=Ge(e)}))}();return e&&e.then?e.then((function(){})):void 0}();return Promise.resolve(o&&o.then?o.then(a):a())}catch(i){return Promise.reject(i)}},Re=function(e){return e.map((function(e){return e.join("\t")})).join("\n")},ze=function(e,t){var n="<table>"+e.map((function(e){return e.map(Pe).map((function(e){return"<td>"+e+"</td>"})).join("")})).map((function(e){return"<tr>"+e+"</tr>"})).join("\n")+"</table>";return t?'<SheetHappens payload="'+Pe(JSON.stringify(t))+'"></SheetHappens>'+n:n},Pe=function(e){return e.replace(/[&"'<>]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))},We=function(e,t){if(ye(e))return[];var n=we(e),a=n[0],r=a[0],l=a[1],o=n[1],i=o[0],u=o[1];he(e)&&(r=0,i=je(t)[0]);(function(e){var t=e[0][1],n=e[1][1];return-1===t&&-1===n})(e)&&(l=0,u=je(t)[1]);for(var c=[],s=l;s<=u;s++){for(var d=[],f=r;f<=i;f++){var v=t(f,s);null!==v&&void 0!==v&&d.push(null!=v?v:"")}c.push(d)}return c},Be=function e(t,n){for(var a,r=y(t.children);!(a=r()).done;){var l=a.value;if(l.nodeName===n)return l;var o=e(l,n);if(o)return o}},Ye=function(e){var t=document.createElement("div");t.innerHTML=e.trim();var n=[],a=void 0,r=Be(t,"SHEETHAPPENS");if(r){var l=r.getAttribute("payload");try{a=JSON.parse(l)}catch(w){}}var o=Be(t,"TABLE");if(o)for(var i,u=y(o.children);!(i=u()).done;){var c=i.value;if("TBODY"===c.nodeName)for(var s,d=y(c.children);!(s=d()).done;){var f=s.value;if("TR"===f.nodeName){for(var v,h=[],m=y(f.children);!(v=m()).done;){var g=v.value;if("TD"===g.nodeName){var p="";if(0!==g.children.length&&"P"===g.children[0].nodeName){var b=g.children[0];p=0!==b.children.length&&"FONT"===b.children[0].nodeName?b.children[0].textContent.trim():b.textContent.trim()}else p=g.textContent.trim();p=(p=p.replaceAll("\n","")).replaceAll(/\s\s+/g," "),h.push(p)}}n.push(h)}}}return{rows:n,payload:a}},Ge=function(e){return e.split(/\r?\n/).map((function(e){return e.split("\t")}))},Fe=function(e){var t=Ke(256),n=Ke(256),a=0;t.set(0,0);var r=function(t){if(t<0)return 0;if(n.has(t))return n.get(t);var a=e(t)||0;return n.set(t,a),a},l=function(e){if(e<0)return 0;if(t.has(e))return t.get(e);for(var n=t.tail()||0;n<e;){var a=r(n),l=(t.get(n)||0)+a;t.set(++n,l)}return t.get(e)};return{getSize:r,getStart:function(e){return l(e)},getEnd:function(e){return l(e+1)},getVersion:function(){return a},lookupIndex:function(e,n){void 0===n&&(n=0);for(var a=t.tail()||0;l(a)<e&&r(a);)a+=64;for(var o=0,i=a;o<i;){var u=o+Math.floor((i-o)/2)+1;l(u)-(n?n*r(u-1):0)<=e?o=u:i=u-1}return o},setSizer:function(t){e=t},clearAfter:function(e){e=Math.max(0,e),t.truncate(e),n.truncate(e),a++}}},Ke=function(e){var t,n;void 0===e&&(e=128);var a=0,r=function(e){var a=new Uint8Array(e),r=new Uint32Array(e);t&&l(t,a),n&&l(n,r),t=a,n=r};r(e);var l=function(e,t){for(var n=Math.min(e.length,t.length),a=0;a<n;++a)t[a]=e[a]};return{truncate:function(e){var l=n.length;if(!(l<e)){if(l>Math.round(1.2*e))r(e);else for(var o=e;o<l;++o)t[o]=0;for(a=Math.min(a,e);a>0&&!t[a];)a--}},set:function(e,l){!function(e){var t=n.length,a=Math.round(1.2*t);t<e&&r(Math.max(a,e))}(e+1),n[e]=l,t[e]=1,a=Math.max(a,e)},get:function(e){return t[e]?n[e]:null},has:function(e){return!!t[e]},tail:function(){return t[a]?a:null}}},Je=function(e,t,n,a,r){return void 0===r&&(r=n.textAlign),"left"===r?e+n.marginLeft:"center"===r?e+.5*t-a/2:"right"===r?e+(t-n.marginRight-a):e},Ze=function(e,t,n,a,r,l,o){var i=[];if(null===t)return i;e.fillStyle=n.color,e.font=n.weight+" "+n.fontSize+"px "+n.fontFamily,e.textAlign=n.textAlign;var u=Math.floor(r+.5*o);if(e.save(),e.beginPath(),e.rect(a,r,l,o),e.clip(),""!==n.backgroundColor&&(e.fillStyle=n.backgroundColor,e.fillRect(a,r,l,o),e.fillStyle=n.color),"string"===typeof t||"number"===typeof t){var c=Je(a,l,n,0),s=""+t;e.fillText(s,c,u)}else if("object"===typeof t)for(var d,f=y(t.items);!(d=f()).done;){var v=d.value,h=0,m=0,g=0,p=0;if(v.content instanceof HTMLImageElement)g=v.width||l,p=v.height||o,h=Je(a,l,n,g,v.horizontalAlign)+v.x,m=u+v.y,e.drawImage(v.content,h,m,g,p);else if("string"===typeof v.content||"number"===typeof v.content){v.horizontalAlign&&(e.textAlign=v.horizontalAlign);var b=Je(a,l,n,0,v.horizontalAlign),w=""+v.content,C=b+v.x,x=u+v.y;e.fillText(w,C,x);var E=e.measureText(w);h=C-E.actualBoundingBoxLeft,m=x-E.actualBoundingBoxAscent,g=C+E.actualBoundingBoxRight-h,p=x+E.actualBoundingBoxDescent-m}v.onClick&&i.push({rect:[[h,m],[h+g,m+p]],obj:v})}return e.restore(),i},Xe=function(e,t){var n=t.cellToPixel,a=me(e),r=ge(e),l=we(e),o=l[0],i=l[1],u=n(o),c=u[0],s=u[1],d=n(i,C),f=d[0],v=d[1];return a&&(f=1e5),r&&(v=1e5),[[c,s],[f,v]]},Qe=function(e,t,n,a,r){var l=t.cellToPixel,o=t.columnToAbsolute,i=t.rowToAbsolute,u=me(e),c=ge(e),s=n[0],d=n[1],f=a[0],v=a[1],h=r[0],m=r[1],g=we(e),y=g[0],p=g[1],b=y[0],w=y[1],x=p[0],E=p[1],S=l(y),O=S[0],j=S[1],M=l(p,C),N=M[0],D=M[1],T=o(s),k=i(d),A=!1;if(te(s,b,x+1)){var I=f+T;N<=I&&(N=I,A=!0)}if(te(d,w,E+1)){var H=v+k;D<=H&&(D=H,A=!0)}if(ee(b,s,h+s)){O=-1e5;var L=h+s-1;x<=L&&(N=x===L?f:-1e5,A=!0)}if(ee(w,d,m+d)){j=-1e5;var R=m+d-1;E<=R&&(D=E===R?v:-1e5,A=!0)}return u&&h>0&&(A=!0),c&&m>0&&(A=!0),u&&(N=1e5),c&&(D=1e5),[[[O,j],[N,D]],A]},Ve=function(e){var t=e.getBoundingClientRect(),n=t.width,a=t.height,r=window.devicePixelRatio,l=void 0===r?1:r;l<1&&(l=1);var o=Math.round(n*l),i=Math.round(a*l);if(e.width!==o||e.height!==i){var u=e.getContext("2d");return u&&(e.width=o,e.height=i,u.scale(l,l)),!0}return!1},Ue=function(e){for(var t="",n=0;e>0;)n=(e-1)%26,t=String.fromCharCode(65+n)+t,e=(e-n)/26|0;return t||""},_e=function(e,t,n){for(var a,r=function(e){return("0"+Math.round(e).toString(16)).slice(-2)},l=function(e){return 1-Math.pow(1-e,2.2)},o=0;o<=16;++o){var i=o/16;e.addColorStop(i,t+r(255*l(n*(a=i,1-Math.sin(a*Math.PI/2))*.5)))}},qe=Object(a.forwardRef)((function(e,t){var n,l,o,i,u=Object(a.useRef)(null),c=Object(a.useRef)(null),s=Object(a.useState)(b),d=s[0],f=s[1],v=Object(a.useState)(w),g=v[0],x=v[1],_=null!=(n=e.selection)?n:S,ee=Object(a.useState)(_),te=ee[0],le=ee[1],oe=Object(a.useState)(null),ue=oe[0],ce=oe[1],se=Object(a.useState)(null),de=se[0],Ce=se[1],je=Object(a.useState)([null,null]),Te=je[0],ke=je[1],Ie=Object(a.useState)(null),He=Ie[0],Le=Ie[1],Re=Object(a.useState)(E),ze=Re[0],Pe=Re[1],We=Object(a.useState)(!!e.autoFocus),Be=We[0],Ye=We[1],Ge=Object(a.useState)(_),Ke=Ge[0],Je=Ge[1];Ke!==_&&(Je(_),le(_));var qe=Object(a.useState)(""),$e=qe[0],et=qe[1],tt=Object(a.useState)(!1),nt=tt[0],at=tt[1],rt=Object(h.a)({ref:c}),lt=rt.width,ot=void 0===lt?3e3:lt,it=rt.height,ut=void 0===it?3e3:it,ct=Object(a.useMemo)((function(){return Se(e.cellWidth,100)}),[e.cellWidth]),st=Object(a.useMemo)((function(){return Se(e.cellHeight,22)}),[e.cellHeight]),dt=Object(a.useMemo)((function(){return t=e.columnHeaders,n=null,Array.isArray(t)?function(e){return e>=0&&e<t.length?t[e]:n}:"function"===typeof t?t:null!==t&&void 0!==t?function(){return t}:function(){return n};var t,n}),[e.columnHeaders]),ft=Object(a.useMemo)((function(){return Se(e.columnHeaderStyle,{})}),[e.columnHeaderStyle]),vt=Object(a.useMemo)((function(){return Se(e.canSizeColumn,!0)}),[e.canSizeColumn]),ht=Object(a.useMemo)((function(){return Se(e.canSizeRow,!0)}),[e.canSizeRow]),mt=Object(a.useMemo)((function(){return Se(e.canOrderColumn,!0)}),[e.canOrderColumn]),gt=Object(a.useMemo)((function(){return Se(e.canOrderRow,!0)}),[e.canOrderRow]),yt=Object(a.useMemo)((function(){return Se(e.rowGroupKeys,null)}),[e.rowGroupKeys]),pt=Object(a.useMemo)((function(){return Se(e.columnGroupKeys,null)}),[e.columnGroupKeys]),bt=Object(a.useMemo)((function(){return Oe(e.readOnly,!1)}),[e.readOnly]),wt=Object(a.useMemo)((function(){return Oe(e.sourceData,null)}),[e.sourceData]),Ct=Object(a.useMemo)((function(){return t=e.displayData,n="",Array.isArray(t)?function(e,a){return a>=0&&a<t.length&&e>=0&&e<t[a].length?t[a][e]:n}:"function"===typeof t?t:null!==t&&void 0!==t?function(){return t}:function(){return n};var t,n}),[e.displayData]),xt=Object(a.useMemo)((function(){return Oe(e.editData,"")}),[e.editData]),Et=Object(a.useMemo)((function(){return Oe(e.editKeys,"")}),[e.editKeys]),St=Object(a.useMemo)((function(){return Oe(e.cellStyle,Z)}),[e.cellStyle]),Ot=Object(a.useMemo)((function(){return function(e){var t,n,a;return{freezeColumns:(null===e||void 0===e?void 0:e.freezeColumns)||0,freezeRows:(null===e||void 0===e?void 0:e.freezeRows)||0,hideColumnHeaders:(null===e||void 0===e?void 0:e.hideColumnHeaders)||!1,hideRowHeaders:(null===e||void 0===e?void 0:e.hideRowHeaders)||!1,hideGridlines:(null===e||void 0===e?void 0:e.hideGridlines)||!1,hideScrollBars:(null===e||void 0===e?void 0:e.hideScrollBars)||!1,columnHeaderHeight:null!==e&&void 0!==e&&e.hideColumnHeaders?1:B,rowHeaderWidth:null!==e&&void 0!==e&&e.hideRowHeaders?1:W,shadowBlur:null!=(t=null===e||void 0===e?void 0:e.shadowBlur)?t:K,shadowOpacity:null!=(n=null===e||void 0===e?void 0:e.shadowOpacity)?n:J,shadowColor:null!=(a=null===e||void 0===e?void 0:e.shadowColor)?a:z}}(e.sheetStyle)}),[e.sheetStyle]),jt=null!=(l=e.secondarySelections)?l:O,Mt=Object(a.useMemo)((function(){return be(te)}),[te]),Nt=Object(a.useMemo)((function(){return e.columnGroupKeys?new Set(fe(Mt)((function(e){return pt(e)})).filter((function(e){return null!=e}))):null}),[e.columnGroupKeys,pt,Mt]),Dt=Object(a.useMemo)((function(){return e.rowGroupKeys?new Set(ve(Mt)((function(e){return yt(e)})).filter((function(e){return null!=e}))):null}),[e.rowGroupKeys,yt,Mt]),Tt=d[0],kt=d[1],At=ze[0],It=ze[1],Ht=-1!==At&&-1!==It,Lt=!1!==(null!=(o=e.cacheLayout)&&o),Rt="number"===typeof e.cacheLayout?e.cacheLayout:0,zt=Object(a.useMemo)((function(){return Fe(ct)}),[Lt?Rt:ct]),Pt=Object(a.useMemo)((function(){return Fe(st)}),[Lt?Rt:st]);Object(a.useMemo)((function(){Lt&&(zt.setSizer(ct),Pt.setSizer(st))}),[Lt,Rt,ct,st]);var Wt=Ot.freezeColumns,Bt=Ot.freezeRows,Yt=Ot.rowHeaderWidth,Gt=Ot.columnHeaderHeight,Ft=Object(a.useMemo)((function(){return function(e,t,n,a,r){var l=e[0],o=e[1],i=t[0],u=t[1],c=n[0],s=n[1],d=function(e,t,n){return e<t?0:n+t},f=function(e,t){void 0===t&&(t=0);var n=d(e,l,c),r=a.getStart(e)-a.getStart(n),o=e<l?0:a.getStart(l)-a.getStart(0),u=e<0?i:a.getSize(e);return e<0?0:i+r+o+t*u},v=function(e,t){void 0===t&&(t=0);var n=d(e,o,s),a=r.getStart(e)-r.getStart(n),l=e<o?0:r.getStart(o)-r.getStart(0),i=e<0?u:r.getSize(e);return e<0?0:u+a+l+t*i},h=function(e,t){return void 0===t&&(t=0),a.getStart(e)+t*(e<0?0:a.getSize(e))},m=function(e,t){return void 0===t&&(t=0),r.getStart(e)+t*(e<0?0:r.getSize(e))},g=function(e,t,n,a,r,l){var o=e-n;if(o<0)return-1;var i=l.getStart,u=l.lookupIndex;return u(o<i(a)?o:i(r+a)+o-(i(a)-i(0)),t)},y=function(e,t){return void 0===t&&(t=0),g(e,t,i,l,c,a)},p=function(e,t){return void 0===t&&(t=0),g(e,t,u,o,s,r)},b=function(e,t,n){return e<0?-1:(0,n.lookupIndex)(e,t)},C=function(e,t){return void 0===t&&(t=0),b(e,t,a)},x=function(e,t){return void 0===t&&(t=0),b(e,t,r)},E=function(e,t,n,a,r){for(var l=[].concat(q(n)),o=r.getStart,i=(0,r.getEnd)(n-1),u=o(a+n),c=e-t-i,s=a+n;o(s)-u<=c;++s)l.push(s);return l};return{columnToPixel:f,rowToPixel:v,cellToPixel:function(e,t){void 0===t&&(t=w);var n=e[0],a=e[1],r=t,l=r[0],o=r[1];return[f(n,l),v(a,o)]},columnToAbsolute:h,rowToAbsolute:m,cellToAbsolute:function(e,t){void 0===t&&(t=w);var n=e[0],a=e[1],r=t,l=r[0],o=r[1];return[h(n,l),m(a,o)]},pixelToColumn:y,pixelToRow:p,pixelToCell:function(e,t){void 0===t&&(t=w);var n=e[0],a=e[1],r=t,l=r[0],o=r[1];return[y(n,l),p(a,o)]},absoluteToColumn:C,absoluteToRow:x,absoluteToCell:function(e,t){void 0===t&&(t=w);var n=e[0],a=e[1],r=t,l=r[0],o=r[1];return[C(n,l),x(a,o)]},getVisibleCells:function(e){var t=e[0],n=e[1];return{columns:E(t,i,l,c,a),rows:E(n,u,o,s,r)}},getIndentX:function(){return i},getIndentY:function(){return u},getVersion:function(){return a.getVersion()+r.getVersion()}}}([Wt,Bt],[Yt,Gt],g,zt,Pt)}),[Wt,Bt,Yt,Gt,g,zt,Pt]),Kt=Ft.getVisibleCells,Jt=Ft.cellToPixel,Zt=Ft.getVersion,Xt=Object(a.useMemo)((function(){return Kt([ot,ut])}),[Kt,ot,ut,Zt()]);Object(a.useLayoutEffect)((function(){e.onScrollChange&&e.onScrollChange([].concat(Xt.rows),[].concat(Xt.columns))}),[Xt,e.onScrollChange]);var Qt=function(e,t){void 0===t&&(t=!1);var n=c.current;if(n){var a=e[0],r=e[1];!function(e,t,n,a,r,l,o,i){var u=t[0],c=t[1],s=n[0],d=n[1],f=r[0],v=r[1],h=o.cellToAbsolute,m=o.cellToPixel,g=o.columnToPixel,y=o.rowToPixel,p=h(a),b=p[0],w=p[1],x=m(t),E=x[0],S=x[1],O=m(t,C),j=O[0],M=O[1],N=r[0],D=r[1];if(E<=b&&(N=u-a[0]),S<=w&&(D=c-a[1]),j>s)for(var T=j-s+g(N);g(++N)<T;);if(M>d)for(var k=M-d+y(D);y(++D)<k;);var A=[N>=0?N:f,D>=0?D:v];if(!ie(A,r)){var I=h(A),H=h([0,0],[.5,.5]),L=H[0],R=H[1];i(A,re(l,I)),setTimeout((function(){var t=I[0],n=I[1];e.scrollLeft=t-L,e.scrollTop=n-R}))}}(n,t?r:a,[ot,ut],[Wt,Bt],g,d,Ft,(function(e,t){x(e),f(t)}))}},Vt=function(t,n,a){if(void 0===n&&(n=!0),void 0===a&&(a=!1),function(e,t){var n=e[0],a=e[1],r=t[0],l=t[1];return ie(n,r)&&ie(a,l)}(Mt,t)||le(t),c.current&&(n&&Qt(t,a),e.onSelectionChanged)){var r=we(be(t)),l=r[0],o=l[0],i=l[1],u=r[1],s=u[0],d=u[1];e.onSelectionChanged(o,i,s,d)}},Ut=function(t){if(e.onChange){var n=ze[0],a=ze[1];e.onChange([{x:n,y:a,value:void 0!==t?t:$e}])}Pe(E),Ye(!0)},_t=function(e,t){void 0===t&&(t=!1);var n=e[0],a=e[1];if(!bt(n,a)){var r=xt(n,a),l="";null!==r&&void 0!==r&&(l=r),Pe(e),et(l),at(t),wn(Et.apply(void 0,e))}},qt=e.maxColumns,$t=void 0===qt?1/0:qt,en=e.maxRows,tn=void 0===en?1/0:en;Object(a.useLayoutEffect)((function(){x(function(e,t,n,a,r){var l=t[0],o=t[1],i=a[0],u=a[1],c=r.absoluteToColumn,s=r.columnToAbsolute,d=r.absoluteToRow,f=r.rowToAbsolute,v=De(e,[l,o],n,r),h=v.edge,m=h[0],g=h[1],y=v.viewport,p=y[0],b=y[1];if(m>i){var w=s(i)-s(l);l=c(s(l)-p+w)+1}if(g>u){var C=f(u)-f(o);o=d(f(o)-b+C)+1}return[l,o]}([ot,ut],g,[Wt,Bt],[$t,tn],Ft))}),[tn,$t]);var nn=Object(a.useRef)(j),an=Be||Ht,rn=Ae(Mt,xt,bt,an,Vt,e.onChange,e.onCopy,e.onPaste),ln=rn.clipboardApi,on=rn.onClipboardCopy,un=function(e,t,n,r,l){return Object(a.useCallback)((function(a){if(a.target&&a.target instanceof Element){var o=n.absoluteToCell,i=(0,n.cellToAbsolute)([0,0],[.5,.5]),u=i[0],c=i[1],s=[a.target.scrollLeft+u,a.target.scrollTop+c],d=o(s);ie(d,e)||null===r||void 0===r||r(d);var f,v,h=s[0],m=s[1],g=t[0]<h+1?1.5:1,y=t[1]<m+1?1.5:1;(g>1||y>1)&&(null===l||void 0===l||l((v=[g,y],[(f=t)[0]*v[0],f[1]*v[1]])))}}),[n,r,l])}(g,d,Ft,x,f),cn=function(e,t,n,r,l,o){var i=Object(a.useMemo)((function(){return document.createElement("canvas").getContext("2d")}),[]);return Object(a.useCallback)((function(a){if(!i)return 0;var u=function(e,t){i.font=t.weight+" "+t.fontSize+"px "+t.fontFamily;var n=t.marginLeft+t.marginRight;if("string"===typeof e||"number"===typeof e)return i.measureText(e.toString()).width+n;if("object"===typeof e){for(var a,r=0,l=0,o=y(e.items);!(a=o()).done;){var u=a.value,c=0;if("string"===typeof u.content||"number"===typeof u.content){var s=i.measureText(u.content.toString()).width;c=u.x+s+n}else u.width&&(c=u.width);"right"===u.horizontalAlign?l+="right"===t.textAlign?2*c:c:r=Math.max(r,c)}return r+l}return 0},c=Y,s=m({},X,l(a)),d=r(a,s);d&&(c=Math.max(c,u(d,s)));for(var f,v=y(e);!(f=v()).done;){var h=f.value,g=m({},Z,n(a,h)),p=t(a,h,g);null!=p&&(c=Math.max(c,u(p,g)))}return Math.ceil(Math.min(o,c))}),[i,t,n,r,l])}(Xt.rows,Ct,St,dt,ft,ot),sn=function(e,t,n,r,l,o,i,u,c,s,d,f,v,h,g,p,b,x,E,S,O,j,M,N,D,T,k,A,I,H,L,R,z,W,B,K,J){var Z=Object(a.useState)(null),X=Z[0],Q=Z[1],V=Object(a.useState)(null),U=V[0],_=V[1],ee=Object(a.useState)(null),te=ee[0],le=ee[1],oe=Object(a.useState)(null),ie=oe[0],ue=oe[1],ce=Object(a.useState)(null),se=ce[0],de=ce[1],ye=Object(a.useState)(!1),be=ye[0],Ce=ye[1],Se=Object(a.useState)(!1),Oe=Se[0],je=Se[1],Ne=Object(a.useState)(!1),De=Ne[0],Te=Ne[1],ke=Object(a.useState)(!1),Ae=ke[0],Ie=ke[1],He=h.hideRowHeaders,Le=h.hideColumnHeaders,Re=f.cellToPixel,ze=(0,f.getVersion)(),Pe=Object(a.useMemo)((function(){var e=we(t)[1],n=e[0],a=e[1];return me(t)?ae(ne(Re([0,a],[0,1]),[.5*P,0]),C):ge(t)?ae(ne(Re([n,0],[1,0]),[0,.5*P]),C):function(e){var t=e[0],n=t[0],a=t[1],r=e[1],l=r[0],o=r[1];return-1!==n&&-1!==l&&-1!==a&&-1!==o}(t)?ae(Re([n,a],C),C):null}),[t,Re,ze]),We={selection:t,knobArea:n,editMode:r,editData:l,sourceData:o,cellLayout:f,visibleCells:v,hitTarget:X,knobPosition:Pe,columnResize:U,rowResize:te,columnDrag:ie,rowDrag:se,draggingKnob:be,draggingSelection:Oe,draggingRowSelection:De,draggingColumnSelection:Ae},Be=Object(a.useRef)(We);Be.current=We;var Ye=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return null;var t=e.target.getBoundingClientRect(),n=[e.clientX-t.left,e.clientY-t.top];return n[0]>e.target.clientWidth||n[1]>e.target.clientHeight?null:n}),[]),Ge=Object(a.useCallback)((function(e){if(!e.target||!(e.target instanceof Element))return[0,0];var t=e.target;return[t.scrollLeft,t.scrollTop]}),[]),Fe=Object(a.useCallback)((function(t){var n=e.current;if(!n)return null;for(var a,r=y(n);!(a=r()).done;){var l=a.value,o=l.rect;if(pe(o,t))return l}return null}),[e]),Ke=Object(a.useCallback)((function(){window.document.body.style.cursor="auto"}),[]),Je=Object(a.useCallback)((function(e){var t,n,a=Be.current,l=a.selection,o=a.cellLayout,i=o.columnToPixel,f=o.rowToPixel,v=o.pixelToCell,h=o.getIndentX,m=o.getIndentY,w=a.visibleCells,C=w.columns,E=w.rows,S=a.knobPosition;if(null===k||void 0===k||k(!0),0===e.button){null===(t=e.target)||void 0===t||null===(n=t.setPointerCapture)||void 0===n||n.call(t,e.pointerId);var D=Ye(e);if(D){var A=D[0],I=D[1],H=Fe(D);if(H)return Q(H),void(Be.current.hitTarget=H);var B=we(l),Y=B[0],G=Y[0],J=Y[1],Z=B[1],X=Z[0],V=Z[1],U=fe(l)((function(e){return e})),ee=ve(l)((function(e){return e}));if(!Le&&I<m()){if(L){var te=i(G)+F,ne=i(X,1)-F;if($(A,te,ne)||b)for(var ae,re=y(C);!(ae=re()).done;){var oe=ae.value,ie=i(oe,0),ce=i(oe,1);if(ge(l)&&$(A,ie,ce)&&($(oe,G,X)||null!==b&&void 0!==b&&b.has(g(oe)))&&s(oe)){window.document.body.style.cursor="grabbing";var se=Array.from(new Set([].concat(U,b?C.filter((function(e){return b.has(g(e))})):[])).values());se.sort((function(e,t){return e-t}));var he=se;if(b){var ye=xe([[oe,-1],[oe,-1]],g,b,0),pe=ye[0][0],be=ye[1][0],Ee=!(G>be||X<pe),Se=Ee?Math.min(G,pe):pe,Oe=Ee?Math.max(X,be):be;he=q(Oe-Se+1,Se)}var Me=i(X,1)-i(G),Ne=Ge(e)[0];return ue({anchor:A,scroll:Ne,size:Me,indices:se}),null===N||void 0===N||N([0,0]),void(null===M||void 0===M||M([he,null]))}}}if(z)for(var De,ke=y(C);!(De=ke()).done;){var Ae=De.value,Re=i(Ae,1);if(Math.abs(Re-A)<F&&u(Ae)){window.document.body.style.cursor="col-resize";var ze=ge(l)&&X===Ae,Pe=ze?U:[Ae],We=ze?i(X,1)-i(G):i(Ae,1)-i(Ae),Ke=Ge(e)[0];return void _({anchor:A,scroll:Ke,size:We,indices:Pe})}}}if(!He&&A<h()){if(R){var Je=f(J)+F,Ze=f(V,1)-F;if($(I,Je,Ze)||x)for(var Xe,Qe=y(E);!(Xe=Qe()).done;){var Ve=Xe.value,Ue=f(Ve,0),_e=f(Ve,1);if(me(l)&&$(I,Ue,_e)&&($(Ve,J,V)||null!==x&&void 0!==x&&x.has(p(Ve)))&&d(Ve)){window.document.body.style.cursor="grabbing";var qe=Array.from(new Set([].concat(ee,x?E.map((function(e,t){return t})).filter((function(e){return x.has(p(e))})):[])).values());qe.sort((function(e,t){return e-t}));var $e=qe;if(x){var et=xe([[-1,Ve],[-1,Ve]],p,x,1),tt=et[0][1],nt=et[1][1],at=!(J>nt||V<tt),rt=at?Math.min(J,tt):tt,lt=at?Math.max(V,nt):nt;$e=q(lt-rt+1,rt)}var ot=f(V,1)-f(J),it=Ge(e)[1];return de({anchor:I,scroll:it,size:ot,indices:qe}),null===N||void 0===N||N([0,0]),void(null===M||void 0===M||M([null,$e]))}}}if(W)for(var ut,ct=y(E);!(ut=ct()).done;){var st=ut.value,dt=f(st,1);if(Math.abs(dt-I)<F&&c(st)){window.document.body.style.cursor="row-resize";var ft=me(l)&&V===st,vt=ft?ee:[st],ht=ft?f(V,1)-f(J):f(st,1)-f(st),mt=Ge(e)[1];return void le({anchor:I,scroll:mt,size:ht,indices:vt})}}}if(S){var gt=S[0],yt=S[1];if(Math.abs(A-gt)<P&&Math.abs(I-yt)<P)return Ce(!0),void(null===j||void 0===j||j(l))}var pt=v(D),bt=e.shiftKey?[].concat(l[0]):pt;r&&(K||null===O||void 0===O||O());var wt=!0;!He&&A<h()&&(wt=!1,Te(!0),bt[0]=-1,pt[0]=-1),!Le&&I<m()&&(wt=!1,Ie(!0),bt[1]=-1,pt[1]=-1),je(!0),null===T||void 0===T||T([bt,pt],wt,!0)}}}),[Ye,Ge,Fe,L,R,z,W,j,T,O,u,c,s,d,K,g,p,b,x]),Ze=Object(a.useCallback)((function(e){var t,n=Be.current,a=n.knobArea,r=n.selection,l=n.sourceData,o=n.editData,u=n.columnDrag,c=n.rowDrag,s=n.draggingKnob,d=n.hitTarget,f=n.cellLayout,v=f.pixelToColumn,h=f.pixelToRow,m=f.getIndentX,y=f.getIndentY;if(null===k||void 0===k||k(!0),a&&s){var w=Me(a,r,l,o,i);null===H||void 0===H||H(w),null===T||void 0===T||T(a,!0,!0),null===j||void 0===j||j(null)}var C=Ye(e);if(C&&(u||c)){window.document.body.style.cursor="auto",null===M||void 0===M||M([null,null]),null===N||void 0===N||N(null),null===D||void 0===D||D(null);var E=C[0],S=C[1],O=we(r),z=O[0],P=z[0],W=z[1],B=O[1],Y=B[0],G=B[1],F=v(Math.max(E,m()),.5),K=h(Math.max(S,y()),.5);if(u){var Z=u.indices,X=F>=P&&F<=Y+1,V=null===b||void 0===b?void 0:b.has(g(E));if(!X&&!V){var U=Z.filter((function(e){return e<F})),q=F-U.length;J||null===T||void 0===T||T([[q,W],[q+Z.length-1,G]]),null===L||void 0===L||L(Z,q),null===A||void 0===A||A(Math.min(P,q))}}if(c){var $=c.indices,ee=K>=W&&K<=G+1,te=null===x||void 0===x?void 0:x.has(p(S));if(!ee&&!te){var ne=$.filter((function(e){return e<K})),ae=K-ne.length;J||null===T||void 0===T||T([[P,ae],[Y,ae+$.length-1]]),null===R||void 0===R||R($,ae),null===I||void 0===I||I(Math.min(W,ae))}}}if((je(!1),Te(!1),Ie(!1),Ce(!1),_(null),ue(null),le(null),de(null),C&&d)&&(Q(null),JSON.stringify(d.rect)===JSON.stringify(null===(t=Fe(C))||void 0===t?void 0:t.rect))){var re,oe=d.obj;null===(re=oe.onClick)||void 0===re||re.call(oe,e)}}),[Ye,Fe,H,T,j,D,L,R,J]),Xe=Object(a.useCallback)((function(e){var t=Be.current,n=t.selection,a=t.visibleCells,r=t.knobPosition,l=t.columnResize,o=t.columnDrag,i=t.rowResize,f=t.rowDrag,v=t.draggingKnob,h=t.draggingSelection,m=t.draggingColumnSelection,C=t.draggingRowSelection,E=t.cellLayout,S=E.columnToPixel,O=E.rowToPixel,M=E.pixelToCell,k=E.pixelToColumn,H=E.pixelToRow,B=E.getIndentX,K=E.getIndentY;window.document.body.style.cursor="auto";var J=Ye(e);if(J){Fe(J)?window.document.body.style.cursor="pointer":o||f?window.document.body.style.cursor="grabbing":l?(window.document.body.style.cursor="col-resize",e.preventDefault()):i?(window.document.body.style.cursor="row-resize",e.preventDefault()):(C||m)&&e.preventDefault();var Z=a.columns,X=a.rows,Q=J[0],V=J[1],U=we(n),_=U[0],q=_[0],ee=_[1],te=U[1],ne=te[0],ae=te[1];if(!(l||o||i||f||C||m)){if(!Le&&V<K()){if(L){var le=S(q)+F,oe=S(ne,1)-F;if($(Q,le,oe)||b)for(var ie,ue=y(Z);!(ie=ue()).done;){var ce=ie.value,se=S(ce),de=S(ce,1);if(!m&&ge(n)&&$(Q,se,de)&&($(ce,q,ne)||null!==b&&void 0!==b&&b.has(g(ce)))&&s(ce))return void(window.document.body.style.cursor="grab")}}if(z)for(var fe,ve=y(Z);!(fe=ve()).done;){var ye=fe.value,pe=S(ye,1);if(Math.abs(pe-Q)<F&&u(ye))return void(window.document.body.style.cursor="col-resize")}}if(!He&&Q<B()){if(R){var be=O(ee)+F,Ce=O(ae,1)-F;if($(V,be,Ce)||x)for(var xe,Se=y(X);!(xe=Se()).done;){var Oe=xe.value,je=O(Oe),Me=O(Oe,1);if(!C&&me(n)&&$(V,je,Me)&&($(Oe,ee,ae)||null!==x&&void 0!==x&&x.has(p(Oe)))&&d(Oe))return void(window.document.body.style.cursor="grab")}}if(W)for(var Ne,De=y(X);!(Ne=De()).done;){var Te=Ne.value,ke=O(Te,1);if(Math.abs(ke-V)<F&&c(Te))return void(window.document.body.style.cursor="row-resize")}}if(r){var Ae=r[0],Ie=r[1];if(Math.abs(Q-Ae)<P&&Math.abs(V-Ie)<P)return void(window.document.body.style.cursor="crosshair")}}if(l){if(z){var Re=l.size,ze=l.anchor,Pe=l.scroll,We=l.indices,Ke=Ge(e)[0],Je=Math.max(Re+Q-ze+Pe-Ke,Y*We.length);null===A||void 0===A||A(We[0]-1),z(We,We.map((function(e){return Je/We.length})))}}else if(i){if(W){var Ze=i.size,Xe=i.anchor,Qe=i.scroll,Ve=i.indices,Ue=Ge(e)[1],_e=Math.max(Ze+V-Xe+Qe-Ue,G*Ve.length);null===I||void 0===I||I(Ve[0]-1),W(Ve,Ve.map((function(e){return _e/Ve.length})))}}else{if(h){var qe=n[0],$e=M(J),et=qe[0],tt=qe[1],nt=$e[0],at=$e[1];C?null===T||void 0===T||T([[-1,tt],[-1,Math.max(0,at)]],!1):m?null===T||void 0===T||T([[et,-1],[Math.max(0,nt),-1]],!1):null===T||void 0===T||T([re(qe,w),re($e,w)],!1)}if(v){window.document.body.style.cursor="crosshair";var rt=M(J),lt=rt[0],ot=rt[1],it=we(n),ut=it[0],ct=ut[0],st=ut[1],dt=it[1],ft=dt[0],vt=dt[1],ht=Math.min(lt-ct,ft-lt,0),mt=Math.min(ot-st,vt-ot,0);he(n)||ht>mt?ot<st?st=ot:ot>vt&&(vt=ot):lt<ct?ct=lt:lt>ft&&(ft=lt),null===j||void 0===j||j([[ct,st],[ft,vt]])}if(o||f){var gt=J[0],yt=J[1];if(o){var pt=k(Math.max(gt,B()),.5),bt=pt>=q&&pt<=ne+1,wt=Ee(pt,g),Ct=o.anchor,xt=o.scroll,Et=gt-Ct,St=Ge(e)[0];null===N||void 0===N||N([Et+St-xt,0]),null===D||void 0===D||D(bt||wt?null:[[pt,-1],[pt,-1]])}if(f){var Ot=H(Math.max(yt,K()),.5),jt=Ot>=ee&&Ot<=ae+1,Mt=Ee(Ot,p),Nt=f.anchor,Dt=f.scroll,Tt=yt-Nt,kt=Ge(e)[1];null===N||void 0===N||N([0,Tt+kt-Dt]),null===D||void 0===D||D(jt||Mt?null:[[-1,Ot],[-1,Ot]])}}}}}),[Ye,Ge,Fe,z,W,M,N,D,T,j,I,A,g,p]),Qe=Object(a.useCallback)((function(e){var t=Be.current,n=t.selection,a=t.cellLayout,l=a.pixelToCell,o=a.columnToPixel;if(e.preventDefault(),!e.shiftKey){var i=Ye(e);if(i){var c=i[0],s=v.columns;if(z){for(var d,f=[],h=y(s);!(d=h()).done;){var m=d.value,g=o(m,1);if(Math.abs(g-c)<F&&u(m)){var p=we(n),b=p[0][0],w=p[1][0],C=ge(n)&&m>=b&&m<=w?fe(n)((function(e){return e})):[m];f.push.apply(f,C)}}for(var x=0,j=f;x<j.length;x++){var M=j[x];null===A||void 0===A||A(M-1)}if(z(f,f.map((function(e){return E(e)}))),f.length)return}if(Fe(i))window.document.body.style.cursor="pointer";else{var N=l(i);r&&(null===O||void 0===O||O()),null===S||void 0===S||S(N)}}}}),[Ye,Fe,O,S,A,z,E,v,u]),Ve=Object(a.useCallback)((function(e){var n=Be.current.cellLayout,a=n.pixelToCell,r=n.getIndentX,l=n.getIndentY,o=Ye(e);if(o){var i=o[0],u=o[1];if(!(i<=r()||u<=l())){var c=a(o);pe(t,c)||null===T||void 0===T||T([c,c]),Xe(e);var s=m({},e,{cellX:c[0],cellY:c[1]});null===B||void 0===B||B(s)}}}),[Ye,T,Xe,B]);return{knobPosition:Pe,mouseHandlers:{onPointerLeave:Ke,onPointerDown:Je,onPointerMove:Xe,onPointerUp:Ze,onDoubleClick:Qe,onContextMenu:Ve}}}(nn,Mt,ue,Ht,xt,wt,bt,vt,ht,mt,gt,Ft,Xt,Ot,pt,yt,Nt,Dt,cn,_t,Ut,ce,ke,Ce,Le,Vt,Ye,e.cacheLayout?zt.clearAfter:void 0,e.cacheLayout?Pt.clearAfter:void 0,e.onChange,e.onColumnOrderChange,e.onRowOrderChange,e.onCellWidthChange,e.onCellHeightChange,e.onRightClick,e.dontCommitEditOnSelectionChange,e.dontChangeSelectionOnOrderChange),dn=sn.mouseHandlers,fn=sn.knobPosition,vn=Ne(nt,c,bt,Ct,ze,Ht,Be,te,Mt,_t,Ut,(function(){Pe(E),Ye(!0)}),Vt,Ye,on,e.onChange),hn=vn.onInputKeyDown,mn=vn.onGridKeyDown,gn=vn.onGridFocus,yn=vn.onGridBlur;Object(a.useLayoutEffect)((function(){var e=u.current;if(e){var t=e.getContext("2d");if(t){var n=window.requestAnimationFrame((function(){nn.current=function(e,t,n,a,r,l,o,i,u,c,s,d,f,v,h,g,p,b,w,C,x){var E=e.canvas,S=E.width,O=E.height,j=a.hideGridlines,z=a.hideRowHeaders,W=a.hideColumnHeaders,B=a.rowHeaderWidth,Y=a.columnHeaderHeight,G=a.freezeColumns,F=a.freezeRows,K=a.shadowBlur,J=a.shadowColor,_=a.shadowOpacity,q=n.columns,ee=n.rows,te=t.columnToPixel,ne=t.rowToPixel,ae=t.columnToAbsolute,re=t.rowToAbsolute,le=[],oe=[G,F],ie=[B,Y];Ve(E),e.clearRect(0,0,S,O),e.fillStyle="white",e.fillRect(0,0,S,O),e.shadowColor="#00000080";for(var ue,ce=y(ee);!(ue=ce()).done;)for(var se,de=ue.value,fe=y(q);!(se=fe()).done;){var ve=se.value,he=te(ve),pe=te(ve,1),be=ne(de),Ce=ne(de,1),xe=r(ve,de).fillColor;xe&&(e.fillStyle=xe,e.fillRect(he,be,pe-he,Ce-be))}var Ee=!ye(l),Se=me(l),Oe=ge(l),je=Qe(l,t,oe,ie,x),Me=je[0],Ne=je[1];if(Ee){var De=Me[0],Te=De[0],ke=De[1],Ae=Me[1],Ie=Ae[0],He=Ae[1];e.fillStyle=D,e.fillRect(Te,ke,Ie-Te,He-ke)}if(!z&&(e.fillStyle=H,e.fillRect(0,0,B,e.canvas.height),Ee&&!Oe)){var Le=Me[0][1],Re=Me[1][1];e.fillStyle=R,e.fillRect(0,Le,B,Re-Le)}if(!W&&(e.fillStyle=H,e.fillRect(0,0,e.canvas.width,Y),Ee&&!Se)){var ze=Me[0][0],Pe=Me[1][0];e.fillStyle=R,e.fillRect(ze,0,Pe-ze,Y)}e.strokeStyle=T,e.lineWidth=1;var We=j?B:e.canvas.width,Be=j?Y:e.canvas.height,Ye=function(t,n){e.beginPath(),e.moveTo(t-.5,0),e.lineTo(t-.5,n),e.stroke()},Ge=function(t,n){e.beginPath(),e.moveTo(0,t-.5),e.lineTo(n,t-.5),e.stroke()};Ye(B,e.canvas.height),Ge(Y,e.canvas.width);for(var Fe,Ke=y(q);!(Fe=Ke()).done;){Ye(te(Fe.value,1),Be)}for(var Je,qe=y(ee);!(Je=qe()).done;){Ge(ne(Je.value,1),We)}var $e=we(l),et=$e[0],tt=et[0],nt=et[1],at=$e[1],rt=at[0],lt=at[1];if(!z){e.textBaseline="middle",e.textAlign="center",e.font=Z.fontSize+"px "+Z.fontFamily,e.fillStyle=L;for(var ot,it=y(ee);!(ot=it()).done;){var ut=ot.value,ct=""+(ut+1),st=$(ut,nt,lt),dt=b(ut),ft=null!=dt&&(null===C||void 0===C?void 0:C.has(dt)),vt=m({},X,Se&&st?V:Se&&ft?U:st?Q:M),ht=ne(ut),mt=ne(ut,1);le.push.apply(le,Ze(e,ct,vt,0,ht,B,mt-ht))}}if(!W){e.textBaseline="middle",e.textAlign="center";for(var gt,yt=y(q);!(gt=yt()).done;){var pt,bt=gt.value,wt=$(bt,tt,rt),Ct=p(bt),xt=null!=Ct&&(null===w||void 0===w?void 0:w.has(Ct)),Et=Oe&&!Se&&(wt||xt)?V:M,St=wt?Q:M,Ot=m({},X,h(bt),St,Et),jt=te(bt),Mt=te(bt,1),Nt=null!=(pt=v(bt,Ot))?pt:Ue(bt+1);le.push.apply(le,Ze(e,Nt,Ot,jt,0,Mt-jt,Y))}}if(Ee){e.strokeStyle=N,e.lineWidth=2,e.globalAlpha=i?1:.5;var Dt=Me[0],Tt=Dt[0],kt=Dt[1],At=Me[1],It=At[0],Ht=At[1];e.strokeRect(Tt,kt,It-Tt-1,Ht-kt-1),e.globalAlpha=1}for(var Lt,Rt=y(o);!(Lt=Rt()).done;){var zt=Lt.value,Pt=zt.span;if(!ye(Pt)){var Wt=Qe(Pt,t,oe,ie,x)[0],Bt=Wt[0],Yt=Bt[0],Gt=Bt[1],Ft=Wt[1],Kt=Ft[0],Jt=Ft[1];e.strokeStyle=zt.color,e.lineWidth=1,e.beginPath(),e.strokeRect(Yt-1,Gt-1,Kt-Yt+1,Jt-Gt+1)}}if(c){var Zt=we(c),Xt=Zt[0],Qt=Xt[0],Vt=Xt[1],Ut=Zt[1],_t=Ut[0],qt=Ut[1],$t=te(Qt),en=ne(Vt),tn=te(_t,1),nn=ne(qt,1);e.strokeStyle=I,e.setLineDash([3,3]),e.lineWidth=1,e.strokeRect($t-1,en-1,tn-$t+1,nn-en+1),e.setLineDash([])}if(u&&!Ne){var an=u[0],rn=u[1];e.fillStyle=N,e.fillRect(an-.5*P,rn-.5*P,P,P)}if(d){var ln=d[0],on=d[1],un=s[0],cn=s[1];if(e.fillStyle=k,un)for(var sn,dn=y(un);!(sn=dn()).done;){var fn=sn.value,vn=te(fn),hn=te(fn,1);e.fillRect(vn+ln,0,hn-vn,O)}if(cn)for(var mn,gn=y(cn);!(mn=gn()).done;){var yn=mn.value,pn=ne(yn),bn=ne(yn,1);e.fillRect(0,pn+on,S,bn-pn)}}if(f){var wn=Xe(f,t),Cn=wn[0],xn=Cn[0],En=Cn[1],Sn=wn[1],On=Sn[0],jn=Sn[1];e.strokeStyle=A,e.lineWidth=4,ge(f)&&(On=xn),me(f)&&(jn=En),e.strokeRect(xn-1,En-1,On-xn,jn-En)}var Mn=x[0],Nn=x[1],Dn=F>0&&Nn>0,Tn=G>0&&Mn>0;if(Dn||Tn){if(Dn){var kn=Y+re(F),An=e.createLinearGradient(0,kn,0,kn+K);_e(An,J,_),e.fillStyle=An,e.fillRect(0,kn,S,K)}if(Tn){var In=B+ae(G),Hn=e.createLinearGradient(In,0,In+K,0);_e(Hn,J,_),e.fillStyle=Hn,e.fillRect(In,0,K,O)}}e.textBaseline="middle";for(var Ln,Rn=y(ee);!(Ln=Rn()).done;)for(var zn,Pn=Ln.value,Wn=y(q);!(zn=Wn()).done;){var Bn=zn.value,Yn=te(Bn),Gn=te(Bn,1),Fn=ne(Pn),Kn=ne(Pn,1),Jn=m({},Z,r(Bn,Pn)),Zn=g(Bn,Pn,Jn);null!==Zn&&void 0!==Zn&&le.push.apply(le,Ze(e,Zn,Jn,Yn,Fn,Gn-Yn,Kn-Fn))}return le}(t,Ft,Xt,Ot,St,Mt,jt,an,fn,ue,Te,de,He,dt,ft,Ct,pt,yt,Nt,Dt,g)}));return function(){window.cancelAnimationFrame(n)}}}}),[Ft,Xt,Ot,St,Mt,jt,an,fn,ue,de,He,dt,ft,Ct,pt,yt,Nt,Dt,g]);var pn=Object(a.useState)(""),bn=pn[0],wn=pn[1],Cn=w,xn=0,En=0,Sn="right";if(Ht){var On=St.apply(void 0,ze);Cn=Jt(ze),Cn=ne(Cn,C),xn=ct(At)-3,En=st(It)-3,Sn=On.textAlign||Z.textAlign||"left",Et.apply(void 0,ze)!==bn&&(wn(""),Pe(E))}var jn=Cn,Mn=jn[0],Nn=jn[1],Dn={value:$e,autoFocus:!0,onKeyDown:hn,style:{position:"absolute",left:Mn,top:Nn,padding:"0px 4px",width:xn,height:En,outline:"none",border:"none",textAlign:Sn,color:"black",fontSize:Z.fontSize,fontFamily:"sans-serif"}},Tn=null===(i=e.inputComponent)||void 0===i?void 0:i.call(e,At,It,m({},Dn,{onChange:et}),Ut),kn=p,An={position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"scroll",outline:0,borderBottom:"1px solid #ddd"},In={width:ot,height:ut,outline:"1px solid #ddd"};Ot.hideScrollBars&&(delete In.outline,delete An.borderBottom,kn="");var Hn=Object(a.useMemo)((function(){var t;return null===(t=e.renderInside)||void 0===t?void 0:t.call(e,{visibleCells:Xt,cellLayout:Ft,selection:Mt,editMode:Ht})}),[e.renderInside,Xt,Ft,Mt,Ht]),Ln=Object(a.useMemo)((function(){var t;return null===(t=e.renderOutside)||void 0===t?void 0:t.call(e,{visibleCells:Xt,cellLayout:Ft,selection:Mt,editMode:Ht})}),[e.renderOutside,Xt,Ft,Mt,Ht]);return Object(a.useImperativeHandle)(t,(function(){return m({},Ft,ln,{startEditingCell:_t})}),[Ft,ln,_t]),r.a.createElement("div",{style:{position:"relative",height:"100%",overflow:"hidden"}},r.a.createElement("canvas",{style:In,ref:u}),r.a.createElement("div",Object.assign({ref:c},dn,{onKeyDown:mn,onFocus:gn,onBlur:yn,tabIndex:0,onScroll:un,className:kn,style:An}),r.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:1,height:kt+2e3,backgroundColor:"rgba(0,0,0,0.0)"}}),r.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:Tt+5e3,height:1,backgroundColor:"rgba(0,0,0,0.0)"}}),Hn?r.a.createElement("div",{style:{position:"sticky",left:0,top:0}},Hn):null),Ln?r.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}},Ln):null,Ht&&(void 0!==Tn?Tn:r.a.createElement("input",Object.assign({},Dn,{type:"text",onFocus:function(e){return e.target.select()},onChange:function(e){return et(e.target.value)}}))))})),$e=(n(27),[]),et=0;et<1e3;et++){for(var tt=[],nt=0;nt<100;nt++)tt.push("Row: ".concat(et,", Col: ").concat(nt));$e.push(tt)}for(var at=[["First","Second","Third","Fourth","Fifth","Sixth"],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6],[1,2,3,4,5,6]],rt=[],lt=0;lt<1e3;lt++){for(var ot=[],it=0;it<100;it++)ot.push(1e6*Math.random());rt.push(ot)}var ut=new Image;ut.src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiDQoJIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgPg0KPHBvbHlnb24gcG9pbnRzPSIwLDAgMTAwLDAgNTAsMTAwIiBzdHlsZT0iZmlsbDojOTk5OTk5OyIvPg0KPC9zdmc+DQo=",ut.width=10,ut.height=10;function ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},l=Object(a.useState)(e),o=Object(s.a)(l,2),i=o[0],u=o[1],c=Object(a.useState)(t),d=Object(s.a)(c,2),h=d[0],m=d[1],g=function(e,t){u((function(a){var r,l=Object(v.a)(a),o=Object(f.a)(e.entries());try{for(o.s();!(r=o.n()).done;){var i=Object(s.a)(r.value,2),u=i[0],c=i[1],d=n(c);if(d>l.length)for(var h=l.length;h<=d;h++)l.push(100);l[d]=t[u]}}catch(m){o.e(m)}finally{o.f()}return l}))},y=function(e,t){m((function(n){var a,l=Object(v.a)(n),o=Object(f.a)(e.entries());try{for(o.s();!(a=o.n()).done;){var i=Object(s.a)(a.value,2),u=i[0],c=i[1],d=r(c);if(d>l.length)for(var h=l.length;h<=d;h++)l.push(22);l[d]=t[u]}}catch(m){o.e(m)}finally{o.f()}return l}))},p=function(e){var t;return null!==(t=i[n(e)])&&void 0!==t?t:100},b=function(e){var t;return null!==(t=h[r(e)])&&void 0!==t?t:22};return{onCellWidthChange:g,onCellHeightChange:y,cellWidth:p,cellHeight:b}}function st(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(a.useState)(e),r=Object(s.a)(n,2),l=r[0],o=r[1],i=Object(a.useState)(t),u=Object(s.a)(i,2),c=u[0],d=u[1],f=function(e){var t;return null!==(t=l[e])&&void 0!==t?t:e},h=function(e){var t;return null!==(t=c[e])&&void 0!==t?t:e},m=function(e,t){for(var n=Object(v.a)(l),a=Math.max(t+e.length,t+e.reduce((function(e,t){return Math.max(e,t)}),0));n.length<a;)n.push(n.length);for(var r=0;r<e.length;++r)n.splice(e[r]-r,1);n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){var t;return null!==(t=l[e])&&void 0!==t?t:e}))))),o(n)},g=function(e,t){for(var n=Object(v.a)(c),a=Math.max(t+e.length,t+e.reduce((function(e,t){return Math.max(e,t)}),0));n.length<a;)n.push(n.length);for(var r=0;r<e.length;++r)n.splice(e[r]-r,1);n.splice.apply(n,[t,0].concat(Object(v.a)(e.map((function(e){var t;return null!==(t=c[e])&&void 0!==t?t:e}))))),d(n)};return{getColumnOrder:f,getRowOrder:h,onColumnOrderChange:m,onRowOrderChange:g}}function dt(){var e=Object(a.useState)($e),t=Object(s.a)(e,2),n=t[0],l=t[1],o=st(),i=o.onColumnOrderChange,u=o.onRowOrderChange,c=o.getColumnOrder,d=o.getRowOrder,h=ct([],[],c,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,i=c(o.x),u=d(o.y);a[u]||(a[u]=[]),a[u][i]=o.value}}catch(s){r.e(s)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:u,editKeys:function(e,t){return"".concat(e,",").concat(t)},autoFocus:!0,cacheLayout:!0}))}function ft(){var e=Object(a.useState)(JSON.parse(JSON.stringify(at))),t=Object(s.a)(e,2),n=t[0],l=t[1],o=st(),i=o.onColumnOrderChange,u=o.onRowOrderChange,c=o.getColumnOrder,d=o.getRowOrder,h=ct([],[],c,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight;return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,i=c(o.x),u=d(o.y);a[u]||(a[u]=[]),a[u][i]=o.value}}catch(s){r.e(s)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:u,cacheLayout:!0}))}var vt=new Image;function ht(){var e=Object(a.useState)(JSON.parse(JSON.stringify(at))),t=Object(s.a)(e,2),n=t[0],l=t[1],o=ct(),i=o.onCellWidthChange,u=o.onCellHeightChange,c=o.cellWidth,d=o.cellHeight,h=["#f00","#0f0","#00f","#000"],m=["left","right","center"],g=["normal","bold","lighter"],y=[0,0,0,0,20];return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:function(e){return 0===e?{items:[{content:"A",x:0,y:0,horizontalAlign:"center"},{content:ut,x:0,y:-6,width:12,height:12,horizontalAlign:"right",onClick:function(){console.log("click")}}]}:null},cellStyle:function(e,t){return 0===e||0===t?{fillColor:"#6DA2FB22",marginRight:10}:{color:h[t%4],textAlign:m[e%3],marginRight:y[e%5],weight:g[t%3]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,r;return 0===e&&t>0&&t<9?{items:[{content:vt,x:0,y:-8,width:16,height:16,horizontalAlign:"right",onClick:function(){!function(e,t){var a=Object(v.a)(n);a[t]&&void 0!==a[t][e]&&(a[t][e]+=1),l(a)}(e,t)}},{content:null===n||void 0===n||null===(r=n[t])||void 0===r?void 0:r[e],x:0,y:0,horizontalAlign:"left"}]}:null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){r.e(i)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:u,sheetStyle:{freezeColumns:1,freezeRows:1},cacheLayout:!0}))}function mt(){var e=Object(a.useState)(rt),t=Object(s.a)(e,2),n=t[0],l=t[1],o=ct(),i=o.onCellWidthChange,u=o.onCellHeightChange,c=o.cellWidth,d=o.cellHeight;return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a,r,l;return null===n||void 0===n||null===(a=n[t])||void 0===a||null===(r=a[e])||void 0===r||null===(l=r.toFixed)||void 0===l?void 0:l.call(r,2)},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=Number(o.value)}}catch(i){r.e(i)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:u,cacheLayout:!0}))}function gt(){var e=Object(a.useState)(JSON.parse(JSON.stringify(at))),t=Object(s.a)(e,2),n=t[0],l=t[1],o=ct(),i=o.onCellWidthChange,u=o.onCellHeightChange,c=o.cellWidth,d=o.cellHeight;return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{selection:[[1,2],[1,2]],onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,i=o.x,u=o.y,c=o.value;a[u]||(a[u]=[]),a[u][i]=c}}catch(s){r.e(s)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:u,renderInside:function(e){var t=e.visibleCells,n=e.cellLayout,a=e.selection;if(!e.editMode){var l=[1,2],o=Object(s.a)(a,1)[0],i=o[0]===l[0]&&o[1]===l[1];if(!(t.columns.includes(l[0])&&t.rows.includes(l[1])))return null;var u=n.cellToPixel(l,[0,0]),c=Object(s.a)(u,2)[1],d=n.cellToPixel(l,[1,1]),f=Object(s.a)(d,1)[0],v=r.a.createElement("div",{style:{position:"absolute",left:f,top:c,marginLeft:"-12px",borderTop:"12px solid blue",borderLeft:"12px solid transparent",pointerEvents:"none"}}),h=i?r.a.createElement("div",{style:{position:"absolute",left:f,top:c,padding:10,background:"#fff",border:"1px solid #ccc"}},"Hello world"):null;return r.a.createElement("div",{onPointerDown:function(e){return e.stopPropagation()}},h,v)}},cacheLayout:!0}))}function yt(){var e=Object(a.useState)($e),t=Object(s.a)(e,2),n=t[0],l=t[1],o=st(),i=o.onColumnOrderChange,u=o.onRowOrderChange,c=o.getColumnOrder,d=o.getRowOrder,h=ct([],[],c,d),m=h.onCellWidthChange,g=h.onCellHeightChange,y=h.cellWidth,p=h.cellHeight,b=[1,1,1,2,2,2,3,3,4,4,5,6,6,7,8,8],w=b.map((function(e,t){return b[d(t)]})),C=w.map((function(e,t){return e!==w[t-1]})).reduce((function(e,t){var n,a=null!==(n=e.at(-1))&&void 0!==n?n:1,r=t?1-a:a;return e.push(r),e}),[]);return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{fillColor:["#ffffff","#e0e0e0"][C[t]]}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[d(t)])||void 0===a?void 0:a[c(e)]},cellWidth:y,cellHeight:p,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,i=c(o.x),u=d(o.y);a[u]||(a[u]=[]),a[u][i]=o.value}}catch(s){r.e(s)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:m,onCellHeightChange:g,onColumnOrderChange:i,onRowOrderChange:u,rowGroupKeys:function(e){return w[e]},editKeys:function(e,t){return"".concat(e,",").concat(t)},cacheLayout:!0}))}function pt(){var e=Object(a.useState)("initial"),t=Object(s.a)(e,2),n=t[0],l=t[1],o=Object(a.useState)([]),i=Object(s.a)(o,2),u=i[0],c=i[1],d=ct(),h=d.onCellWidthChange,m=d.onCellHeightChange,g=d.cellWidth,y=d.cellHeight;return r.a.createElement(r.a.Fragment,null,"initial"===n?r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),l("loading"),fetch("./out.json").then((function(e){return e.json()})).then((function(e){c(e),l("done")}))}},"Load global database of power plants"):"loading"===n?"Loading...":null,r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{cellStyle:function(e,t){return 0===t?{weight:"bold",fontSize:14}:4===e?{textAlign:"right"}:1===e?{weight:"bold",color:"#3b85ff"}:2===e?{color:"#fc3bff"}:{}},editData:function(e,t){var n;return null===u||void 0===u||null===(n=u[t])||void 0===n?void 0:n[e]},displayData:function(e,t){var n;return 4===e&&t>0?u&&u[t]&&u[t][e]?Number(u[t][e]).toFixed(2):"":null===u||void 0===u||null===(n=u[t])||void 0===n?void 0:n[e]},sourceData:function(e,t){var n;return null===u||void 0===u||null===(n=u[t])||void 0===n?void 0:n[e]},cellWidth:g,cellHeight:y,onChange:function(e){var t,n=Object(v.a)(u),a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n[r.y]||(n[r.y]=[]),n[r.y][r.x]=r.value}}catch(l){a.e(l)}finally{a.f()}c(n)},readOnly:function(e,t){return!1},onCellWidthChange:h,onCellHeightChange:m,columnHeaderStyle:function(e){var t=(2421*e%255).toString(16).padStart(2,"0"),n=(3215*e%255).toString(16).padStart(2,"0"),a=(1243*e%255).toString(16).padStart(2,"0");return{backgroundColor:"#".concat(t).concat(n).concat(a,"55")}},columnHeaders:function(e){return""+e},sheetStyle:{freezeColumns:0,freezeRows:1},cacheLayout:!0})))}vt.src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGVjay1jaXJjbGUiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1jaGVjay1jaXJjbGUgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjMGFkNjZiIiBkPSJNNTA0IDI1NmMwIDEzNi45NjctMTExLjAzMyAyNDgtMjQ4IDI0OFM4IDM5Mi45NjcgOCAyNTYgMTE5LjAzMyA4IDI1NiA4czI0OCAxMTEuMDMzIDI0OCAyNDh6TTIyNy4zMTQgMzg3LjMxNGwxODQtMTg0YzYuMjQ4LTYuMjQ4IDYuMjQ4LTE2LjM3OSAwLTIyLjYyN2wtMjIuNjI3LTIyLjYyN2MtNi4yNDgtNi4yNDktMTYuMzc5LTYuMjQ5LTIyLjYyOCAwTDIxNiAzMDguMTE4bC03MC4wNTktNzAuMDU5Yy02LjI0OC02LjI0OC0xNi4zNzktNi4yNDgtMjIuNjI4IDBsLTIyLjYyNyAyMi42MjdjLTYuMjQ4IDYuMjQ4LTYuMjQ4IDE2LjM3OSAwIDIyLjYyN2wxMDQgMTA0YzYuMjQ5IDYuMjQ5IDE2LjM3OSA2LjI0OSAyMi42MjguMDAxeiI+PC9wYXRoPjwvc3ZnPg==",vt.width=16,vt.height=16;var bt=["First","Second","Third","Fourth","Fifth"],wt=["Sixth","Seventh","Eighth","Ninth","Tenth"],Ct=[bt,wt,bt,wt,bt,wt,bt];function xt(){var e=Object(a.useState)(JSON.parse(JSON.stringify(Ct))),t=Object(s.a)(e,2),n=t[0],l=t[1],o=ct(),i=o.onCellWidthChange,u=o.onCellHeightChange,c=o.cellWidth,d=o.cellHeight;return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{onSelectionChanged:function(e,t,n,a){},onRightClick:function(){},columnHeaders:["A","B","C"],cellStyle:function(e,t){return{}},editData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},displayData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},sourceData:function(e,t){var a;return null===n||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e]},cellWidth:c,cellHeight:d,onChange:function(e){var t,a=Object(v.a)(n),r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;a[o.y]||(a[o.y]=[]),a[o.y][o.x]=o.value}}catch(i){r.e(i)}finally{r.f()}l(a)},readOnly:function(e,t){return!1},onCellWidthChange:i,onCellHeightChange:u,inputComponent:Et,cacheLayout:!0}))}function Et(e,t,n,a){return r.a.createElement("div",{style:Object(d.a)(Object(d.a)({},n.style),{},{backgroundColor:"#fff"})},r.a.createElement("div",{style:{border:"1px solid #ddd",boxShadow:"3px 5px 5px #ddd"}},(t%2?wt:bt).map((function(e){return r.a.createElement(St,{key:e,opt:e,value:n.value,clickHandler:function(){a(e)}})}))))}function St(e){var t=e.opt,n=e.value,l=e.clickHandler,o=Object(a.useState)(!1),i=Object(s.a)(o,2),u=i[0],c=i[1];return r.a.createElement("div",{onMouseEnter:function(){c(!0)},onMouseLeave:function(){c(!1)},style:{backgroundColor:n===t||u?"#f6f6f6":"#fff",padding:"5px 10px",cursor:"pointer"},value:t,onClick:function(){return l(t)}},t)}function Ot(){var e=Object(a.useState)([[1,2,3],[10,20,30]]),t=Object(s.a)(e,1)[0];return r.a.createElement("div",{className:"sheet-box"},r.a.createElement(qe,{sourceData:t,displayData:function(e,n){var a,r,l;return null===t||void 0===t||null===(a=t[n])||void 0===a||null===(r=a[e])||void 0===r||null===(l=r.toFixed)||void 0===l?void 0:l.call(r,2)}}))}var jt=n(17),Mt=n.n(jt);var Nt=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(s.a)(t,2),l=n[0],o=n[1];return r.a.createElement("div",{className:"container blue-bg",id:"home"},r.a.createElement("div",{className:"content flex-row header"},r.a.createElement("div",{className:"box text-box"},r.a.createElement("div",null,r.a.createElement("h1",null,"Beautiful and fast spreadsheet component for React"),r.a.createElement("p",{className:"lightblue-p"},"Sheet Happens is easy to implement and extend.",r.a.createElement("br",null),"And it's super fast.")),r.a.createElement("div",{className:"lib-box"},r.a.createElement("div",{className:"install-box",onClick:function(t){e.current.select(),document.execCommand("copy"),t.target.focus(),o("Copied!"),setTimeout((function(){o("")}),1e3)}},r.a.createElement("input",{readOnly:!0,ref:e,value:"npm install --save sheet-happens"}),""!==l&&r.a.createElement("div",{className:"copy-success"},l)),r.a.createElement("a",{href:"https://github.com/farseerdev/sheet-happens",rel:"noopener noreferrer",className:"git-box",target:"_blank"},r.a.createElement("img",{src:Mt.a,alt:"Git"}),"view on github"))),r.a.createElement("div",{className:"box"},r.a.createElement(dt,null))))};var Dt=function(e){var t=e.title,n=e.id;return r.a.createElement("div",{className:"title-separator",id:n||""},r.a.createElement("p",null,t||"No title"),r.a.createElement("div",{className:"separator"}))};var Tt=function(e){var t=e.children;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"content flex-row"},t))},kt=n(251),At=n(250);function It(){var e=Object(d.a)({},At.a);return e.hljs.height="100%",r.a.createElement(kt.a,{language:"javascript",style:e},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data} // array of arrays of data \n            displayData={displayData} // function example\n        />\n    </div>\n);')}function Ht(){return r.a.createElement(kt.a,{language:"javascript",style:At.a},"import React, { Component } from 'react'\nimport Sheet from 'sheet-happens'\nimport 'sheet-happens/dist/index.css'\n\nclass Example extends Component {\n  render() {\n    return <Sheet />\n  }\n}")}function Lt(){return r.a.createElement(kt.a,{language:"javascript",style:At.a},'const [data, setData] = useState([[1,2,3], [10,20,30]]);\n    \nconst displayData = (x, y) => {\n    return data?.[y]?.[x]?.toFixed?.(2);\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            sourceData={data}\n            displayData={displayData}\n        />\n    </div>\n);')}function Rt(){return r.a.createElement(kt.a,{language:"javascript",style:At.a},'...\n\nconst editData = (x, y) => {\n    return data?.[y]?.[x];\n};\n\nconst onChange = (changes) => {\n    const newData = [...data];\n    for (const change of changes) {\n        if (!newData[change.y]) {\n            newData[change.y] = [];\n        }\n        newData[change.y][change.x] = change.value;\n    }\n    setData(newData);\n};\n\nconst isReadOnly = (x, y) => {\n    return false;\n};\n\nreturn (\n    <div className="sheet-box">\n        <Sheet\n            ...\n            sourceData={sourceData}\n            onChange={onChange}\n            readOnly={isReadOnly}\n        />\n    </div>\n);')}function zt(){return r.a.createElement(kt.a,{language:"javascript",style:At.a},"...\n\nconst cellStyle = (x, y) => {\n    return { textAlign: 'right' };\n};\n\nconst [cellWidth, setCellWidth] = useState([]);\n\nconst onCellWidthChange = (indices, newWidths) => {\n    setCellWidth((cellWidth) => {\n        const cw = [...cellWidth];\n        for (const [i, order] of indices.entries()) {\n            const idx = getColumnOrder(order);\n            if (idx > cw.length) {\n                for (let i = cw.length; i <= idx; i++) {\n                    cw.push(DEFAULT_CELL_WIDTH);\n                }\n            }\n            cw[idx] = newWidths[i];\n        }\n        return cw;\n    });\n};\n\nreturn (\n    <div className=\"sheet-box\">\n        <Sheet\n            ...\n            cellStyle={cellStyle}\n            cellWidth={cellWidth}\n            onCellWidthChange={onCellWidthChange}\n        />\n    </div>\n);")}At.a.hljs.padding="10px 20px",At.a.hljs.background="#f8f9fa",At.a.hljs.width="100%",At.a.hljs.maxWidth="100%",At.a.hljs.overflow="auto",At.a.hljs.borderRadius="3px",At.a.hljs.fontSize="14px";var Pt=function(){return r.a.createElement("div",{className:"footer"},r.a.createElement("p",{className:"copy"},"made by ",r.a.createElement("a",{href:"https://www.farseer.io"},"farseer")))};function Wt(e){var t=e.text;return r.a.createElement("span",{className:"emphased"},t)}var Bt=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(c,null),r.a.createElement(Nt,null),r.a.createElement(Dt,{title:"Get started",id:"usage"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width colored-pre",style:{overflowX:"auto"}},r.a.createElement("p",null,"Import the component and its style, and render it"),r.a.createElement(Ht,null),r.a.createElement("div",{className:"spacer"}),r.a.createElement("p",null,"Display some data"),r.a.createElement(Lt,null))),r.a.createElement(Dt,{title:"Learn more about features",id:"features"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(ft,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Basic spreadsheet"),r.a.createElement("p",null,"It has all the features you'd expect from the spreadsheet: keyboard navigation, copy cells by dragging the small square, copy/paste from and to Excel and Google Sheets, resize and reorder columns and rows."))),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(ht,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Styling"),r.a.createElement("p",null,"You can change the cell color, alignment, font weight, margins and more. It's also possible to freeze first rows or columns, and add clickable images."))),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(mt,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Formatting"),r.a.createElement("p",null,"Sheet Happens uses different datasets for display and edit so you can apply different formatting when displaying the cell and editing the cell."))),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(gt,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Overlays"),r.a.createElement("p",null,"You can attach HTML overlays to the sheet, for additional controls, notes, etc."))),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(yt,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Grouped rows and columns"),r.a.createElement("p",null,"You can make rows act as a group for drag-and-drop operation."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Dt,{title:"Big dataset example",id:"big dataset example"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("p",null,"Our Sheet is designed and built with big datasets in mind. No matter the size of your data, it will be handled blazingly fast and super responsive because component is canvas-based and it draws only the small chunk of data user sees at the moment."),r.a.createElement("br",null),r.a.createElement(pt,null))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Dt,{title:"Custom input fields",id:"custom input example"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement(xt,null)),r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Custom input component"),r.a.createElement("p",null,"If basic text input isn't enough, you can send your own React component to be displayed instead."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Dt,{title:"Documentation",id:"documentation"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Displaying data"),r.a.createElement("p",null,"If you have some data you want to display, you send it via ",r.a.createElement(Wt,{text:"sourceData"})," and"," ",r.a.createElement(Wt,{text:"displayData"})," props."),r.a.createElement("p",null,"The first one receives unformatted data which is used for data manipulation, and the second one formatted which is used for displaying in cells."),r.a.createElement("br",null),r.a.createElement("p",null,"Each of this can be either array of arrays of values (where each array is representing data for one row) or function (which returns value based on x and y coordinates that are sent as arguments to your function)."))),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box colored-pre unmargin-pre",style:{maxWidth:"100%",overflow:"auto"}},r.a.createElement(It,null)),r.a.createElement("div",{className:"box"},r.a.createElement(Ot,null))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Editing data"),r.a.createElement("p",null,"Same as the previous two, prop ",r.a.createElement(Wt,{text:"editData"})," can recieve either array of arrays of values or function for data which will be displayed in edit mode. Edit mode is activated by double click on the cell."),r.a.createElement("br",null),r.a.createElement("p",null,"Once edit is done, function sent in ",r.a.createElement(Wt,{text:"onChange"})," prop will be called with array of changes as an argument. Each element of this array has value, x and y coordinates. Use this information to change values in your data array."),r.a.createElement("br",null),r.a.createElement("p",null,"Sheet also accepts ",r.a.createElement(Wt,{text:"readOnly"})," prop which you can use if some cells should not be editable. Same as the most of sheet's props, you can send function, array of arrays, or a single value which then is applied to the whole table.")),r.a.createElement("div",{className:"box unmargin-pre"},r.a.createElement(Rt,null))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Column headers"),r.a.createElement("p",null,"By default, sheet has excel-like headers (A, B, C, ...) but you can send yours via"," ",r.a.createElement(Wt,{text:"columnHeaders"})," prop as an array or function."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"Cell style and width/height"),r.a.createElement("p",null,"Use prop ",r.a.createElement(Wt,{text:"cellStyle"})," and ",r.a.createElement(Wt,{text:"columnHeaderStyle"})," for customizing cells visually."),r.a.createElement("br",null),r.a.createElement("p",null,"You can also use ",r.a.createElement(Wt,{text:"cellWidth"})," and ",r.a.createElement(Wt,{text:"cellHeight"})," props to customize cell size. If you send single value ","cellWidth={200}",", it will be applied to all cells. If you send array of values ","cellWidth={[200, 80, 80]}",", they will be applied in respect to the index number."),r.a.createElement("br",null),r.a.createElement("p",null,"There are also ",r.a.createElement(Wt,{text:"onCellWidthChange"})," and ",r.a.createElement(Wt,{text:"onCellHeightChange"})," ","props for functions which are called when user drags cell for resize. You can use these for updating your cellWidth/cellHeight arrays.")),r.a.createElement("div",{className:"box unmargin-pre"},r.a.createElement(zt,null))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Selection"),r.a.createElement("p",null,"You can send a function to the ",r.a.createElement(Wt,{text:"onSelectionChanged"})," prop. It will be called on selection change with x1, y1, x2 and y2 arguments."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Right click handler"),r.a.createElement("p",null,"If you send a function to ",r.a.createElement(Wt,{text:"onRightClick"})," prop, it will be called on right click with whole mouse event (extended with cellX and cellY values) as an argument."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Sticky columns/rows"),r.a.createElement("p",null,"Send a number to ",r.a.createElement(Wt,{text:"freezeColumns"})," and/or ",r.a.createElement(Wt,{text:"freezeRows"})," to make first n of columns/rows sticky."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Tt,null,r.a.createElement("div",{className:"box full-width"},r.a.createElement("h3",null,"Custom input"),r.a.createElement("p",null,"By default edit mode turns the cell into a text edit component. But you can send your custom input component via ",r.a.createElement(Wt,{text:"inputComponent"})," props. It will be called with"," ",r.a.createElement(Wt,{text:"x"}),", ",r.a.createElement(Wt,{text:"y"}),", ",r.a.createElement(Wt,{text:"inputProps"})," and"," ",r.a.createElement(Wt,{text:"commitEditingCell"})," arguments."))),r.a.createElement("div",{className:"spacer"}),r.a.createElement(Pt,null))};o.a.render(r.a.createElement(Bt,null),document.getElementById("root"))},27:function(e,t,n){}},[[22,1,2]]]);
//# sourceMappingURL=main.d7d1d560.chunk.js.map